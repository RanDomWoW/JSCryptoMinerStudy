<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="icon" href="favicon.ico">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

<!--meta name="author" content="PicSee" /-->
<meta name="description" content="Customize your links by setting your own thumbnail image! Enlarge YouTube video on Facebook. Supported on Facebook, Google, Twitter, LinkedIn and more." />
<meta property="article:author" content="https://www.facebook.com/picsee.co/" />

<meta property="og:image" content="https://picsee.co/images/cover.png" />
<meta property="og:title" content="PicSee | Customize Thumbnail,Embed YouTube link in Facebook as native video" />
<meta property="og:url" content="https://picsee.co" />
<meta property="og:description" content="Customize your links by setting your own thumbnail image! Enlarge YouTube video on Facebook. Supported on Facebook, Google, Twitter, LinkedIn and more." />
<meta property="fb:pages" content="1740743192836001" />

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="https://picsee.co">
<meta name="twitter:title" content="PicSee | Customize Thumbnail,Embed YouTube link in Facebook as native video">
<meta name="twitter:description" content="Customize your links by setting your own thumbnail image! Enlarge YouTube video on Facebook. Supported on Facebook, Google, Twitter, LinkedIn and more.">
<meta name="twitter:image:src" content="https://picsee.co/images/cover.png">
<meta name="twitter:domain" content="https://picsee.co">

<title>PicSee | Customize Thumbnail,Embed YouTube link in Facebook as native video</title>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="js/jquery.cookie.js"></script>
<script src="js/jquery.countTo.js"></script>
<script src="js/jquery.knob.js"></script>
<script src="js/jquery.ui.widget.js"></script>
<script src="js/jquery.iframe-transport.js"></script>
<script src="js/jquery.fileupload.js"></script>
<script src="js/jquery.blockUI.js"></script>
<script src="js/jquery.flexslider.js"></script>
<script src="js/bootstrap-switch.js"></script>
<script src="js/bootstrap-tagsinput.js"></script>
<script src="js/utility.js"></script>
<script src="//pics.ee/js/getBrowser.php"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/camanjs/4.0.0/caman.full.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/2.1.2/jquery.scrollTo.min.js"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/jquery.lazy/1.7.5/jquery.lazy.min.js"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/jquery.lazy/1.7.5/jquery.lazy.plugins.min.js"></script>
<script async type="text/javascript" src="js/ip2loc.js.php?ip=54.156.86.61"></script>
<script>
var api_root = "https://koa.pics.ee/api/v1/";
var is_edit = false; //是否編輯模式
//var is_edit = false; //關閉編輯模式測試
var user_url = "";
var image_url = "";
var org_image_url = ""; //沒播放鍵圖片
var play_image_url = ""; //含播放鍵圖片
var short_key = "";
var org_short_key = "";
var short_id = "";
var org_short_id = "";
var protocol = "https://";
//var short_domain = "http://pics.ee/"; remove by func 10/17
var short_domain = "pics.ee/";
var org_short_domain = "";
var short_domain_list = [];
var invite_id;
var channel = "";
var channelName = "";
var title;
var description;
var images;
var image_index = 0;
var image_recu = 0;
var image_width = 0;
var image_height = 0;
var image_top_percent = 50;
var image_left_percent = 50;
var image_type = "static";
var reset_title;
var reset_description;
var reset_image_url;
var yt_sec = -1;
var yt_id = '';
var key = Math.floor((Math.random() * 100000) + 1);
var fromTool = false;
var has_ad = false;
var fighting = true;
var target_redirect_rule = {"ios_android": 0, "ios": 0, "android": 0, "pc_mac": 0, "pc": 0, "mac": 0, "facebook": 0, "twitter": 0};

var done_url = "";
var done_image = "";
var done_title = "";
var done_description = "";
var done_type = "";
var done_image_left_percent = "";
var done_image_top_percent = ""
var customize = false;
var customized_url = false;
var group_func = {};
group_func.ad = 0;
var isUpI = true;
var isCustomizedDomain = false;
var blockUI_show = false;
var system_tag;
var target_id = "";
var org_tags = [];
var user_id = "0";
var pevent = "";
if(pevent != ""){
	protocol = "http://";
	short_domain = "kosovo10th.country/";
}


$(function() {
    $(".lazy").Lazy();
});

if(is_edit) getLinkEdit();

function getLinkEdit(){
	user_url = ("").trim();
	$('.function_box').hide();
	$('#ad_share_box').hide();

	setTimeout(function(){
		//初始化設定
		short_key = "";
		short_id = "";
		short_domain = "Array/";
		protocol = "http://";
		image_type = "";
		title = $('<textarea />').html("").text();
		description = $('<textarea />').html("").text();
		image_url = "";
		images = [""];

		var lnk = protocol + short_domain + short_key;

		//讀出分潤開關狀態加上鎖定
				$("#ad_share").bootstrapSwitch('state', false);
		
		$("#ad_share").bootstrapSwitch('disabled',true);
		$('#short_link').attr('onclick', ""); 
		$('#short_link').attr('readonly', true); 
		$('#play_icon_box').hide();
		
		$("#short_url_title").html("Shortened Link: ");
		$('#cshort_link_input').val(short_key).focus().select();
		$("#short_link").val(lnk).focus().select();
		$("#short_link_anal").attr("href", "https://pics.ee/"+short_key+"+");

		emph_dom("#short_link");
		setEdit(); //關閉編輯模式

		$('#edit_btn').show();
		$('#link_box').show();
		$('#boost_btn').hide()
		
		reset_title = title;
		reset_description = description;
		reset_image_url = image_url;

		$("#link_title").val(title);
		$("#video_title").html(title);
		$("#link_description").val(description);
		$("#link_image").hide();
		$("#link_video").hide();
		$('#link_description').css("height","");

		//設定分裝置導向規則
		$("#target_redirect_rules").html("");
		$("#target_redirect_default").val(user_url);
		$("#target_redirect_option option").show();

		yt_id = isYoutube(user_url);

		if(yt_id){
			//抓任一秒要用的yt frame
			if(window.sig === undefined){
				$('#videoJS').load('getSourceVideo.php?videoid='+yt_id);
			}

			if(player !== undefined){
				player.loadVideoById({'videoId': yt_id});
				player.stopVideo();
			}else addJSSrc('yt_api', '//www.youtube.com/iframe_api');
			//對yt初始化
			setButton(true)
			setPreview(true);
		}else{
			//對非yt初始化
			setButton(false)
			setPreview(false);
		}
		//展開更多選項
		showMore();

		$('#group_id').attr('disabled', true)
		
	}, 100);
	
	var upload_by = $('<a>').prop('href', user_url).prop('hostname');
	$("#link_desc span").html(upload_by);
	$('#link_image').hide();

	return;
}

function setUrlNormalize(url){
	//讓原本youtubeFB變回YouTube
	if(url.toLowerCase().indexOf("youtubefb.com") != -1){
		url = url.replace(/youtubefb\.com/i, "youtube.com");
	}else if(url.toLowerCase().indexOf("youtufb.be") != -1){
		url = url.replace(/youtufb\.be/i, "youtu.be");
	}else if(url.toLowerCase().indexOf("gaming.youtube") != -1){
		url = url.replace(/gaming/i, "www");
	}else if(url.toLowerCase().indexOf("m.youtube") != -1){
		url = url.replace(/m/i, "www");
	}

	var parser = document.createElement('a');
	parser.href = url;
	var new_url = parser.href;
	console.log("new_url: "+new_url);
	$("#url").val(new_url);
	return new_url;

	/*var url_test = decodeURIComponent(url);
	if(url_test == url){
		var parser = document.createElement('a');
		parser.href = url;
		var new_url = parser.href;
		console.log("new_url: "+new_url);
		$("#url").val(new_url);
		return new_url;
	}else{
		//貼上的網址已經編碼
		return url;
	}*/
}

//reset state
function gotoShorten(){
	if(is_edit) return; //編輯模式不能重縮
	if(image_type == "simple") setButton(false);
	$('.head_box').show();
	$('.function_box').hide();
	$('body').scrollTo('#main', 100);
	$('#url').val('').focus();
	$("#link_image").css("background-image", "");
	$("#link_video").css("background-image", "");

	short_domain = "pics.ee/";
	customized_url = false;
	channel = "";
	channelName = "";
	image_url_org = undefined;
	window.sig = undefined;
	window.mp4url = undefined;
	target_redirect_rule = {"ios_android": 0, "ios": 0, "android": 0, "pc_mac": 0, "pc": 0, "mac": 0, "facebook": 0, "twitter": 0};

	if($.cookie("group_id") === null || $.cookie("group_id") == "") getUTM();
	else setGroup();

	//讓數字重新跑
	isUpI = true;
}

/*
getLinkSimple ->
if(yt)
	setPreview(o) -> setPic
	getYouTubeLink -> setButton -> setPostType
	setUTM
else
	setButton -> setPostType
	getPage -> setPreview -> setPic
	setUTM

getLink
	setEditCancel
	setEditFinish
*/
function getLinkSimple(showAlert){
	ga('send', 'event', 'Index', 'Get Link Simple');
	user_url = $("#url").val().trim();
	$('.function_box').hide();
	$('#ad_share_box').hide();

	//讓數字暫停跑
	isUpI = false;

	var expression = /^http[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,7}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi;
	var regex = new RegExp(expression);

	/*if(!user_url.match(regex)){
		if(showAlert) $.growlUI('', 'URL format error, please add http://'); 
		return;
 	}

 	var domain_name = $('<a>').prop('href', user_url).prop('hostname');
 	if(domain_name.toLowerCase() == "pics.ee" || domain_name.toLowerCase() == "lnk.pics" || domain_name.toLowerCase() == "sur.ee"){
		if(showAlert) $.growlUI('', 'Cannot shorten pics.ee URL'); 
		return;
	}*/
	user_url = setUrlNormalize(user_url);

	$("#input_area .loading").show();
	$("#shorten").hide();
	
	$("#target_redirect_rules").html("");
	$("#target_redirect_default").val(user_url);
	$("#target_redirect_option option").show();

	$("#edit_box").show();
	setEdit();

	var url = isYoutube(user_url);
	if(url){
		yt_sec = -1;
		yt_id = url;

		url = "https://www.youtube.com/watch?v=" + yt_id;
		$("#short_url_title").html("Large Video Preview URL: ");
		$('preview_box .loading').hide();
		$('#link_box').show();
		//$("#post_type").show();

		if(window.sig === undefined){
			$('#videoJS').load('getSourceVideo.php?videoid='+yt_id);
		}
		if(player !== undefined){
			player.loadVideoById({'videoId': yt_id});
			player.stopVideo();
		}else addJSSrc('yt_api', '//www.youtube.com/iframe_api');

		//console.log("getPage.php?url="+encodeURIComponent(url)+"&v&key="+key);
		var data = "url="+encodeURIComponent(url);
		$.ajax({
			url: api_root + "links/parse?v=true&key="+key,
			data: data,
			type: "POST",
			dataType:'html',
			cache: false,

			success: function(textPage){
				var response = JSON.parse(textPage);

				title = $('<textarea />').html(response.data.title).text();
				description = $('<textarea />').html(response.data.description).text();
				image_url = response.data.images[0];
				images = response.data.images;
				channel = response.data.channel;
				channelName = response.data.channelName;
				//切換playIcon暫存
				reset_title = title;
				reset_description = description;
				reset_image_url = image_url;

				$("#link_title").val(title);
				$("#video_title").html(title);
				$("#link_description").val(description);
				$("#link_image").css("background-image", "url("+image_url+")");
				$("#link_video").css("background-image", "url("+image_url+")");
				image_type = "video";

				setPreview(true);
				getYouTubeLink();
				//getPageTester(url, true, JSON.stringify(response.data));
			},

			error:function(xhr, ajaxOptions, thrownError){
				$('a[class=navbar-brand]').attr('href', './');
				$.growlUI('', 'Error occurred, please refresh the page.');
			}
		});
	}else{
		$("#short_url_title").html("Shortened Link: ");
		$('#preview_box .loading').show();
		$('#link_box').hide();
		//$("#post_type").hide();
		var group_id = ($("#group_id").val() !== undefined && group_func.level >= 500)?$("#group_id").val():"";
		var domain = protocol + short_domain;
		var parser = document.createElement('a');
		parser.href = domain;
		domain = parser.hostname;

		$.ajax({
			url: "getLinkSimple.php?url="+encodeURIComponent(user_url)+"&group_id="+group_id+"&domain="+domain+"&pevent="+pevent,
			type: "GET",
			dataType: 'html',
			cache: false,

			success: function(textPage){
				//console.log(textPage);
				console.log('textPage: '+textPage);
				if(textPage == ".404" && fighting){
					$('body').html("<h1>"+antiPornTitle+"</h1><h2>"+antiPornDescription+"</h2>");
					return;
				}
				//先改,
				var keys = textPage.split(",");

				short_key = keys[0];
				short_id = keys[1];
				if(keys[2] != ""){
					short_domain = keys[2]+"/";
					//isCustomizedDomain = true;
				} 
				protocol = (keys[3] == 1)? "https://": "http://";
				var lnk = protocol + short_domain + short_key;
				
				setButton(false);
				$("#short_link").val(lnk).focus().select();
				emph_dom("#short_link");
				$("#short_link_anal").attr("href", "https://pics.ee/"+short_key+"+");
				image_type = 'simple';

				if(short_domain == "tinyurl.com/"){
					$("#show_more").hide();
					$("#preview_box").hide();
				}else{
					var host = (location.hostname);
					$('#hide_page iframe').attr("src", base_url+"getLink_helper.php?id="+short_id);
					showInvite();
					var upload_by = $('<a>').prop('href', user_url).prop('hostname');
					$("#link_desc span").html(upload_by);
					$('#link_image').hide();

					getPage();
				}

				if(group_func.level >= 500) setUTM();
			},

			error:function(xhr, ajaxOptions, thrownError){
				$("#input_area .loading").hide();
				$("#shorten").show();
				$('a[class=navbar-brand]').attr('href', './');
				$.growlUI('', 'Error occurred, please refresh the page.');
				$.cookie("group_id", null, { path: '/' });
			}
		});
	}
	//拿Tag
	getTag(group_id);
}

function getYouTubeLink(){
	var group_id = ($("#group_id").val() !== undefined && (group_func.level >= 500 || group_func.ad == 1))?$("#group_id").val():"";

	var img = new Image();
	img.src = image_url;
	org_image_url = image_url;
	img.onload = function() {
		//若要壓play就都打上傳
		//if(this.width < 720){
			getImage();
			var si = setInterval(function(){
				if(done_url != ""){
					setButton(true);
					clearInterval(si);
				}
			}, 500);
		/*}else{
			$.ajax({
				type: 'POST',
				url: "getLink.php",
				data: "url="+encodeURIComponent(user_url)+"&src="+encodeURIComponent(image_url)+"&title="+encodeURIComponent(title)+"&description="+encodeURIComponent(description)+"&type=video&group_id="+group_id+"&channel="+channel+"&channelName="+channelName+"&key="+key,
				dataType:'html',
				cache: false,
				async: true,

				success: function(textPage){
					//console.log(textPage);

					done_url = user_url;
					done_image = image_url;
					done_title = title;
					done_description = description;
					done_type = "video";
					done_image_left_percent = image_left_percent;
					done_image_top_percent = image_top_percent;

					var keys = textPage.split(".");

					short_key = keys[0];
					short_id = keys[1];
					session_key = short_id;
					var lnk = protocol + short_domain + short_key;
					$("#short_link").val(lnk);

					setButton(true);
					$('#play_icon_box').show();
					$("#short_link").focus().select();
					emph_dom("#short_link");
					$("#short_link_anal").attr("href", "https://pics.ee/"+short_key+"+");

					$('#hide_page iframe').attr("src", base_url+"getLink_helper.php?id="+short_id);
					$('#hide_page_fb iframe').attr("src", "https://picsee.co/getImageTwitter.php?id="+short_id+"&img_url="+encodeURIComponent(image_url)+"&top_percent="+image_top_percent+"&left_percent="+image_left_percent);
					showInvite();

					if($("#utm_source").val() !== undefined && $("#utm_source").val() != "") setUTM();
				},

				error:function(xhr, ajaxOptions, thrownError){
					//alert("Security check failed. Please make sure your browser has only one PicSee window open and refresh the page.");
					$('a[class=navbar-brand]').attr('href', './');
					$.growlUI('', 'Security check failed. Please make sure your browser has only one PicSee window open and refresh the page.');
					$.cookie("group_id", null, { path: '/' });
				}
			});
			//拿Tag
			getTag(group_id);
		}*/
		img = undefined;
	};
}

function getPage(){
	//console.log("getPage.php?url="+encodeURIComponent(user_url)+"&key="+key);
	var data = "url="+encodeURIComponent(user_url);
	$.ajax({
		url: api_root + "links/parse?v=false&key="+key,
		data: data,
		type: "POST",
		dataType:'html',
		cache: false,

		success: function(textPage){
			$('#preview_box .loading').hide();
			$('#edit_btn').show();
						$('#boost_btn').show(1500);
						$('#link_box').show();
			
			var response = JSON.parse(textPage);
			title = $('<textarea />').html(response.data.title).text();
			description = $('<textarea />').html(response.data.description).text();
			images = response.data.images;

			reset_title = title;
			reset_description = description;

			$("#link_title").val(title);
			$("#video_title").html(title);
			$("#link_description").val(description);
			$("#link_image").hide();
			$("#link_video").hide();
			$('#link_description').css("height","");

			setPreview(false);
			//getPageTester(user_url, false, JSON.stringify(response.data));
		},

		error:function(xhr, ajaxOptions, thrownError){
			$('a[class=navbar-brand]').attr('href', './');
			$.growlUI('', 'Error occurred, please refresh the page.'); 
			//alert("Busy, Please refresh this page...sorry");
		}
	});
}

function getPageTester(url, v, response_data){
	/*var data = "url="+encodeURIComponent(url)+"&v="+v+"&response_data="+encodeURIComponent(response_data);

	$.ajax({
		url: "getPage_tester.php",
		data: data,
		type: "POST",
		dataType:'json',
		cache: false,

		success: function(textPage){
			console.log(textPage);
		},

		error:function(xhr, ajaxOptions, thrownError){
		}
	});*/
}

function previewOK(){
	//儲存編輯後
	ga('send', 'event', 'Index', 'Preview OK');
	title = $("#link_title").val();
	description = $("#link_description").val();
	var play_icon = ($("#play_icon").bootstrapSwitch('state') == true && image_type == "video")? 1: 0;

	if(done_url == user_url && done_image == image_url && done_title == title && done_description == description && done_type == image_type && done_image_left_percent == image_left_percent && done_image_top_percent == image_top_percent){
		setEditCancel();
		setEditFinish()
		return;
	}

	if(image_width < 720 ||  
		image_url.indexOf("data:image/") == 0 || 
		image_top_percent != 50 || 
		image_left_percent != 50 || 
		play_icon)
		getImage();
	else getLink();
}

function getImage(){
	var play_icon = ($("#play_icon").bootstrapSwitch('state') == true)? 1: 0;
	var upload = "getImage.php"
	var data = "user_url="+encodeURIComponent(user_url)+"&img_url="+encodeURIComponent(image_url)+"&play_icon="+play_icon+"&top_percent="+image_top_percent+"&left_percent="+image_left_percent+"&method=static&key="+key+"&"+image_type+"=true";
	//console.log("upload: "+data);
	$.ajax({
		type: 'POST',
		url: upload,
		data: data,
		dataType:'html',
		cache: false,
		async: true,

		success: function(textPage){
			console.log(textPage);
			if(textPage.indexOf("http") == 0){
				image_url = textPage;
				if(play_icon) play_image_url = image_url;
				image_width = 720;
				getLink();
			}else{
				$.growlUI('', "Image upload failed. Check image format, Maximum file size is 2MB.\n"+textPage);
				setEditFinish();
			}
		},

		error:function(xhr, ajaxOptions, thrownError){
			$('a[class=navbar-brand]').attr('href', './');
			$.growlUI('', 'Security check failed. Please make sure your browser has only one PicSee window open and refresh the page.');
			setEditFinish();
		}
	});
}

function getLink(){
	ga('send', 'event', 'Index', 'Get Link');
	var group_id = ($("#group_id").val() !== undefined && (group_func.level >= 500 || group_func.ad == 1))?$("#group_id").val():"";
	var ad_share_para = ($("#ad_share").is(':visible') && $("#ad_share").bootstrapSwitch('state') == true)?"&ad_share=1":"";
	var type = 'GET';
	var api = '';
	var data = '';
	var domain = short_domain.replace("/", "");
	var ssl = (protocol == "https://")?1:0
	if(image_type == 'simple') image_type = 'static';

	/*if(image_type == 'simple'){
		//第一次一般連結：更新
		api = "setLink.php?encode_id="+encodeURIComponent(short_key)+"&url="+encodeURIComponent(user_url)+"&src="+encodeURIComponent(image_url)+"&title="+encodeURIComponent(title)+"&description="+encodeURIComponent(description);
		image_type = 'static';
	}else if(customized_url){
		//有客製化網址過的連結：更新
		api = "setLink.php?encode_id="+encodeURIComponent(short_key)+"&url="+encodeURIComponent(user_url)+"&src="+encodeURIComponent(image_url)+"&title="+encodeURIComponent(title)+"&description="+encodeURIComponent(description);
	}else{
		//yt或第2次以上的一般連結：產生新的
	var type = 'POST';
	var api = "getLink.php";
	var data = "url="+encodeURIComponent(user_url)+"&src="+encodeURIComponent(image_url)+"&title="+encodeURIComponent(title)+"&description="+encodeURIComponent(description)+"&type="+image_type+"&group_id="+group_id+"&ssl="+ssl+"&domain="+domain+"&pevent="+pevent+"&channel="+channel+"&channelName="+channelName+ad_share_para;
	}*/
	//console.log("api: " + api);
	
	if(is_edit){
		//不重新產生新的
		api = "setLink.php?encode_id="+encodeURIComponent(short_key)+"&url="+encodeURIComponent(user_url)+"&src="+encodeURIComponent(image_url)+"&title="+encodeURIComponent(title)+"&description="+encodeURIComponent(description);
	}else{
		var country = (typeof ip2loc !== "undefined")?ip2loc.data.country:"";
		type = 'POST';
		api = "getLink.php";
		data = "url="+encodeURIComponent(user_url)+"&src="+encodeURIComponent(image_url)+"&title="+encodeURIComponent(title)+"&description="+encodeURIComponent(description)+"&type="+image_type+"&group_id="+group_id+"&ssl="+ssl+"&domain="+domain+"&country="+country+"&pevent="+pevent+"&channel="+channel+"&channelName="+channelName+ad_share_para;
	}

	$.ajax({
		type: type,
		url: api,
		data: data,
		dataType:'html',
		cache: false,
		async: true,

		success: function(textPage){
			//console.log("setLink.php: "+textPage);
			if(textPage == ".404" && fighting){
				$('body').html("<h1>"+antiPornTitle+"</h1><h2>"+antiPornDescription+"</h2>");
				return;
			}

			if(is_edit){
				//編輯模式更新用
				setEditCancel();
				setEditFinish();
				//setCustomizeLink();
				return;
			} 

			$("#play_icon").bootstrapSwitch('disabled', false);
			$("#play").css("opacity", "0");
				
			var keys = textPage.split(",");

			org_short_key = short_key;
			org_short_id = short_id;
			org_short_domain = short_domain;
			short_key = keys[0];
			short_id = keys[1];
			if(keys[2] != "") short_domain = keys[2]+"/";
			protocol = (keys[3] == 1)? "https://": "http://";
			var lnk = protocol + short_domain + short_key;

			/*var url = isYoutube(user_url);
			if(url){
				protocol = "https://"; // edit by evan 2018.01.19
			}*/

			done_url = user_url;
			done_image = image_url;
			done_title = title;
			done_description = description;
			done_type = image_type;
			done_image_left_percent = image_left_percent;
			done_image_top_percent = image_top_percent;

			setEditCancel();
			setEditFinish();

			if(image_url != "") $("#link_video").css("background-image", "url("+image_url+")");

			$("#short_link").val(lnk).focus().select();
			if($.cookie("user_id") !== null) $('#cshort_link_input').val(short_key).focus().select();
			$("#short_link_anal").attr("href", "https://pics.ee/"+short_key+"+");

			$('#hide_page iframe').attr("src", base_url+"getLink_helper.php?id="+short_id);
			if(image_type == "video") $('#hide_page_fb iframe').attr("src", base_url+"getImageTwitter.php?id="+short_id+"&img_url="+encodeURIComponent(image_url)+"&top_percent="+image_top_percent+"&left_percent="+image_left_percent);
			showInvite();
			if(($("#utm_source").val() !== undefined && $("#utm_source").val() != "") || ($("#utm_g_tag").val() !== undefined && $("#utm_g_tag").val() != "") || ($("#utm_fb_pixel").val() !== undefined && $("#utm_fb_pixel").val() != "")) setUTM();
			if(group_func.ad == 1 && $("#ad_share").bootstrapSwitch('state') == true && image_type == "video"){
				setAd(1);
			}
			//取得新網址，同步tag
			reSetTag();
			setCustomizeLink();
			/*if($("#short_link").is(":visible")) $("#short_link").val(lnk).focus().select();
			else $('#cshort_link_input').val(short_key).focus().select();*/
		},

		error:function(xhr, ajaxOptions, thrownError){
			$('a[class=navbar-brand]').attr('href', './');
			$.growlUI('', 'Security check failed. Please make sure your browser has only one PicSee window open and refresh the page.');
			setEditFinish();
		}
	});
}

function setEdit(startEdit){
	if(startEdit || $('#edit_box').attr('style') == 'display: none;'){
		//開始編輯
		$('#edit_btn').removeClass('btn-primary').addClass('btn-lg btn-danger');
		$('#edit_btn').attr('value', 'OK!');
		$('#boost_btn').hide();
		$('#cancel_btn').show();
		$('#preview_box').attr('style', 'float: left');
		$('#shorten_link_bar').hide();
		$('#play_icon_box').hide();
		$('.advance_box').hide();
		if(image_type != 'video') $('#link_image').show();
		var group_id = $("#group_id").val();
		var link_desc_span = "";
		if(group_id !== undefined && group_id != "" && group_func.level >= 500){
			link_desc_span = "PICS.EE | By <a>"+$("#group_"+group_id).html()+"</a>";
		}else if(image_type == "video"){
			if(group_func.ad == 1) link_desc_span = "PICS.EE | By <a>您的粉絲專頁名稱</a>";
			else link_desc_span = "PICS.EE | By <a>YouTube</a>";
		}else{
			var upload_by = $('<a>').prop('href', user_url).prop('hostname');
			link_desc_span = "PICS.EE | By "+upload_by;
		}
		$("#link_desc span").html(link_desc_span);
		$('#edit_box').show(1000);
		//if($('#image_filter').is(":visible") && noFilter) setImageFilter(image_url);
	}else if($('#edit_btn').val() == 'OK!'){
		//儲存編輯
		$('#boost_btn').show();
		$('#edit_btn').hide();
		$('#cancel_btn').hide();
		$('#preview_box .loading').show();
		previewOK();
	}else{
		//取消編輯
		setEditCancel();
	}
}

function setEditCancel(reset){
	$('#edit_btn').removeClass('btn-lg btn-danger').addClass('btn-primary');
	$('#edit_btn').attr('value', 'Edit');
	$('#cancel_btn').hide();
	$('#boost_btn').show();
	$('#preview_box').attr('style', 'float: none;');
	$('#shorten_link_bar').show();
	$('#edit_box').hide();
	$('.advance_box').show();
	//編輯模式暫時隱藏playIcon開關
	if(image_type == "video" && !is_edit) $('#play_icon_box').show();
	emph_dom("#short_link");
	//getTag();

	if(reset){
		$('#link_title').val(reset_title);
		$('#video_title').html(reset_title);
		$('#link_description').val(reset_description);
		if(reset_image_url !== undefined) setPic(reset_image_url, 0);
		else $('#link_image').hide();

		if(isYoutube(user_url)){
			var group_id = $("#group_id").val();
			var link_desc_span = "";
			if(group_id !== undefined && group_id != "" && group_func.level >= 500){
				link_desc_span = "PICS.EE | By <a>"+$("#group_"+group_id).html()+"</a>";
			}else if($("#ad_share").is(':visible') && $("#ad_share").bootstrapSwitch('state') == true){
				link_desc_span = "PICS.EE | By <a>您的粉絲專頁名稱</a>";
			}else{
				link_desc_span = "PICS.EE | By <a>YouTube</a>";
			}
			$("#link_desc span").html(link_desc_span);
		}else{
			var upload_by = $('<a>').prop('href', user_url).prop('hostname');
			$("#link_desc span").html(upload_by);
		}
	}
}

function setEditFinish(){
	$('#edit_btn').show();
	$('#boost_btn').show();
	if(image_type == "video" && !is_edit) $('#play_icon_box').show();
	$('#preview_box .loading').hide();
}

function setButton(yt){
	//$('body').scrollTo('#input_area', 100);
	$('.head_box').hide();
	$(".function_box").show();
	$("#input_area .loading").hide();
	$("#shorten").show();
	$('#show_more').show();
	showMore(true);
	//是會員直接點選
	if($.cookie("user_id") != null && !is_edit) setCustomizeLink();

	if(yt) setPostType('video');
	else setPostType('static');
}

function setPostType(type){
	var link_desc_span = "";
	var upload_best_size = "";

	if(type == 'video'){
		//$('#post_type_btn').html("Embedded Video");
		//$('#post_type .note').html("Play on Facebook's page. Don't worry, the <a class='span_link' href='http://pics.ee/youtube_views' target='_blank'>views</a> will still accumulate to YouTube.");
		$("#link_image").hide();
		$("#link_video").show();
		$('#link_description').css("height","20px");

		if(group_func.ad == 1) $('#ad_share_box').show();

		if($("#ad_share").is(':visible') && $("#ad_share").bootstrapSwitch('state') == true){
			setAd(1);
		}else{
			link_desc_span = "PICS.EE | By <a>YOUTUBE</a>";
		}

		if(group_func.level >= 500){
			var group_id = $("#group_id").val();
			link_desc_span = "PICS.EE | By <a>"+$("#group_"+group_id).html()+"</a>";
		}

		$("#yt_time").show();
		var upload_best_size = 'Optimal size is 720x405px (smaller than 2MB)';
		image_type = 'video';
		image_url = play_image_url;
		$("#link_video").css("background-image", "url("+image_url+")");
	}else{
		//$('#post_type_btn').html("Static Preview Image");
		//$('#post_type .note').html("Open video in new tab");
		$("#link_image").show();
		$("#link_video").hide();
		$('#link_description').css("height","");
		var upload_by = $('<a>').prop('href', user_url).prop('hostname');
		link_desc_span = "PICS.EE | By "+upload_by;
		$("#yt_time").hide();
		$('#ad_share_box').hide();
		var upload_best_size = 'Optimal size is 720x379px (smaller than 2MB)';
		if(image_type == "video"){
			image_url = org_image_url;
			$("#link_image").css("background-image", "url("+image_url+")");
		}
		image_type = 'static';
	}
	$("#link_desc span").html(link_desc_span);
	$("#upload_best_size").html(upload_best_size);
}

function setPreview(yt){
	$("#pics").html('');
	reset_image_url = undefined;
	/*$("#pics").append('<div class="float_image"><span class="note"></span><ins class="rmax" data-rmax-space-id="ac8c73c2a1e44fb1" data-rmax-space-type="BANNER" data-rmax-space-width="200px" data-rmax-space-height="200px"></ins><script async="async" src="//tenmax-static.cacafly.net/ssp/adsbytenmax.js"></'+'script></div>');*/
	//setUpload();

	var maxwidth = 0, minid = 20000;
	if(images !== undefined)
	for(var i = 0; i < images.length; i++){
		var iwidth = 0;
		var img = new Image();
		img.id = 10000+i;
		img.src = images[i].replace(/\(/g, "%28").replace(/\)/g, "%29");	//讓圖片URL中的括號編碼
		img.onload = function() {
			var iwidth = this.width;
			var iheight = this.height;
			var isrc = this.src;
			var iid = this.id;

			if(iwidth >= 100)
				$("#pics").append('<div class="float_image"><img src="'+isrc+'" onclick="setPic(\''+isrc+'\', 0, true)"></div>');
			//儲存網頁中最大張的圖（寬度大於600；高寬比介於1.2到3之間）
			//Source: https://developers.facebook.com/docs/sharing/best-practices
			if(iid < minid && iwidth >= 600 && iwidth/iheight > 1.2 && iwidth/iheight < 3){
				minid = iid;
				reset_image_url = isrc;
				if(!yt) $('#link_image').show();
				setPic(isrc, iwidth);
				console.log(iid+": "+isrc);
			}
			img = undefined;
		}
	}

	//產生假圖
	var engEx = /[a-zA-Z]{3,}/;
	var regex = new RegExp(engEx);
	var toEngStr = title.toUpperCase() + user_url.toUpperCase().replace(/HTTP(S?):\/\/|WWW/g, " ");
	var myArray = toEngStr.match(regex);
	if(myArray && myArray[0].length > 0){

		for(var i = 0; i < 3; i++){
			var rR = Math.floor(Math.random()*(190-16)+16).toString(16);
			var rG = Math.floor(Math.random()*(190-16)+16).toString(16);
			var rB = Math.floor(Math.random()*(190-16)+16).toString(16);
			var size = (yt)?"720x405":"720x379";
			var fakeSrc = "http://fakeimg.pl/"+size+"/"+rR+rG+rB+"/FFF?text="+myArray[0];
			//console.log(fakeSrc);

			$("#pics").append('<div class="float_image"><img src="'+fakeSrc+'" onclick="setPic(\''+fakeSrc+'\', 0, true)"></div>');
		}
	}

	if(yt && group_func.ad == 1){
		$('#ad_share_box').show();
		//如果有off的cookie調成off
		if($.cookie("ad_share") == '0'){
			//$("#ad_share").bootstrapSwitch('state', false);
		}
	}

	/*if(!yt){
		setTimeout(function(){
			/*var big_img, i = 1;
			while(big_img === undefined){
				big_img = $("#pics .float_image img:nth-child("+(i++)+")").attr("src");
			}
			setPic(big_img, 0);
			reset_image_url = big_img;* /
			if(maxwidth_img != ""){
				setPic(maxwidth_img, 0);
			}else{
				$('#link_image').hide();
			}
		}, 500);
	}*/
}

function setImgUrl(){
	var img_url = $('#from_url_input').val().replace(/\(/g, "%28").replace(/\)/g, "%29");
	if(img_url === null) return;

	var expression = /http[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi;
	var regex = new RegExp(expression);

	if(img_url!= "" && img_url.match(regex)){
    	$("#pics").append('<div class="float_image"><img src="'+img_url+'" onclick="setPic(\''+img_url+'\', 0, true)"></div>');
        setPic(img_url, 0, true);
        $('#from_url_box').hide();
    }else{
    	$.growlUI('', 'URL format error, please add http://'); 
    	//alert("image url must start with \"http\"");
    }
}

function setPic(img_url, width, emph){
	if(img_url.indexOf("//") == 0) img_url = "http:"+img_url;
	image_url = img_url;
	image_top_percent = 50;
	image_left_percent = 50;

	$("#link_image").css("background-image", "url("+img_url+")");
	$("#link_image").css("background-position-x", "");
	$("#link_image").css("background-position-y", "");
	$("#link_video").css("background-image", "url("+img_url+")");
	$('body').scrollTo('#main', 100);
	if(emph !== undefined && emph == true){
		image_url_org = image_url;
		emph_dom('#edit_btn');
		ga('send', 'event', 'Index', 'Set Pic', 'select');
	}else if(emph !== undefined){
		ga('send', 'event', 'Index', 'Set Pic', 'filter: '+emph);
	}

	if(width == 0){
		var img = new Image();
		img.onload = function() {
			image_width = this.width;
			image_height = this.height;
			img = undefined;
		}
		img.src = img_url;
	}else image_width = width;
	//resetPost();

	//if($('#image_filter').is(":visible") && emph !== undefined && emph == true) setImageFilter(img_url);
}

function emph_dom(n){
	/*var emphasize_counter = 0;
	var emphasize = setInterval(function(){
		$(n).removeClass('btn-danger');
		setTimeout(function(){
			$(n).addClass('btn-danger');
		}, 150);
		if(emphasize_counter++ == 2) clearInterval(emphasize);
	}, 300);*/
	jQuery.fn.shake = function(intShakes, intDistance, intDuration) {
		this.each(function() {
			$(this).css("position","relative"); 
			for (var x=1; x<=intShakes; x++) {
				$(this).animate({left:(intDistance*-1)}, (((intDuration/intShakes)/4)))
				.animate({left:intDistance}, ((intDuration/intShakes)/2))
				.animate({left:0}, (((intDuration/intShakes)/4)));
			}
		});
		return this;
	};
	$(n).shake(5, 1, 500);
}

function setImgFromUrl(){
	ga('send', 'event', 'Index', 'Set Img From Url');
	showHideHTML('#from_url_box');
	$('#from_url_input').focus().select();
}

function isYoutube(test_url){
	var expression = /^(?:https?:\/\/)(?:www\.|m\.)?youtu(?:\.be|be\.com)\/(watch(.*)(\?|\&)v=)?([\w-]{10,})/;
	var regex = new RegExp(expression);
	var myArray = test_url.match(regex);

	if(myArray){
		var parser = document.createElement('a');
		var yt_id = myArray[4];
		parser.href = test_url;

		if(parser.hostname == "youtu.be"){
			yt_id = myArray[4];
			user_url = "https://www.youtube.com/watch?v="+myArray[4];
			if(parser.search.length > 0){
				user_url += "&"+parser.search.substring(1, parser.search.length);
			}
		}
		console.log(yt_id);
		return yt_id;
		//return true;
	}else return false;
}

var image_url_org;

function setImageFilter(filter){
	if(image_url_org === undefined){
		image_url_org = image_url;
	}
	if(filter === undefined){
		//reset
		setPic(image_url_org, 0, true);
		image_url_org = undefined;
		return;
	}

	var img_src = image_url_org;
	var img = new Image();
	var canvas = document.createElement("canvas");
	var ctx = canvas.getContext('2d');

	img.onload = function() {
		try{
			ctx.drawImage(img, 0, 0);
			canvas.toDataURL();
			img = canvas = undefined;
		}catch(err){
			img_src = "getImageProxy.php?src="+encodeURIComponent(img_src);
			console.log("img_src: "+img_src);
		}
		//do something
		$("#image_filter .loading").show();
		$("#caman_div").html("<img style=\"display: none;\" id=\"caman_canvas\" src=\""+img_src+"\" />");
		var caman = Caman("#caman_canvas", function () {
			this[filter]().render(function(){
				//$("#canvas_"+filter).css("height", $("#origin").outerHeight());
				setPic(document.getElementById('caman_canvas').toDataURL('image/jpeg', 1), 0, filter);
				$("#image_filter .loading").hide();
				//$("#caman_canvas").attr("src", '');
			});
		});
	}
	img.src = img_src;
}

function getYTImage(){
	ga('send', 'event', 'Index', 'Get YT Image');
	$('#yt_time .btn-primary').hide();
	$("#yt_time_loading").show();

	var sec = $('#yt_time_input').val();
	if(yt_sec == sec){
		$('#yt_time .btn-primary').show();
		$("#yt_time_loading").hide();
		return;
	}
	yt_sec = sec;

	var vid = isYoutube(user_url);
	var sig=window.sig;
    var mp4=window.mp4url;
    $.ajax({
		url: "getYTImage.php?vid="+vid+"&sec="+sec+"&url="+encodeURIComponent("https://www.youtube.com/watch?v="+vid)+"&key="+key+'&mp4='+encodeURIComponent(mp4),
		type: "GET",
		dataType: 'html',
		cache: false,

		success: function(textPage){
			console.log(textPage);
			var path = ((location.pathname.indexOf('/picsee/') == 0)?("//"+location.hostname+"/picsee/"):"http://"+location.hostname+"/");
			var img = path+textPage;

			$("#pics").append('<div class="float_image"><img src="'+img+'" onclick="setPic(\''+img+'\', 0, true)"></div>');
			setPic(img, 0, true);
			$('#yt_time .btn-primary').show();
			$("#yt_time_loading").hide();
		},

		error:function(xhr, ajaxOptions, thrownError){
			$('#yt_time .btn-primary').show();
			$("#yt_time_loading").hide();
			$('a[class=navbar-brand]').attr('href', './');
			$.growlUI('', 'Error occurred, please refresh the page.'); 
		}
	});
}

function setVideoTitle(){
	var title = $("#link_title").val();
	$("#video_title").html(title);
}

function setGroup(){
	if($("#group_id").val() !== undefined){
		var group_id = $("#group_id").val();
		group_func = JSON.parse($("#group_"+group_id).attr('func'));
		if(!is_edit) $("#ad_share").bootstrapSwitch('disabled', false);

		var link_desc_span = "";

		if(group_func.ad == 1 && image_type == 'video'){
			$('#ad_share_box').show();
			if(group_func.level != -1 && group_id != $.cookie("user_id")){
				//分潤成員
				if(!is_edit) $("#ad_share").bootstrapSwitch('state', true); //編輯模式不強制開分潤
				if(group_func.level < 500 || is_edit) $("#ad_share").bootstrapSwitch('disabled', true); //囉嘍
			}
		}else $('#ad_share_box').hide();

		if(group_func.level >= 500){
			link_desc_span = "PICS.EE | By <a>"+$("#group_"+group_id).html()+"</a>";
			getUTM(group_id);
		}else{
			if(image_type == "video"){
				link_desc_span = "PICS.EE | By <a>YouTube</a>";
			}else{
				var upload_by = $('<a>').prop('href', user_url).prop('hostname');
				link_desc_span = "PICS.EE | By "+upload_by;
			}
			getUTM();
		}
		if(short_key != "") $("#ad_share").bootstrapSwitch('state', false);
		$("#link_desc span").html(link_desc_span);
		$.cookie("group_id", group_id, { expires: 1000000 });
		if(group_func.level < 500 && group_func.ad == 0) group_id = "";

		$.ajax({
			url: "setLink.php?encode_id="+encodeURIComponent(short_key)+"&group_id="+group_id,
			type:"GET",
			dataType:'html',
			cache: false,

			success: function(textPage){
				console.log("setGroup: "+textPage);
				if(textPage != ""){
					//if(group_func.ad == 1 && image_type == 'video' && group_id != $.cookie("user_id")){
					if(group_func.ad == 1 && image_type == 'video'){
						//分潤成員
						if(is_edit){
							//編輯模式鎖定分潤開關
							$("#ad_share").bootstrapSwitch('state')? setAd(1): setAd(0);
							$("#ad_share").bootstrapSwitch('disabled', true);
						}else if(group_id != $.cookie("user_id")){
							setAd(1);
							$("#ad_share").bootstrapSwitch('state', true);
							if(group_func.level < 500 && group_func.level != -1) $("#ad_share").bootstrapSwitch('disabled', true); //囉嘍
						}
					}
				}
				ga('send', 'event', 'Index', 'Set Group');
			},

			error:function(xhr, ajaxOptions, thrownError){
				$.growlUI('', 'Error occurred, please refresh the page.');
				//$('#tr_'+encode_for_selector).show();
				//alert("Busy, Please refresh this page...sorry");
			}
		});

		//換群組，找Tag
		getTag(group_id);
		//編輯模式把編輯模式關掉
		if(customize) setCustomizeLink();
	}
}

function getTag(id){
	//取得該群組tag
	$('#tags').tagsinput('removeAll');
	$("#tag_select").html("<option disabled selected>Loading...</option>");

	org_tags = [];
	var group_id;
	if(id != 0 && id != null){
		//有群組
		group_id = parseInt(id);
	}else{
		group_id = parseInt(user_id);
	}

	if(group_id != 0 && !isNaN(group_id)){
		$.ajax({
			url: "getTag.php?&group_id="+group_id,
			type:"GET",
			dataType:'html',
			cache: false,

			success: function(textPage){
				if(textPage != ""){
					var tag_data = JSON.parse(textPage);
					var tag_select_html = "<option disabled selected>Choose Tag</option>";
					for(var i in tag_data){
						if(tag_data[i].value == "batch") continue;
						tag_select_html += "<option>" + tag_data[i].value + "</option>";
					}
					$("#tag_select").html(tag_select_html);
				}
			},

			error:function(xhr, ajaxOptions, thrownError){
				$.growlUI('', 'Error occurred, please refresh the page.');
			}
		});
	}
}

function setTag(){
	//新增刪除tags
	var tags = toLowerArray($("#tags").tagsinput('items'));
	var status; 
	var user_tags; //變化tag
	var group_id = "";

	if($("#group_id").val() !== undefined && $("#group_id").val() != ""){
		//有群組
		group_id = parseInt($("#group_id").val());
	}else{
		group_id = parseInt(user_id);
	}
	//判斷變量
	if(org_tags.length > tags.length){
		console.log("Remove");
		status = "remove";
		user_tags = org_tags.filter(function(tag){
		  if(!tags.includes(tag)) return tag;
		});
	}else{
		console.log("Add");
		status = "add";
		user_tags = tags.filter(function(tag){
		  if(!org_tags.includes(tag)) return tag;
		});
		if(user_tags[0] != null) $("#tags_div").show();
	}

	org_tags = toLowerArray($("#tags").val().split(","));
	console.log(user_tags); 
	
	if(user_tags.length > 2){
		//處理全刪
		status = "removeall";
	}else if(user_tags[0] == null){
		//沒變化
		return;
	} 

	if(group_id != 0 && !isNaN(group_id)){
		ga('send', 'event', 'Index', 'Tag', status);
		tagApi(short_id, group_id, user_tags, status);
	}
}

function reSetTag(){
	//產生新網址以後重放tag
	ga('send', 'event', 'Index', 'Tag', 'reset');
	var tags = toLowerArray($("#tags").tagsinput('items'));
	var group_id = "";

	if($("#group_id").val() !== undefined && $("#group_id").val() != "") group_id = parseInt($("#group_id").val());
	else group_id = parseInt(user_id);

	var tag_index = 0;
	if(group_id != 0 && !isNaN(group_id) && tags != ""){
		$.when(tagApi(short_id, group_id, tags[tag_index++], "add")).done(function(){
	    	if(tag_index < tags.length) tagApi(short_id, group_id, tags[tag_index], "add");
		});
	}
}

function tagApi(short_id, group_id, tag, status){
	//新增刪除修改tag
	return $.ajax({
				url: "setTag.php?map_id="+encodeURIComponent(short_id)+"&user_id="+group_id+"&tags="+encodeURIComponent(tag)+"&status="+status,
				type:"GET",
				dataType:'html',
				cache: false,

				success: function(textPage){
					if(textPage != ""){
						var data = JSON.parse(textPage);
						console.log(data);
						if(data.note == "new_tag") $("#tag_select").append("<option>"+tag+"</option>");
					}
				},

				error:function(xhr, ajaxOptions, thrownError){
					//更新失敗，跳出警告，開啟原本視窗
					$.growlUI('', 'Error occurred, please refresh the page.');
				}
			});
}

function toLowerArray(array){
	//陣列內容強制小寫
	for (var i = 0; i < array.length; i++) {
        array[i] = array[i].toString().toLowerCase(); 
    }
    return array;
}

function inviteEvent(status){
	blockUI_show = false;

	if(invite_id != "" && invite_id != undefined){
		$.ajax({
			url: "setInvite.php?id="+invite_id+"&status="+status,
			type: "GET",
			dataType: 'html',
			cache: false,
			async: true,

			success: function(textPage){
				console.log('done');
			},

			error: function(xhr, ajaxOptions, thrownError){
				console.log('fail');
			}
		});
	}
	$.unblockUI();
}

function setAd(on){
	var link_desc_span = "";

	if(on == 1){
		//分潤
		link_desc_span = "PICS.EE | By <a>您的粉絲專頁名稱</a>";
		//$("#short_link").val($("#short_link").val().replace("http://pics.ee", "http://pro.pics.ee"));	remove by func
		$("#short_link").val($("#short_link").val().replace(protocol+short_domain, "https://picsee.pro/"));
		$("#short_domain_box a").html("https://picsee.pro/");
	}else{
		link_desc_span = "PICS.EE | By <a>YouTube</a>";
		//$("#short_link").val($("#short_link").val().replace("http://pro.pics.ee", "http://pics.ee")); remove by func
		$("#short_link").val($("#short_link").val().replace("https://picsee.pro/", protocol+short_domain));
		$("#short_domain_box a").html(protocol+short_domain);
	}
	$("#link_desc span").html(link_desc_span);

	
	var domain = protocol+short_domain;
	var parser = document.createElement('a');
	parser.href = domain;
	domain = parser.hostname;

	setTimeout(function(){
		if(short_key != ""){
			$.ajax({
				url: "setLink.php?encode_id="+encodeURIComponent(short_key)+"&domain="+encodeURIComponent(domain)+"&ad_on="+on+"&yt_mp4="+encodeURIComponent(window.mp4url),
				type:"GET",
				dataType:'html',
				cache: false,

				success: function(textPage){
					console.log("setAd: "+textPage);
					$.growlUI('', 'Changes saved!');
					//記住這次的選擇
					$.cookie("ad_share", on, { expires: 1000000 });
					ga('send', 'event', 'Index', 'set AD '+on);
				},

				error:function(xhr, ajaxOptions, thrownError){
					$.growlUI('', 'Error occurred, please refresh the page.');
				}
			});
		}
	}, 1000);
}

function setPlayIcon(on){
	if(on){
		//顯示播放按鈕
		ga('send', 'event', 'Index', 'Set Play Icon', "On");

		image_url = play_image_url;
		short_key = org_short_key;
		short_id = org_short_id;
		short_domain = org_short_domain;
		done_image = image_url;
		var lnk;

		if(group_func.ad == 1 && $("#ad_share").bootstrapSwitch('state') == true && image_type == "video"){
			lnk = "https://picsee.pro/" + short_key;
			setAd(1);
		}else{
			lnk = protocol + short_domain + short_key;
			setAd(0);
		}
		
		$("#short_link").val(lnk);
		$("#cshort_link_input").val(short_key);
		$("#short_link_anal").attr("href", "https://pics.ee/"+short_key+"+");
		$("#short_link").focus().select();
		$("#link_video").css("background-image", "url("+image_url+")");
		$("#play").css("opacity", "1");
		emph_dom("#short_link");
	}else{
		//不顯示播放按鈕
		ga('send', 'event', 'Index', 'Set Play Icon', "Off");

		image_url = org_image_url;
		$("#play_icon").bootstrapSwitch('disabled', true);
		getLink();
	}
}

function setUTM(target){
	if(target === undefined){
		if($("#group_id").val() !== undefined && $("#group_id").val() != "" && group_func.level >= 500 && short_key != ""){
			var source = $("#utm_source").val();
			var medium = $("#utm_medium").val();
			var campaign = $("#utm_campaign").val();
			var content = $("#utm_content").val();
			var term = $("#utm_term").val();
			var fb_pixel = $("#utm_fb_pixel").val();
			var g_tag = $("#utm_g_tag").val();
			
			//寫入DB，link的UTM
			var group_id = (group_func.level >= 500)?$("#group_id").val():"";
			$.ajax({
				url: "setLink.php?encode_id="+encodeURIComponent(short_key)+"&group_id="+group_id+"&source="+encodeURIComponent(source)+"&medium="+encodeURIComponent(medium)+"&campaign="+encodeURIComponent(campaign)+"&content="+encodeURIComponent(content)+"&term="+encodeURIComponent(term)+"&fb_pixel="+encodeURIComponent(fb_pixel)+"&g_tag="+encodeURIComponent(g_tag),
				type:"GET",
				dataType:'html',
				cache: false,

				success: function(textPage){
					console.log("setUTM: "+textPage);
					$.growlUI('', 'Changes saved!');
					ga('send', 'event', 'Index', 'Set UTM');
				},

				error:function(xhr, ajaxOptions, thrownError){
					$.growlUI('', 'Error occurred, please refresh the page.');
				}
			});
		}else{
			//do nothing
		}
	}else{
		var domID = '#utm_'+target;
		var utm_value = $(domID).val();

		if(utm_value == "utm_new"){
			$(domID+"_value").val("");
			$(domID+"_new").show();
			$(domID).val("");
			$(domID).hide();
		}else{
			console.log("setUTM: "+target);
			$.cookie("utm_"+target, utm_value, { expires: 1000000 });
			setUTM();	//寫入DB
		}
	}
}

function addUTM(target, add){
	var domID = '#utm_'+target;
	console.log('add'+target);
	if(add){
		$("img.utm_"+target).show();
		var utm_value = $(domID+"_value").val();
		var group_id = (group_func.level >= 500)?$("#group_id").val():"";
		var note = "";
		var note_query = "";
		var default_name = {fb_pixel: "Default Pixel", g_tag: "Default GTM"};
		var regex = {fb_pixel: /^[0-9]{3,}$/, g_tag: /^GTM\-[0-9A-Z]{4,}$/};
		if(target in default_name){
			note = $(domID+"_note").val()!=""? $(domID+"_note").val(): default_name[target];
			if(!regex[target].test(utm_value)){
				$("img.utm_"+target).hide();
				$.growlUI('', 'Please confirm that the information is correct');
				return;
			}
			note_query = "&note="+encodeURIComponent(note);
		} 

		$.ajax({
			url: "setUTM.php?group_id="+group_id+"&name="+encodeURIComponent(target)+"&value="+encodeURIComponent(utm_value)+note_query+"&add",
			type:"GET",
			dataType:'html',
			cache: false,

			success: function(textPage){
				console.log("addUTM: "+textPage);

				$("img.utm_"+target).hide();
				var v = textPage;
				var n = (target in default_name)?note:textPage;

				//移除「新增」
				$(domID+" option[value=utm_new]").remove();
				//加在下拉選單裡面，再加回「新增」
				$(domID).append($("<option value=\""+v+"\" selected=selected>"+n+"</option><option value=\"utm_new\">[Add]</option>"));

				setUTM(target);
				$(domID).show();
			},

			error:function(xhr, ajaxOptions, thrownError){
				$("img.utm_"+target).hide();
				$(domID).show();
				$.growlUI('', 'Error occurred, please refresh the page.');
			}
		});
	}else{
		//select the first one
		$(domID).val($(domID + " option:first").val());
		$(domID).show();
	}

	$(domID+"_new").hide();
}

function getUTM(group_id){
	//把客製化網域在這邊一起處理
	var d_id = (group_id)?group_id:$.cookie("user_id");
	var protocol_level = 0; //預設的ssl level
	//非客製化網址判斷是否由群組發送
	/*if(!isCustomizedDomain){
		//short_domain = (group_id || isYoutube(user_url))? "pics.ee/": "lnk.pics/";  //專業版用戶或yt
		protocol = "https://";
	}
	protocol = (short_domain == "pics.ee/" || short_domain == "lnk.pics/")? "https://": "http://";
	$("#short_link").val(protocol+short_domain+short_key);*/

	//讀取客製化網域
	$.ajax({
		url: "getDomain.php?group_id="+d_id,
		type:"GET",
		dataType:'html',
		cache: false,

		success: function(textPage){
			console.log(textPage);
			if(textPage != ""){
				if(customize) setCustomizeLink();
				var domainObj = jQuery.parseJSON(textPage);
				short_domain_list = domainObj;

				if(isCustomizedDomain){
					//原始網址是客製化的
					/*short_domain_list.short_domain.unshift(short_domain.replace("/", ""));
					var domainObj_level = null;
					if(protocol == "https://") domainObj_level = 1;

					short_domain_list.level.unshift(domainObj_level);*/
				}else{
					//非客製化套用客製化列表第一個
					//short_domain = domainObj["short_domain"][0]+"/";
					protocol_level = domainObj["level"][0];
				}
			}else{
				//沒客製化Domain可以用
				//清除備選domain清單
				short_domain_list = [];
			}
			//同步所見即所得
			if(isCustomizedDomain) setDomain(short_domain.replace("/",""), protocol_level);
		},

		error:function(xhr, ajaxOptions, thrownError){
			//$.growlUI('', 'Error occurred, please refresh the page.');
		}
	});

	if(group_id === undefined){
		$('#group_function').hide();
		return;
	}
	$('#group_function').show();

	//讀取UTM
	$.ajax({
		url: "getUTM.php?group_id="+group_id,
		type:"GET",
		dataType:'html',
		cache: false,

		success: function(textPage){
			//console.log("getUTM: "+textPage);
			var utmObj = jQuery.parseJSON(textPage);

			////新建
			setOption(utmObj, "g_tag");		//Google Tag
			setOption(utmObj, "fb_pixel");	//Facebook Pixel
			setOption(utmObj, "source");	//utm_source
			setOption(utmObj, "medium");	//utm_medium
			//setOption(utmObj, "campaign");	//utm_campaign
			//setOption(utmObj, "content");	//utm_content

			if(is_edit){
				//編輯模式
				$("#utm_campaign").val("");
				$("#utm_content").val("");
				$("#utm_term").val("");
			}else{
				if($.cookie("utm_campaign") != "") $("#utm_campaign").val($.cookie("utm_campaign"));
				if($.cookie("utm_content") != "") $("#utm_content").val($.cookie("utm_content"));
				if($.cookie("utm_term") != "") $("#utm_term").val($.cookie("utm_term"));
			}
			
			if(short_id != "") setUTM();
		},

		error:function(xhr, ajaxOptions, thrownError){
			$.growlUI('', 'Error occurred, please refresh the page.');
		}
	});

	function setOption(utmObj, target){
		$("#utm_"+target).html("");
		$("#utm_"+target).append("<option value=\"\"></option>");
		if(utmObj != null && utmObj[target] !== undefined){
			for (var v in utmObj[target]){
				var value = utmObj[target][v]["value"];
				var note = (target == "fb_pixel" || target == "g_tag")?utmObj[target][v]["note"]:value;
				//帶入utm用的陣列
				var track_list = {g_tag: "", fb_pixel: "", source: "", medium: ""};
				//動態加入utm到下拉選單
				if(is_edit){
					if(track_list[target] == value)
						$("#utm_"+target).append("<option value=\""+value+"\" selected=selected>"+note+"</option>");
					else
						$("#utm_"+target).append("<option value=\""+value+"\">"+note+"</option>");
				}else{
					if($.cookie("utm_"+target) == value)
						$("#utm_"+target).append("<option value=\""+value+"\" selected=selected>"+note+"</option>");
					else
						$("#utm_"+target).append("<option value=\""+value+"\">"+note+"</option>");
				}
			}
		}
		$("#utm_"+target).append("<option value=\"utm_new\">[Add]</option>");
	}
}

function showMore(hide){
	var m = $('#show_more').html();
	$('#show_more').show();
	if(m == "Hide" || hide !== undefined){
		$('#show_more').html("More Options");
		$('#more_function').hide();
		$('#map_tag').hide();
		$('#target_redirect').hide();
	}else{
		$('#show_more').html("Hide");
		$('#more_function').show();
	}
}
function addEditTarget(target_url, index){
	//編輯模式使用會再調整 未完成
	var expression = /^[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}(\/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi;	//支援手機deep link
	var regex = new RegExp(expression);

	if(!target_url.match(regex)){
		$.growlUI('', 'URL format error, please add http://'); 
		return;
 	}

 	var domain_name = $('<a>').prop('href', target_url).prop('hostname');
 	if(domain_name.toLowerCase() == "t.co"){
		$.growlUI('', 'Cannot shorten pics.ee URL'); 
		return;
	}
	target_url = setUrlNormalize(target_url);

	if(target_url == user_url){
		emph_dom("#target_redirect_default");
		return;
	}

	for(var rule in target_redirect_rule){
		if(target_redirect_rule[rule] == target_url){
			emph_dom("#rules_"+rule);
			return;
		}
	}

	if(target_redirect_rule[index] == 0){
		//加上顯示UI
		$("#target_redirect_rules").append("<div id=\"rules_"+index+"\" class=\"rules\"><span>"+$("#target_redirect_option option:selected").text().replace(/\s*\(.*?\)\s*/g, '')+" redirect to: </span> <input type=\"text\" class=\"form-control input-lg\" value=\""+target_url+"\" /> <input type=\"button\" class=\"btn btn-default btn-default\" value=\"Delete\" onclick=\"delTarget('"+index+"')\" /></div>");
		//紀錄這平台用過
		target_redirect_rule[index] = target_url;
		//下拉選單中藏起該平台
		$("#option_"+index).hide();
		//讓下拉選單選到第一個沒被藏的平台
		$("#target_redirect_option option").filter(function() { return $(this).css("display") != "none" }).first().prop("selected", true);
		//清除文字方塊文字
		$("#target_redirect_option_url").val("");

	}else return;
}

function addTarget(){

	var target_url = $("#target_redirect_option_url").val();
	var index = $("#target_redirect_option").val();
	var expression = /^[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}(\/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi;	//支援手機deep link
	var regex = new RegExp(expression);

	if(!target_url.match(regex)){
		$.growlUI('', 'URL format error, please add http://'); 
		return;
 	}

 	var domain_name = $('<a>').prop('href', target_url).prop('hostname');
 	if(domain_name.toLowerCase() == "t.co"){
		$.growlUI('', 'Cannot shorten pics.ee URL'); 
		return;
	}
	target_url = setUrlNormalize(target_url);

	if(target_url == user_url){
		emph_dom("#target_redirect_default");
		return;
	}

	for(var rule in target_redirect_rule){
		if(target_redirect_rule[rule] == target_url){
			emph_dom("#rules_"+rule);
			return;
		}
	}

	if(target_redirect_rule[index] == 0){
		//加上顯示UI
		$("#target_redirect_rules").append("<div id=\"rules_"+index+"\" class=\"rules\"><span>"+$("#target_redirect_option option:selected").text().replace(/\s*\(.*?\)\s*/g, '')+" redirect to: </span> <input type=\"text\" class=\"form-control input-lg\" value=\""+target_url+"\" /> <input type=\"button\" class=\"btn btn-default btn-default\" value=\"Delete\" onclick=\"delTarget('"+index+"')\" /></div>");
		//紀錄這平台用過
		target_redirect_rule[index] = target_url;
		//下拉選單中藏起該平台
		$("#option_"+index).hide();
		//讓下拉選單選到第一個沒被藏的平台
		$("#target_redirect_option option").filter(function() { return $(this).css("display") != "none" }).first().prop("selected", true);
		//清除文字方塊文字
		$("#target_redirect_option_url").val("");
		//emph_dom("#target_redirect_save");
		setTarget();

		ga('send', 'event', 'Index', 'Set Target', 'add');
	}else return;
}

//依據看過連結轉址
function addTargetX(){
	var index = $("#target_redirect_option").val();
	var random_id = Math.floor((Math.random() * 1000) + 1);

	if(index == "picsee"){
		var rule_id = index+random_id;
		$("#target_redirect_rules").append("<div id=\"rules_"+rule_id+"\" class=\"rules\"><span style=\"width: 400px;\">View from  "+short_domain+"<input type=\"text\" class=\"form-control input-lg\" style=\"width: 100px;\" placeholder=\"Short Key\" title=\"\" onblur=\"setTargetX('"+rule_id+"', true);\"> add UTM: </span> <input type=\"text\" placeholder=\"utm_source\" class=\"form-control input-lg\" style=\"width: 130px;\" onblur=\"setTargetX('"+rule_id+"', false);\"> <input type=\"text\" placeholder=\"utm_medium\" class=\"form-control input-lg\" style=\"width: 130px;\" onblur=\"setTargetX('"+rule_id+"', false);\"> <input type=\"text\" placeholder=\"utm_campaign\" class=\"form-control input-lg\" style=\"width: 130px;\" onblur=\"setTargetX('"+rule_id+"', false);\"> <input type=\"button\" class=\"btn btn-default btn-default\" value=\"Delete\" onclick=\"delTarget('"+rule_id+"')\" /></div>");
	}
}

function delTarget(index){
	if(typeof target_redirect_rule[index] == 'undefined'){
		$("#rules_"+index).remove();
	}else{
		//移除紀錄
		target_redirect_rule[index] = 0;
		//移除UI
		$("#rules_"+index).remove();
		//恢復下拉選單
		$("#option_"+index).show();
		//emph_dom("#target_redirect_save");
		setTarget();
	}
	
	ga('send', 'event', 'Index', 'Set Target', 'delete');
}

function setTarget(){
	if($.cookie("user_id") === null){
		$.growlUI('', 'Please log in or register');
	}else{
		//console.log(target_redirect_rule);
		if($("#target_redirect_option_url").val() != ""){
			//因應有些腦殘會不新增就按儲存
			addTarget();
			return;
		}

		$("#target_redirect .loading").show();
		$("#target_redirect_save").hide();

		$.ajax({
			type: 'POST',
			url: "setTarget.php",
			data: "id="+short_id+"&"+$.param(target_redirect_rule, true),
			dataType:'html',
			cache: false,
			async: true,

			success: function(textPage){
				ga('send', 'event', 'Index', 'Set Target', 'set');
				$("#target_redirect .loading").hide();
				$("#target_redirect_save").show();
				$.growlUI('', 'Changes saved!');
			},

			error:function(xhr, ajaxOptions, thrownError){
				$("#target_redirect .loading").hide();
				$("#target_redirect_save").show();
				$.growlUI('', 'Error occurred, please refresh the page.');
			}
		});
	}
}

function setTargetX(rule_id, check_encode){
	//抓ID、rule ID、建立/修改UTM值
	if(check_encode){
		//還沒初始化過，沒檢查過DB
		if(($("#rules_"+rule_id+" input")[0]).value != ""){
			var encode_id = ($("#rules_"+rule_id+" input")[0]).value;
			$.ajax({
				url: "getTarget.php?encode_id="+encode_id,
				type:"GET",
				dataType:'html',
				cache: false,
				async: true,

				success: function(textPage){
					if(textPage != ""){
						//成功
						var results = JSON.parse(textPage);
						var new_rule_id = "map_"+results['id'];
						//console.log(rule_id);

						//換rule_id
						$("#rules_"+rule_id).attr("title", results['title']);
						$.growlUI('Changes saved!', results['title']);
						$("#rules_"+rule_id+" input[type=text]").attr("onblur", "setTargetX('"+new_rule_id+"', false)");
						$("#rules_"+rule_id+" input[type=text]:nth-child(1)").attr("onblur", "setTargetX('"+new_rule_id+"', true)");	//encode_id
						$("#rules_"+rule_id+" input[type=button]").attr("onclick", "delTarget('"+new_rule_id+"')");
						$("#rules_"+rule_id).attr("id", "rules_"+new_rule_id);
					}
				},

				error:function(xhr, ajaxOptions, thrownError){
					//找不到
					$.growlUI('', 'URL format error, please add http://');
					($("#rules_"+rule_id+" input")[0]).value = "";
					($("#rules_"+rule_id+" input")[1]).value = "";
					($("#rules_"+rule_id+" input")[2]).value = "";
					($("#rules_"+rule_id+" input")[3]).value = "";
					delete target_redirect_rule[rule_id];
					setTarget();
					return;
				}
			});
		}
	}else{
		//更新陣列
		var utm_source = (($("#rules_"+rule_id+" input")[1]).value != "")?("utm_source="+encodeURIComponent(($("#rules_"+rule_id+" input")[1]).value)):"";
		var utm_medium = (($("#rules_"+rule_id+" input")[2]).value != "")?("&utm_medium="+encodeURIComponent(($("#rules_"+rule_id+" input")[2]).value)):"";
		var utm_campaign = (($("#rules_"+rule_id+" input")[3]).value != "")?("&utm_campaign="+encodeURIComponent(($("#rules_"+rule_id+" input")[3]).value)):"";
		var utms = utm_source+utm_medium+utm_campaign;

		var url_element = $('<a>').prop('href', user_url);
		var query = url_element.prop('search');
		query = (query == "")?("?"+utms):(query+"&"+utms);
		
		var redirect_url = url_element.prop('protocol')+"//"+url_element.prop('hostname')+url_element.prop('pathname')+query+url_element.prop('hash');
		//console.log(redirect_url);
		//return;

		if(utms != ""){
			target_redirect_rule[rule_id] = redirect_url;
			setTarget();
		}
	}
}

/* 用API改圖沒用了
function postToFB() {
	if($.cookie("user_id") === null){
		$.growlUI('', 'Please log in or register');
	}else{
		var short_link = $('#short_link').val();
		var url = $('<a>').prop('href', user_url).prop('hostname');
		ga('send', 'event', 'Index', 'Post To FB', 'init');

		//檢查能不能popup
		if($.cookie("popup") != "true"){
			var popup = window.open('about.php');
			if(!popup || popup.closed || typeof popup.closed == 'undefined'){
				$.growlUI('', 'Please allow pop-up windows');
				return;
			}else{
				popup.close();
				$.cookie("popup", true, { expires: 1000000 });
			}
		}

		FB.init({
			appId      : '150378901782986',
			xfbml      : true,
			version    : 'v2.5'
		});

		if(image_type == 'static'){
			FB.ui(
				{
					method: 'share',
					display: 'dialog',
					mobile_iframe: true,
					title: title,
					description: description,
					picture: image_url,
					href: short_link+'/fb',
					caption: url,
				},
				res
			);
		}else{
			FB.ui(
				{
					method: 'share',
					display: 'dialog',
					mobile_iframe: true,
					href: short_link,
				},
				res
			);
		}

		var res = function(response){
			if (response && !response.error_message) {
				//成功了
				ga('send', 'event', 'Index', 'Post To FB', 'done');
				if(confirm("Posted. Do you want to view the post?")){
					var lk = (response.post_id !== undefined)?("http://facebook.com/"+response.post_id):("http://facebook.com/");
					$("<a>").attr("href", lk).attr("target", "_blank")[0].click();
				}

				$('body').scrollTo('#preview', 500);
				var post_id = (response.post_id !== undefined)?(response.post_id):("");
				$.ajax({
					url: "setMap.php?id="+short_id+"&post_id="+post_id+"&url="+encodeURIComponent(user_url)+"&key="+key,
					type:"GET",
					dataType:'html',
					cache: false,
					async: true,

					success: function(textPage){
						//console.log(textPage);
					},

					error: function(xhr, ajaxOptions, thrownError){
					}
				});
			}else{
				//失敗了
				$("#short_link").focus().select();
				$('body').scrollTo('#preview', 500);
			}
		}
	}
}*/

function showInvite(){
	console.log("showInvite");
	//2秒後跳出邀請視窗
	setTimeout(function(){
		$.ajax({
			url: "getInvite.php",
			type:"GET",
			dataType:'html',
			cache: false,
			async: true,

			success: function(res){
				//console.log('res'+res);

				if(res != ""){
					results = JSON.parse(res);
					if(results['id'] != "" && results['id'] != undefined){
						blockUI_show = true;
						$('#invite_pro_title').html('📢' + results['name'] + '📢 Hello:');
						$('#invite_pro_desc').html(results['description']);
						if(results['url'] == null){
							$('#invite_intent').hide();
						}else{
							$('#invite_intent').attr('href', results['url']);
						}
						invite_id = results['id'];
						$.blockUI({
							message: $('#invite_pro'),
							css: {
								padding: '20px',
								left: ($(window).width() - 520) /2 + 'px',
								cursor: 'pointer',
								width: '520px',
								top: '350px',
							},
							showOverlay: false,
						});
					}else if(results['invite_count'] != "" && results['invite_count'] != undefined){
						$('#invite_count').html(invite_count);
						ga('send', 'event', 'Index', 'Show Invite');
						$.blockUI({
							message: $('#invite_member'),
							css: {
								padding: '20px',
								left: ($(window).width() - 520) /2 + 'px',
								cursor: 'pointer',
								width: '520px'
							},
							onOverlayClick: $.unblockUI
						});
					}
				}
				return;
			},
			error: function(xhr, ajaxOptions, thrownError){
			}
		});
	}, 2000);
}

function setCustomizeLink(){
	if($.cookie("user_id") === null){
		//$.growlUI('', 'Please log in or register');
	}else{
		if(!customize){
			//進入編輯模式
			$('#cshort_link_btn').val("OK");
			$('#cshort_link_btn').removeClass("btn-default").addClass("btn-success");
			$('#cshort_link_btn').show();
			$('#basic_function').hide();
			$('#show_more').hide();
			$('#cshort_link_box').show();
			$('#more_function').show(); 

			if(!short_domain_list["short_domain"] && (($("#group_id").val() !== undefined && group_func.level >= 500) || isYoutube(user_url))){
				//專業版或是YT
				//short_domain_list["short_domain"] = [];
				//short_domain_list["level"] = [];
				//先註解掉不給選了
				//short_domain_list.short_domain.push("pics.ee");
				//short_domain_list.level.push(3);
			}

			if(group_func.ad == 1 && $("#ad_share").bootstrapSwitch('state') == true && image_type == "video"){
				//分潤，不能客製化網域
				//$('#cshort_link_box a').text('http://pro.pics.ee/'); remove by func 10/17
				$('#short_domain_box').html('<a style="font-size: 20px; color: #eeea38;">https://picsee.pro/</a>');
			}else{
				if(short_domain_list["short_domain"]){
					//有多個網域，可以客製化
					var li_html = "";
					for (var i in short_domain_list["short_domain"]) {
						li_html += "<li><a onclick=\"setDomain('"+short_domain_list["short_domain"][i]+"', "+short_domain_list["level"][i]+");\">"+short_domain_list["short_domain"][i]+"</a></li>";
					}

					$('#short_domain_box').html('<div class="btn-group"><button type="button" class="btn btn-default btn-lg" id="short_domain_display">'+protocol+short_domain+'</button><button type="button" class="btn btn-default btn-lg dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button><ul class="dropdown-menu" role="menu">'+li_html+'</ul></div>');
				}else{
					//沒有短網域，不能客製化
					$('#short_domain_box').html('<a style="font-size: 20px; color: #eeea38;">'+protocol+short_domain+'</a>');
				}
			}
			$('#cshort_link_input').val(short_key).focus().select();
			customize = true;
		}else{
			ga('send', 'event', 'Index', 'Set Customize Link');
			var cshort_key = $("#cshort_link_input").val();
			if(cshort_key.length == 0){
				$.growlUI('', 'Please input customized link'); 	//標題,內文
				$("#cshort_link_input").focus().select();
				return;
			}else if(cshort_key == short_key){
				//直接ok不用檢查
				if(group_func.ad == 1 && $("#ad_share").bootstrapSwitch('state') == true && image_type == "video"){
					//var lnk = "http://pro.pics.ee/" + short_key;	remove by func 10/17
					var lnk = "https://picsee.pro/" + short_key;
				} 
				else var lnk = protocol + short_domain + short_key;
				setCustomizeLinkDone(lnk);
			}else{
				var regex = /^([a-zA-Z0-9~_\-]{1,})$/;
				if(!regex.test(encodeURIComponent(cshort_key)) || cshort_key.charAt(cshort_key.length-1) == "+"){//正規表達式去掉不合規則的
					$.growlUI('', 'Customized Link Cannot include dots(.), slashes(/) or other special characters');
					$('#show_more').show();
					$("#cshort_link_input").focus().select();
					return;
				}

				var vid = isYoutube(user_url);
				var url = (vid)?("https://www.youtube.com/watch?v="+vid):user_url;
				$('#cshort_link_box .loading').show();
				$('#cshort_link_btn').hide();

				$.ajax({
					url: "setLink.php?id="+short_id+"&encode_id="+encodeURIComponent(cshort_key)+"&url="+encodeURIComponent(url),
					type:"GET",
					dataType:'html',
					cache: false,
					async: true,

					success: function(textPage){
						if(textPage != ""){
							//成功
							short_key = cshort_key;
							//var lnk = (($("#ad_share").bootstrapSwitch('state') == true && $("#ad_share").is(':visible')) || (image_type == 'video' && group_func.level != null))?("http://pro.pics.ee/"+cshort_key):("http://pics.ee/"+cshort_key);
							var lnk = (($("#ad_share").bootstrapSwitch('state') == true && $("#ad_share").is(':visible')) && image_type == 'video')?("https://picsee.pro/"+cshort_key):(protocol + short_domain+cshort_key);
							//客製化等自訂domain的pro處理完再做
							//lnk = short_domain + short_key;
							customized_url = true;
							setCustomizeLinkDone(lnk);
						}else{
							//碰撞
							$.growlUI('', 'Customization Link has been used, Please try another one.');
							$('#show_more').show();
							$('#cshort_link_btn').show();
							$('#cshort_link_box .loading').hide();
							$("#cshort_link_input").focus().select();
							return;
						}
					},

					error:function(xhr, ajaxOptions, thrownError){
						$.growlUI('', 'Security check failed. Please make sure your browser has only one PicSee window open and refresh the page.');
						$('#show_more').show();
						$('#cshort_link_btn').show();
						$('#cshort_link_box .loading').hide();
						$("#cshort_link_input").focus().select();
						return;
					}
				});
			}
		}
	}
}

function setDomain(domain, level){
	short_domain = domain+"/";
	protocol = (level >= 3 || domain == "pics.ee")? "https://": "http://";
	$("#short_link").val(protocol+short_domain+short_key);
	$("#short_domain_display").text(protocol+short_domain);
	ga('send', 'event', 'Index', 'Set Short Domain', domain);

	if(short_key){
		$.ajax({
			url: "setLink.php?encode_id="+encodeURIComponent(short_key)+"&domain="+domain,
			type:"GET",
			dataType:'html',
			cache: false,
			async: true,

			success: function(textPage){
			},

			error:function(xhr, ajaxOptions, thrownError){
				$.growlUI('', 'Security check failed. Please make sure your browser has only one PicSee window open and refresh the page.');
			}
		});
	}
}

function setCustomizeLinkDone(lnk){
	$('#cshort_link_btn').val("Customize Link");
	$('#cshort_link_btn').removeClass("btn-success").addClass("btn-default");
	$('#cshort_link_btn').hide();
	$('#basic_function').show();
	$('#cshort_link_box .loading').hide();
	$('#cshort_link_box').hide();
	$('#short_link').val(lnk).focus().select();
	$("#short_link_anal").attr("href", lnk+"+");
	copyInputText('#short_link');
	showMore();
	customize = false;
}

function boost(){
	ga('send', 'event', 'Index', 'boost', $.cookie('browser_id'));
	$('#hide_link').attr('href', 'https://picsee.co/boost/'+short_key+"#edit");
	document.querySelector('#hide_link').click();
}

function moveImage(){
	var ratio = (image_height*1.9 > image_width)?(470/image_width):(246/image_height);

	var init = {
		x: $("#link_image").offset().left,
		y: $("#link_image").offset().top,
	}
	$("body").mousemove(function(event){		
		var x = 50, y = 50;
		//var pos = "";

		if(image_height*1.9 > image_width){		//高
			y = event.pageY-init.y-(image_height*ratio/2);
			if(y > 0) y = 0;
			if(y < 246-image_height*ratio) y = 246-image_height*ratio;

			//pos = "background-position-y: "+y+"px;";
			$("#link_image").css("background-position-y", y+"px");
			image_top_percent = (y == 0)?0:(-y*100/(image_height*ratio-246));
			image_left_percent = 50;

		}else{									//寬
			x = event.pageX-init.x-(image_width*ratio/2);
			if(x > 0) x = 0;
			if(x < 470-image_width*ratio) x = 470-image_width*ratio;

			//pos = "background-position-x: "+x+"px;";
			$("#link_image").css("background-position-x", x+"px");
			image_top_percent = 50;
			image_left_percent = (x == 0)?0:(-x*100/(image_width*ratio-470));
		}
		//clientCoords = "( " + init.x-event.clientX + ", " + init.y-event.clientY + " )";
		//console.log(x+", "+y);
		//$("#link_image").css("background-image", "url("+image_url+")");
	});
	$("body").mouseup(function(){
		$('#link_image_hint').show();
		$("body").off("mousemove");
	});
}

function copyInputText(id){
	//var text = $(id).val();
	//copyTextToClipboard(text);
	//$(id).focus().select();
	document.querySelector(id).focus();
	document.execCommand('selectAll', false, null)
	var successful = document.execCommand('copy');
	if(successful && !blockUI_show){
		$.growlUI('', 'Link copied to clipboard');
	}
	var msg = successful ? 'successful' : 'unsuccessful';
	console.log('Copying text command was ' + msg);
}

function showHideHTML(id){
	if($(id).is(':visible')) $(id).hide(200);
	else $(id).show(200);
}

function addJSSrc(id, src) {
	var js, fjs = document.getElementsByTagName('script')[0];
	if (document.getElementById(id)) return;
	js = document.createElement('script');
	js.id = id;
	js.src = src;
	fjs.parentNode.insertBefore(js, fjs);
}

</script>
<script type="text/javascript">
/*var dt;
var upload_count = 1;
function setUpload(){	
    var ul = $('#upload_progress');
    document.getElementsByName("user_url")[0].value = user_url;
    //document.getElementsByName("key")[0].value = key;

    $('#upload_a').click(function(){
        // Simulate a click on the file input button
        // to show the file browser dialog
        $(this).parent().find('input').click();
        ul.html("");
    });
    // Initialize the jQuery File Upload plugin
    $('#upload').fileupload({
        // This element will accept file drag/drop uploading
        dropZone: $('#drop'),
        // This function is called when a file is added to the queue;
        // either via the browse button, or via drag/drop:
        add: function (e, data) {
        	document.getElementsByName("key")[0].value = key+"_"+upload_count++;

            var tpl = $('<div class="working"><input type="text" value="0" data-width="48" data-height="48" data-fgColor="#ecd357" data-readOnly="1" data-bgColor="#FFF" /><span></span></div>');
            // Append the file name and file size
            tpl.find('span').text(data.files[0].name);
            // Add the HTML to the UL element
            data.context = tpl.appendTo(ul);
            // Initialize the knob plugin
            tpl.find('input').knob();
            // Listen for clicks on the cancel icon
            /*tpl.find('span').click(function(){
                if(tpl.hasClass('working')){
                    jqXHR.abort();
                }
                tpl.fadeOut(function(){
                    tpl.remove();
                });
            });
            // Automatically upload the file once it is added to the queue
            var jqXHR = data.submit();
        },

        progress: function(e, data){
            // Calculate the completion percentage of the upload
            var progress = parseInt(data.loaded / data.total * 100, 10);
            // Update the hidden input field and trigger a change
            // so that the jQuery knob plugin knows to update the dial
            data.context.find('input').val(progress).change();
            if(progress == 100){
                data.context.removeClass('working');
            }
			$("#link_image").css("background-image", "url(images/making.gif)");
			$("#link_image").css("background-position-x", "");
			$("#link_image").css("background-position-y", "");
			$("#link_video").css("background-image", "url(images/making.gif)");
            //setPic("images/making.gif", 0);
            $('#upload_box').show();
			$("#hide_upload").show();
        },

        fail:function(e, data){
            // Something has gone wrong!
            data.context.addClass('error');
            ul.html("");
            $('#upload_box').hide();
			$("#hide_upload").hide();
        }
    })
	.bind('fileuploaddone', function (e, data) {
		//dt = data;
		
		//console.log("result: "+data.result+"status: "+data.textStatus+" jqXHR:"+data.jqXHR);

		var wait = setTimeout(function(){
			if(data != undefined){
				dt = data;
				console.log(data.result);
				if(data.result.indexOf("temp") == 0){
					//$("#link_image").attr("style", "background-image: url("+data.result+")");
					var path = ((location.pathname.indexOf('/picsee/') == 0)?("//"+location.hostname+"/picsee/"):"http://"+location.hostname+"/");
					var fullpath = path+data.result+"?"+(new Date().getTime());
					setPic(fullpath, 0, true);

					$("#pics").append('<div class="float_image"><img src="'+fullpath+'" onclick="setPic(\''+fullpath+'\', 0, true)"></div>');
					//$("#pics").prepend("<img src=\""+path+"\" class=\"float_image\" onclick=\"setPic('"+path+"', 0)\">");
				}else{
					//alert("Image upload failed. Check image format, Maximum file size is 2MB.");
					$.growlUI('', 'Image upload failed. Check image format, Maximum file size is 2MB.');
				}
				clearTimeout(wait);
				ul.html("");
				$('#upload_box').hide();
				$("#hide_upload").hide();
				ga('send', 'event', 'Index', 'Set Img From Upload');
			}
		}, 500);

		

	});


    // Prevent the default action when a file is dropped on the window
    /*$(document).on('drop dragover', function (e) {
        e.preventDefault();
    });*/

    // Helper function that formats the file sizes
/*    function formatFileSize(bytes) {
        if (typeof bytes !== 'number') {
            return '';
        }

        if (bytes >= 1000000000) {
            return (bytes / 1000000000).toFixed(2) + ' GB';
        }

        if (bytes >= 1000000) {
            return (bytes / 1000000).toFixed(2) + ' MB';
        }

        return (bytes / 1000).toFixed(2) + ' KB';
    }
}*/

function previewImage(img){
	if(img.files && img.files[0]){
        var reader = new FileReader();

        reader.onload = function (e) {
        	img_base64_data = e.target.result;

        	if(img.files[0].type.indexOf("image") == 0){
        		//file type是圖片
        		setPic(img_base64_data, 0, true);
            	$("#pics").append('<div class="float_image"><img src="'+img_base64_data+'" onclick="setPic(\''+img_base64_data+'\', 0, true)"></div>');
        	}else{
        		$.growlUI('', 'Image upload failed. Check image format, Maximum file size is 2MB.');
        	}
        }

        reader.onerror = function (e) {
        	$.growlUI('', 'Image upload failed. Check image format, Maximum file size is 2MB.');
        }

        reader.readAsDataURL(img.files[0]);
    }
}
</script>
<script type="text/javascript">
var player;
var playTimer;
//var yt_id = 'AK0GheYwUNI';
//addJSSrc('yt_api', '//www.youtube.com/iframe_api');

function onYouTubeIframeAPIReady() {
	player = new YT.Player('player', {
		height: 141,
		width: 250,
		videoId: yt_id,
		events: {
			'onReady': onPlayerReady,
			/*'onStateChange': onPlayerStateChange*/
		}
	});
}

function onPlayerReady(event) {
	//event.target.playVideo();
	event.target.mute();
}

function onPlayerStateChange(event) {
	if(event.data == YT.PlayerState.PLAYING){
	}else if(event.data == YT.PlayerState.PAUSED){
	}else if(event.data == YT.PlayerState.BUFFERING){
	}
}

function getPlayerTime(){
	clearInterval(playTimer);
	playTimer = setInterval(function(){
		var time = Math.round(player.getCurrentTime());
		$('#yt_time_input').val(time);
	}, 500);
}

function getPlayerTimePause(){
	clearInterval(playTimer);
	if(player.getPlayerState() == 1){
		player.pauseVideo();
	}
	var time = Math.round(player.getCurrentTime());
	$('#yt_time_input').val(time);
}
</script>
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
<link rel="stylesheet" href="js/flexslider.css">
<link rel="stylesheet" href="js/bootstrap-switch.css">
<link rel="stylesheet" href="js/bootstrap-tagsinput.css">
<style type="text/css">
/*****All*****/
html, body{
	font-family: sans-serif;
}

.section{
	
}

.section h2{
	color: #333;
	font-size: 23px;
	font-weight: bold;
}

.fb_bg{
	background-color: #3b5998;
	border-color: #3b5998;
	color: #FFF;
}

.btn-danger.btn {
	border-color: #ff5a5f;
	border-bottom-color: #e00007;
	background-color: #ff5a5f;
	color: #fff;
}

/*.btn-picsee.btn {
	border-color: #ecd357;
	border-bottom-color: #FFD700;
	background-color: #ecd357;
	color: #0A112C;
}*/
.btn-picsee.btn {
	border-color: #ecd357;
	background-color: #0A112C;
	color: #ecd357;
}

.btn-default.btn{
	/*background-color: transparent;
	color: #EFEFEF;*/
}

img.loading{
	width: 40px;
	display: none;
}

span.note{
	display: block;
	padding-top: 10px;
	font-size: small;
}

/*****Nav*****/
.navbar-brand img{
	width: 100px;
}
.nav-btn:hover, .nav-btn.active {
	background: #ecd357 !important;
	color: #0A112C !important;
	font-weight: bold;
}
.navbar-inverse {
	background-color: #111016;
	border-color: #111016;
}

#main{
	padding-top: 50px;
}

/******Head*****/

.head_box{
	height: 455px;
	text-align: center;
	background-size: cover;
	background-position: center bottom;
	/*background-image: url("images/bg_lady_cam.jpg");*/
	/*https://static.pexels.com/photos/6585/hands-woman-camera-girl.jpg*/
	background-attachment: fixed;
	color: #FFF;
	background-color: #ecd357;
}

/*span#ajax_ct{
	display: block;
	font-size: 20px;
	line-height: 25px;
}*/

.title_head{
	color: #0A112C;
	font-size: 23px;
	font-weight: lighter;
	-webkit-font-smoothing: antialiased;
	margin-top: 0px;
	padding-top: 140px;
	padding-bottom: 23px;
}

#input_area > input[type=text]{
	width: 500px;
	display: inline-block;
	padding-right: 0px;
	margin-right: 0px;
}

/******Function*****/

.function_box{
	background-color: #1d2129;
	padding: 20px;
	color: #FFF;
	-webkit-font-smoothing: antialiased;
	display: none;
}

#shorten_link_bar{
	text-align: center;
	font-size: 17px;
}

#short_link{
	width: 250px;
	display: inline-block;
	padding-right: 0px;
	margin-right: 0px;
	vertical-align: bottom;
}

#cshort_link_box, #cshort_link_btn{
	display: none;
}

#cshort_link_input{
	width: 150px;
	display: inline-block;
	padding-right: 0px;
	margin-right: 0px;
	vertical-align: bottom;
}

#show_more{
	color: #FFF;
	font-size: small;
}

.advance_box{
	font-size: 17px;
	background-color: #ecd357;
	color: #0A112C;
	padding: 10px;
	margin-bottom: 20px;
	-webkit-border-radius: 5px;
	-moz-border-radius: 5px;
	border-radius: 5px;
}

.advance_box > div > div{
	padding-top: 10px;
}

.advance_box span.title{
	width: 160px;
	display: inline-block;
    text-align: right;
}

.advance_box select{
	display: inline;
	width: 200px;
}

#group_function span > input[type=text]{
	width: 200px;
	display: inline-block;
}

#customize_link_box{
	padding-top: 20px;
	text-align: center;
}

.hint{
	display: none;
	font-size: small;
	padding-top: 10px;
}

.hint b{
	color: #ecd357;
}

#target_redirect{
	padding: 10px;
	margin: 10px;
}

#target_redirect span{
	width: 200px;
	display: inline-block;
	text-align: right;
}

#target_redirect span select{
	width: 100px;
	display: inline-block;
}

#target_redirect input[type=text]{
	width: 400px;
	display: inline-block;
}

#target_redirect .rules{
	margin-top: 5px;
}

#target_redirect input[type=button]{
	width: 75px;
}

#preview_box{
	width: 500px;
	margin: 0px auto;
	float: left;	/* debug 如果edit_box出來就要加這個*/
}

#edit_short_link{
	display: none;
	padding-top: 20px;
	font-size: 19px;
}

#cshort_link{
	width: 200px;
	display: inline-block;
}

#edit_box{
	padding: 60px;
	overflow: hidden;
	color: #EFEFEF;
	/*display: none;*/
}

#edit_box h2{
	color: #FFF;
	margin-left: -20px;
}

#edit_box .box{
	/*background-color: #EFEFEF;
	color: #333;*/
	margin-top: 10px;
	border-radius: 5px;
	display: none;
	border: 1px solid #EFEFEF;
	max-width: 600px;
}

#from_url_box{
	padding: 20px;
}

#from_url_box input[type=text]{
	width: 300px;
	display: inline-block;
}

#yt_time{
	padding: 20px;
}

#player{
	display: block;
	margin: 15px 0px;
}

#yt_time_input{
	width: 150px;
	display: inline-block;
}

.float_image{
	display: block;
	float: left;
	margin: 5px 5px 0px 0px;
    max-width: 150px;
	cursor: pointer;
	-webkit-box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, .1) inset, 0 1px 1px rgba(0, 0, 0, .05);
}

.float_image img{
	max-width: 100%;
}

/******Intro*****/

.intro_box{
	background-color: #EDEFED;
}

.slides > li > div{
	padding: 30px;
	padding-left: 10%;
	padding-right: 10%;
	font-size: large;
	line-height: 1.8em;
	-webkit-font-smoothing: antialiased;
	height: 680px;
	overflow: hidden;
}
.intro_box .box{
	display: block;
	width: 47%;
	font-size: 14px;
	line-height: 1.42857143;
}
.intro_box .box img{
	/*border: 1px #CCC solid;*/
	display: block;
	/*width: 80%;*/
	border-radius: 5px;
	max-width: 500px;
}
.box_left{
	float: left;
	padding-bottom: 20px;
}
.box_right{
	float: right;
	padding-bottom: 20px;
}
.before_after{
	font-size: 23px; 
	padding-top: 30px;
	padding-bottom: 15px;
	max-width: 500px;
}
.m_demo{
	display: none;
}
.box img{
	
}
.logo{
	width: 40px;
	margin: 5px;
	text-align: center;
	display: block;
	float: left;
	font-size: 10px;
}
.logo img{
	width: 100%;
	display: block;
}

/******Anal*****/
.anal_box{
	padding: 30px;
	padding-left: 10%;
	padding-right: 10%;
	color: #666;
}
.anal_box h3{
	font-size: 21px;
	color: #333;
}
.anal_box ul{
	padding: 0px;
}
.anal_box ul li {
    text-align: center;
    padding: 50px 20px 20px;
    border: 1px solid #E0E0E0;
    border-left: 0;
    border-top: 0;
    min-height: 260px;
}

.anal_box li {
	width: 33.33333%;
	list-style: none;
	display: block;
	height: auto;
	float: left;
	padding: 0 0.625rem 1.25rem;
}

.anal_box ul li:nth-child(3n+3) {
	border-right: 0;
}

.anal_box ul li:nth-last-child(-n+3) {
	border-bottom: 0;
}

/******Footer*****/

.footer_box{
	color: #FFF;
	background-color: #111016;
	padding: 50px 10% 15px 10%;
}

.footer_title{
	font-size: 19px;
	line-height: 30px;
	color: #E0E0E0;
	font-weight: 100;
	font-style: italic;
	padding-bottom: 20px;
	-webkit-font-smoothing: antialiased;
}

.footer_title img{
	width: 100px;
	margin-right: 20px;
}

.footer_section{
	float: left;
	font-size: 
}

.footer_section h3{
	font-size: 17px;
	padding-bottom: 5px;
}

.footer_section ul li, .footer_section a{
	list-style: none;
	color: #FFF;
	font-weight: 100;
	-webkit-font-smoothing: antialiased;
}

.footer_section a:hover{
	color: #666;
	text-decoration: none;
	-webkit-font-smoothing: antialiased;
}

.footer_section ul{
	padding: 0px;
}

.copy_right{
	text-align: center;
	color: #999;
}

/******Help*****/

#help_icon{
	position: fixed;
	right: 30px;
	bottom: 30px;
	background-color: #ecd357;
	border-radius: 25px;
	width: 50px;
	height: 50px;
	display: block;
	cursor: pointer;
	line-height: 50px;
	text-align: center;
	-moz-box-shadow:0px 0px 10px rgba(20%,20%,40%,0.5);
	-webkit-box-shadow:0px 0px 10px rgba(20%,20%,40%,0.5);
	box-shadow:0px 0px 10px rgba(20%,20%,40%,0.5);
}

#help_box{
	position: fixed;
	right: 15px;
	bottom: 0px;
	height: 300px;
	width: 340px;
	z-index: 5000;
	-moz-box-shadow:0px 0px 10px rgba(20%,20%,40%,0.5);
	-webkit-box-shadow:0px 0px 10px rgba(20%,20%,40%,0.5);
	box-shadow:0px 0px 10px rgba(20%,20%,40%,0.5);
	z-index: 3000;
	display: none;
}

/******DivHR*****/

.div_hr{
	padding: 25px;
	color: #666;
	line-height: 40px;
	-webkit-font-smoothing: antialiased;
	text-align: center;
	background: #E0E0E0;
}

/******Old*****/

#preview{
	padding-top: 50px;
}

#thumbnails{
	padding: 20px;
	padding-top: 10px;
	margin: 10px;
	background: #EFEFEF;
	-webkit-border-radius: 5px;
	-moz-border-radius: 5px;
	border-radius: 5px;
}

#thumbnails > h3, #preview > h3{
	margin-top: 5px;
}

form, #hide_upload{
	display: inline;
}

#upload{
	/*display: block;
	float: left;
	padding: 20px;
	margin: 10px;
	-webkit-box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, .1) inset, 0 1px 1px rgba(0, 0, 0, .05);
	width: 200px;
	height: 128px;
	background: #FFF;*/
}

#upload_progress{
	display: inline-block;
}

#upload_progress span{
	display: block;
	float: right;
	width: 145px;
	height: 48px;
	line-height: 48px;
	overflow: hidden;
	font-size: 13px;
}

#upload_progress div div{
	loat:left;
}

#drop input{
    display:none;
}


.float_image_large{
	display: block;
	float: left;
	margin: 10px;
	width: 500px;
	padding: 10px;
	color: #FFF;
	-webkit-font-smoothing: antialiased;
	background-color: rgba(53, 78, 145, 1);
	-webkit-border-radius: 5px;
	-moz-border-radius: 5px;
	border-radius: 5px;
}

#link_box{
	width: 470px;
	cursor: pointer;
	margin: 15px;
	background-color: #FFF;
}
#link_image{
	width: 470px;
	height: 246px;
	background-size: cover;
	background-position: center;
	background-color: #000000;
	background-repeat: no-repeat;
	cursor: move;
	position: relative;
}
#link_image_hint{
	height: 20px;
	width: 100%;
	color: #000000;
	background: rgba(255, 255, 255, 0.5);
	position: absolute;
	bottom: 0px; 
}
#link_desc{
	width: 470px;
	padding: 12px;
	margin-bottom: 5px;
	/*max-height: 110px;*/
	overflow: hidden;
	-webkit-box-shadow: 0 0 0 1.5px rgba(0, 0, 0, .1) inset, 0 1px 1px rgba(0, 0, 0, .05);
}

#link_desc span{
	display: block;
	text-align: left;
	width: 100%;
	font-size: 12px;
	margin-top: 10px;
	line-height: 12px;
	text-transform: uppercase;
	color: #9197a3;
}

#link_title{
	width: 440px;
	font-family: Georgia, 'lucida grande',tahoma,verdana,arial,sans-serif;
	font-size: 19px;
	font-weight: 500;
	line-height: 22px;
	word-wrap: break-word;
	color: #141823;
	border: 1px #CCC dashed;
	resize: none;
}

#link_description{
	width: 440px;
	height: 39px;
	font-family: helvetica, arial, sans-serif;
	font-size: 13px;
	line-height: 17px;
	word-wrap: break-word;
	color: #141823;
	border: 1px #CCC dashed;
	resize: none;
}

#link_video{
	/*display size is: 476 * 268*/
	width: 470px;
	height: 265px;
	background-repeat: no-repeat;
	background-size: cover;
	background-position: center;
	background-color: #000;
	overflow: hidden;
	cursor: pointer;
}

#link_video img{
    position: relative;
    top: 95px;
    width: 70px;
    left: -2px;
}

.video_text{
	background: url(https://static.xx.fbcdn.net/rsrc.php/v2/yW/r/TAw3VSvSUUG.png) repeat-x 0 100%;
    color: #fff;
    -webkit-font-smoothing: antialiased;
    line-height: normal;
    padding: 15px;
    position: absolute;
    text-align: left;
    text-shadow: 0 1px 4px rgba(0, 0, 0, .4);
    position: relative;
    top: 103px;
    height: 95px;
}

#video_title{
	max-height: 46px;
    overflow: hidden;
    font-weight: bold;
    font-size: 18px;
    bottom: 0;
    left: 0;
    line-height: 23px;
}

.video_desc{
	font-size: 11px;
    font-weight: 500;
    opacity: .8;
    padding-top: 4px;
    text-transform: uppercase;
}

#link_page{
	padding-top: 12px;
}

#link_area{
	padding-top: 10xp;
}

#link_page a, #link_page a:hover, a.btn, #link_area_simple a, #link_area_simple a:hover{
	/*padding: 12px 26px;
	color: #fff;
	font-size: 17px;
	border-radius: 10px;
	cursor: pointer;
	display: inline-block;
	margin-top: 5px;
	line-height: 27px;
	background: #0A112C;
	text-decoration: none;*/
}

#link_page a:hover, #link_area_simple a:hover{
    background: #ecd357;
    color: #0A112C;
}

#load_link{
	padding-top: 20px;
}

.short_link{
	font-size: x-large;
	color: #0A112C;
}

.free_trail_btn{
	display: inline-block;
    font-size: 9px;
    background-color: #e91d25;
    padding: 5px;
    border-radius: 4px;
    position: relative;
    top: -12px;
    -webkit-transform: scale(0.6);
}

div.growlUI { background: url("images/check.png") no-repeat 10px 10px; margin-top: 50px; }
div.growlUI h1, div.growlUI h2 {
	color: white; padding: 5px 5px 5px 75px; text-align: left;
}
/******訊息泡泡css******/
.notice_bubble{
	width: 30px;
    height: 22px;
    text-align: center;
    background: #ecd357;
    position: relative;
    border: solid 1px #333;
    margin-top: -2px;
    color: #333;
    border-radius: 10px;
    display: none;
    font-size: 9px;
}
/*箭頭下*/
.notice_bubble .arrow_b_int{
    width: 0px;
    height: 0px;
    border-width: 5px;
    border-style: solid;
    border-color: #ecd357 transparent transparent transparent;
    position: absolute;
    bottom: -9px;
    right: 13px;
}

/**** dropdown-menu ****/
.dropdown-menu{
	width: 250px;
}

.dropdown-menu>li>a {
	white-space: initial;
	overflow-wrap: break-word;
}

.bootstrap-tagsinput {
	width: 390px;
    display: inline-table;
    text-align: left;
    height: 46px;
    text-transform:lowercase;
}

#tag_select{
	width: 270px; 
	display: inline; 
	margin: 5px;
}

.tag_title{
	display: inline-block;
    width: 115px;
    text-align: right;
    font-size: 17px;
}

.tags{
	cursor: pointer;
	color: #333;
	margin-right: 3px;
	font-size: larger;
}

.label-info{
	cursor: pointer;
	background-color: #ddd;
    color: #777;
}

.event_div{
	display: none;
}

.event_div > a > div{
	width: 600px;
	height: 100px;
	cursor: pointer;
}

@media (max-width:770px) {
	.head_box{
		/*height: 300px;*/
		background-attachment: scroll;
	}

	.title_head{
		padding-top: 100px;
		/*padding-bottom: 80px;*/
		font-size: 34px;
	}

	#input_area > input[type=text]{
		width: 80%;
	}

	#shorten{
		margin-top: 20px;
	}

	#target_redirect_btn, #map_tag_btn{
		display: none;
	}

	.advance_box span.title {
		width: auto;
	}

	.advance_box select{
		width: 80%;
	}

	.function_box{
		padding: 0px;
	}

	#shorten_link_bar{
		padding: 10px;
	}

	#short_url_title{
		display: block;
	}

	#short_link{
		margin: 5px;
		width: 86%;
	}

	#preview_box, #edit_box{
		width: 100%;
		float: none;
	}

	#link_box, #link_desc{
		width: 354px;
	}

	#link_image, #link_video{
		width: 354px;
		height: 184px;
	}

	#link_video img {
		top: 64px;
	}

	#link_title, #link_description{
		width: 100%;
		font-size: 14px;
		line-height: 18px;
	}

	#edit_box{
		padding: 10px;
	}

	#edit_box h2 {
		margin-left: 0px;
	}

	.slides > li > div{
		padding: 10px;
		height: 100%;
	}

	.intro_box .box {
		width: 100%;
	}

	.box_left, .box_right {
		float: none;
	}

	.pc_demo, .center_fill{
		display: none !important;
	}

	.m_demo{
		display: block;
	}

	.anal_box li {
		width: 100%;
		float: none;
	}

	.anal_box ul li {
		border: none;
		padding: 20px;
		min-height: 0px;
	}

	.footer_title img{
		display: block;
	}

	.event_div > a > div{
		width: 300px;
	}
}
</style>
</head>
<body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-70603782-1', 'auto');
  ga('send', 'pageview');

</script><div id="nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
	<div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
				<span class="sr-only">PicSee</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="javascript: gotoShorten();">
				<img src="images/picsee_light_web.png" title="PicSee" />
			</a>
		</div>
		<div class="collapse navbar-collapse">
			<ul class="nav navbar-nav">
				<li><a class="nav-btn go" href="about.php" data-block="#sample">Famous Users</a></li>
				<li><a class="nav-btn go" href="https://pics.ee/register.php?lang=" data-block="#register">Pricing</a></li>
								<li><a class="nav-btn go" href="./tools.php" data-block="#extension">Tools</a></li>
				<li><a class="nav-btn go" href="https://www.facebook.com/picsee.co" data-block="#about" target="_blank">Follow Us</a></li>
			</ul>
			<ul class="nav navbar-nav navbar-right">
				<li class="dropdown">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false" onclick="" style="padding-left:0px; padding-right:0px;">
						<div class="notice_bubble">
							<span id="notice_span"></span>
							<span class="arrow_b_int"></span>
						</div>
					</a>
					<ul id="notice_dropdown" class="dropdown-menu">
						<li style="color: black;">&nbsp;&nbsp;&nbsp;Loading...</li>
					</ul>
				</li>
				<li><a class="nav-btn go" href="https://pics.ee/login.php?lang=" data-block="#">Login</a></li>
				<li class="dropdown">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">English (US)<span class="caret"></span></a>
					<ul class="dropdown-menu">
						<li><a href="javascript:location.href=location.pathname+'?lang=ar'+location.hash;">العربية</a></li>
						<li><a href="javascript:location.href=location.pathname+'?lang=en'+location.hash;">English (US)</a></li>
						<li><a href="javascript:location.href=location.pathname+'?lang=es'+location.hash;">Español</a></li>
						<li><a href="javascript:location.href=location.pathname+'?lang=fr'+location.hash;">Français (France)</a></li>
						<li><a href="javascript:location.href=location.pathname+'?lang=id'+location.hash;">Bahasa Indonesia</a></li>
						<li><a href="javascript:location.href=location.pathname+'?lang=it'+location.hash;">Italiano</a></li>
						<li><a href="javascript:location.href=location.pathname+'?lang=ja-jp'+location.hash;">日本語</a></li>
						<li><a href="javascript:location.href=location.pathname+'?lang=ko'+location.hash;">한국어</a></li>
						<li><a href="javascript:location.href=location.pathname+'?lang=pt'+location.hash;">Português</a></li>
						<li><a href="javascript:location.href=location.pathname+'?lang=th'+location.hash;">ภาษาไท</a></li>
						<li><a href="javascript:location.href=location.pathname+'?lang=vi'+location.hash;">Tiếng Việt</a></li>
						<li><a href="javascript:location.href=location.pathname+'?lang=zh-tw'+location.hash;">中文(正體)</a></li>
						<li><a href="javascript:location.href=location.pathname+'?lang=zh'+location.hash;">中文(简体)</a></li>
					</ul>
				</li>			</ul>
			<!--img src="images/getAuth.php?t=1521787317" style="margin: 0px; padding: 0px;"-->
		</div>
	</div>
</div>
<div id="main">
	<div class="section head_box">
		<h1 class="title_head" align="center">Boost, Optimize and Measure Your Links</h1>
		<div id="input_area">
									<input id="url" name="url" type="text" placeholder="YouTube or other Sharing Link" size="40" autofocus class="form-control input-lg" />
						<img class="loading" src="./images/loading.gif">
			<input id="shorten" type="button" class="btn btn-picsee btn-lg" value="PicSee!" onclick="getLinkSimple('true');" />
			<span style="display: block; color: #110f16; padding-top: 15px; -webkit-font-smoothing: antialiased;"></span>
			<div class="event_div" align="center" title="建立的連結會有專屬網址，並加上科索沃宣傳哦！">
				<a href="http://kosovo10th.country" target="_blank"><div></div></a>
			</div>
		</div>
	</div>
	<div class="section function_box">
		<div id="shorten_link_bar">
			<span id="short_url_title">Large Video Link: </span>
			<span id="basic_function">
				<input id="short_link" onclick="setCustomizeLink();" type="text" class="form-control input-lg" />
				<input type="button" class="btn btn-success btn-lg" value="Copy" onclick="copyInputText('#short_link')" />
				<a id="short_link_anal" onmouseover="$('#analysis_url_hint').show()" onmouseout="$('#analysis_url_hint').hide()" href="" target="_blank" class="btn btn-default btn-lg">Track</a>
			</span>
			<span id="more_function" style="display: none;">
				<span id="cshort_link_box">
					<span id="short_domain_box">
						<a style="font-size: 20px; color: #eeea38;">http://pics.ee/</a>
					</span>
					<input id="cshort_link_input" type="text" class="form-control input-lg" />
					<img class="loading" src="./images/loading.gif">
				</span>
				<input id="cshort_link_btn" type="button" class="btn btn-default btn-lg" value="Customize Link" onclick="setCustomizeLink();" />
				<input id="map_tag_btn" type="button" class="btn btn-default btn-lg" value="Add Tag" onclick="showHideHTML('#map_tag')" />
				<input id="target_redirect_btn" type="button" class="btn btn-default btn-lg" value="Platform Settings" onclick="showHideHTML('#target_redirect')" />
			</span>
			<a id="show_more" href="javascript: showMore()">More Options</a>
			<div id="analysis_url_hint" class="hint">Add a "+" after the URL to view link analytics</div>
			<div id="target_redirect">
				<h3>
					Add Targets					<input id="target_redirect_save" type="button" class="btn btn-lg btn-danger" value="Save" onclick="setTarget()" />
					<img class="loading" src="./images/loading.gif">
				</h3>
				<div class="rules">
					<span>
						<select class="form-control input-lg" id="target_redirect_option" onchange="addTargetX()" onclick="addTargetX()">
							<option id="option_ios_android" value="ios_android">Mobile (iOS &amp; Android)</option>
							<option id="option_ios" value="ios" selected="selected">iOS</option>
							<option id="option_android" value="android" >Android</option>
							<option id="option_pc_mac" value="pc_mac" >Desktop (PC &amp; Mac)</option>
							<option id="option_pc" value="pc">PC</option>
							<option id="option_mac" value="mac">Mac</option>
							<option id="option_picsee" value="picsee">PicSee Link</option>
							<option id="option_facebook" value="facebook">Facebook</option>
							<option id="option_twitter" value="twitter">Twitter</option>
						</select>
						redirect to: 					</span>
					<input id="target_redirect_option_url" type="text" placeholder="Another URL" class="form-control input-lg" />
					<input id="" type="button" class="btn btn-default" value="Add" onclick="addTarget();" />
				</div>
				<div id="target_redirect_rules">
				</div>
				<div class="rules">
					<span>Default redirect to</span>
					<input id="target_redirect_default" type="text" class="form-control input-lg" disabled="disabled" />
					<span style="width: 75px;"></span>
				</div>
			</div>
			<div id="map_tag">
				<div>
					<span class="tag_title">Category：</span>
					<select id="tag_select" class="form-control input-lg" onchange="$('#tags').tagsinput('add', $('#tag_select').val());">
					</select>
				</div>
				<div id="tags_div" style="display: none;">
					<input type="text" id="tags" placeholder="Add Tag" data-role="tagsinput" onchange="setTag()">
				</div>
			</div>
		</div>
		<div id="customize_link_box">
			<div id="preview_box">
				<h3>
					Preview					<img class="loading" src="./images/loading.gif" style="width: 20px; padding-bottom: 5px;">
					<input id="edit_btn" type="button" class="btn btn-primary" value="Edit" onclick="setEdit()" />
					<input id="cancel_btn" type="button" class="btn btn-default" value="Cancel" onclick="setEditCancel('true')" />
				</h3>
				<div id="play_icon_box" style="display: none;">
					<span style="font-size: 17px;">Play Button</span>
					<input id='play_icon' name='' type="checkbox" class="switch" data-on-text='On' data-off-text='Off' data-size="small" checked="checked"/>
					<span style="width: 160px; display: inline-block; font-size: xx-small; line-height: 12px;     vertical-align: middle; text-align: left;">Turn it Off when you plan to boost this post on Facebook (<a href="http://lnk.pics/4DH78" target="_blank">details</a>)</span>
				</div>
				<div id="link_box" onclick="setEdit('true')">
					<div id="link_image" style="display: none;" onmousedown="moveImage()">
						<div id="link_image_hint" align="center">
							Move the image by mouse						</div>
					</div>
					<div id="link_video" style="display: none;">
						<img id="play" src="images/play.png">
						<div class="video_text">
							<div id="video_title"></div>
							<div class="video_desc">PICS.EE</div>
						</div>
					</div>
					<div id="link_desc" align="center">
						<textarea rows="2" id="link_title" onkeyup="setVideoTitle()"></textarea><br>
						<textarea rows="2" id="link_description"></textarea>
						<span>pics.ee</span>
					</div>
				</div>
			</div>
			<div id="edit_box" align="left">
				<!--div id="post_type">
					<h2>Post Type</h2>
					<div class="btn-group">
						<button id="post_type_btn" type="button" class="btn btn-default">Embedded Video</button>
						<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
							<span class="caret"></span>
						</button>
						<ul class="dropdown-menu" role="menu">
							<li><a href="javascript: setPostType('video');" onclick="ga('send', 'event', 'Index', 'Set Post Type: video');">Embedded Video</a></li>
							<li><a href="javascript: setPostType('static');" onclick="ga('send', 'event', 'Index', 'Set Post Type: static');">Static Preview Image</a></li>
						</ul>
					</div>
					<span class="note" style="display: inline-block;">Play on Facebook's page. Don't worry, the <a class='span_link' href='http://pics.ee/youtube_views' target='_blank'>views</a> will still accumulate to YouTube.</span>
				</div-->
				<div id="image_filter">
					<h2>Image Filter<img class="loading" src="./images/loading.gif"></h2>
					<div id="pics_filter">
						<div class="float_image" style="width: 90px !important;">
							<img src="./images/filter_normal.jpg" onclick="setImageFilter();" />
							<span>Normal</span>
						</div>
						<div class="float_image" style="width: 90px !important;">
							<img src="./images/filter_clarity.png" onclick="setImageFilter('clarity');" />
							<span>Clarity</span>
						</div>
						<div class="float_image" style="width: 90px !important;">
							<img src="./images/filter_lomo.png" onclick="setImageFilter('lomo');" />
							<span>LOMO</span>
						</div>
						<div class="float_image" style="width: 90px !important;">
							<img src="./images/filter_vintage.png" onclick="setImageFilter('vintage');" />
							<span>Vintage</span>
						</div>
						<div class="float_image" style="width: 90px !important;">
							<img src="./images/filter_hazyDays.png" onclick="setImageFilter('hazyDays');" />
							<span>Hazy</span>
						</div>
						<div class="float_image" style="width: 90px !important;">
							<img src="./images/filter_pinhole.png" onclick="setImageFilter('pinhole');" />
							<span>Pinhole</span>
						</div>
						<div class="float_image" style="width: 90px !important;">
							<img src="./images/filter_sunrise.png" onclick="setImageFilter('sunrise');" />
							<span>Sunrise</span>
						</div>
						<div class="float_image" style="width: 90px !important;">
							<img src="./images/filter_crossProcess.png" onclick="setImageFilter('crossProcess');" />
							<span>Radial Blur</span>
						</div>
					</div>
					<div style="clear: both;" id="caman_div">
					</div>
				</div>
				<div id="edit_preview">
					<h2>Customize Preview Image</h2>
					<!--button id="yt_time" type="button" class="btn btn-default" onmouseover="$('#yt_time_box').show()" onclick="showHideHTML('#yt_time_box')" >Choose a frame from the video as the preview image</button-->
					<button type="button" onclick="$('#upload_img').click();" class="btn btn-default" onmouseover="$('#upload_box').show()" onmouseout="$('#upload_box').hide()">Upload From Computer</button>
					<input style="display: none;" type='file' id="upload_img" onchange="previewImage(this)" />
					<button id="btn_from_url" type="button" class="btn btn-default" onclick="setImgFromUrl()" >From URL</button>
					<div id="upload_box" style="display: none; height: 30px;">
						<span id="upload_best_size" class="note"></span>
						<!--div id="hide_upload">
							<form id="upload" method="post" action="getImage.php" enctype="multipart/form-data">
								<input name="user_url" type="hidden" value="">
								<input name="key" type="hidden" value="">
								<input type="file" name="upl" style="display: none;" />
								<span id="upload_progress"></span>
							</form>
						</div-->
					</div>
					<div id="from_url_box" class="box">
						Paste image URL here						<input id="from_url_input" type="text" class="form-control" placeholder="Paste image URL here" onpaste=""/>
						<button onclick="setImgUrl()" class="btn btn-primary">OK</button>
					</div>
					<div id="yt_time" class="box" style="display: block;">
						Choose a frame from the video as the preview image						<div id="player" onmouseover="getPlayerTime()" onmouseout="getPlayerTimePause()" ></div>
						<input id="yt_time_input" type="text" onclick="player.playVideo();" class="form-control" placeholder="" value="0" />
						<img id="yt_time_loading" class="loading" src="./images/loading.gif">
						<button onclick="getYTImage()" class="btn btn-primary">Set</button>
						<!--(This feature is undergoing maintenance)-->
					</div>
					<div id="pics"></div>
					<div style="clear: both;"></div>
				</div>
			</div>
			<div style="clear: both;"></div>
		</div>
	</div>
		<div class="section intro_box flexslider">
		<ul class="slides">
			<li>
				<div id="youtube">
					<div class="box box_left">
						<h2>Enlarge YouTube video on Facebook</h2>
						Make YouTube videos on Facebook as large as native Facebook videos, and customize cover image thumbnails!						<div class="before_after" align="center">Before</div>
						<div class="pc_demo">
							<script>(function(d, s, id) {  var js, fjs = d.getElementsByTagName(s)[0];  if (d.getElementById(id)) return;  js = d.createElement(s); js.id = id;  js.src = "//connect.facebook.net/zh_TW/sdk.js#xfbml=1&version=v2.3";  fjs.parentNode.insertBefore(js, fjs);}(document, 'script', 'facebook-jssdk'));</script><div class="fb-post" data-href="https://www.facebook.com/ensaladadefrutaoficial/posts/1194115227279246" data-width="500"><div class="fb-xfbml-parse-ignore"><blockquote cite="https://www.facebook.com/ensaladadefrutaoficial/posts/1194115227279246"><p></p> <img style="width: 40px; display: inline-block" src="./images/loading.gif">Loading Post... <a href="https://www.facebook.com/ensaladadefrutaoficial/">Ensalada de Fruta Oficial</a><a href="https://www.facebook.com/ensaladadefrutaoficial/posts/1194115227279246">2016/3/21</a></blockquote></div></div>
						</div>
						<div class="m_demo">
							<img src="images/before_picsee.png">
						</div>
					</div>
					<div class="box box_right">
						<div class="before_after" align="center">After</div>
						<div class="pc_demo">
							<script>(function(d, s, id) {  var js, fjs = d.getElementsByTagName(s)[0];  if (d.getElementById(id)) return;  js = d.createElement(s); js.id = id;  js.src = "//connect.facebook.net/zh_TW/sdk.js#xfbml=1&version=v2.3";  fjs.parentNode.insertBefore(js, fjs);}(document, 'script', 'facebook-jssdk'));</script><div class="fb-post" data-href="https://www.facebook.com/ensaladadefrutaoficial/posts/1205095319514570" data-width="500"><div class="fb-xfbml-parse-ignore"><blockquote cite="https://www.facebook.com/ensaladadefrutaoficial/posts/1205095319514570"><p></p> <img style="width: 40px; display: inline-block" src="./images/loading.gif">Loading Post... <a href="https://www.facebook.com/ensaladadefrutaoficial/">Ensalada de Fruta Oficial</a> <a href="https://www.facebook.com/ensaladadefrutaoficial/posts/1205095319514570">2016/3/31</a></blockquote></div></div>
						</div>
						<div class="m_demo">
							<img src="images/after_picsee.png">
						</div>
					</div>
					<div style="clear: both"></div>
				</div>
			</li>
			<li>
				<div id="demo">
					<div class="box box_left">
						<h2>Create an Eye-catching Link</h2>
						Choose your own thumbnail image when sharing links on social networks.						<div class="before_after" align="center">Before</div>
						<div>
							<img class="lazy" data-src="images/before_picsee_static.png">
						</div>
					</div>
					<div class="box box_right">
						<div class="before_after" align="center">After</div>
						<div>
							<img class="lazy" data-src="images/after_picsee_static.png">
						</div>
					</div>
					<div style="clear: both"></div>
				</div>
			</li>
			<li>
				<div id="social">
					<div class="box box_left">
						<div class="center_fill" style="height: 140px;"></div>
						<h2>Supports All Social Medias</h2>
						Works perfectly on Facebook, Twitter, Pinterest, Google+, LinkedIn, Medium, Skype and other social network sites						<div style="clear: both; padding: 5px;"></div>
						<div class="logo">
							<a href="http://facebook.com" target="_blank">
								<img class="lazy" data-src="images/social_facebook.png" title="Facebook" alt="Facebook">
							</a>
						</div>
						<div class="logo">
							<a href="http://twitter.com" target="_blank">
								<img class="lazy" data-src="images/social_twitter.png" title="Twitter" alt="Twitter">
							</a>
						</div>
						<div class="logo">
							<a href="http://pinterest.com" target="_blank">
								<img class="lazy" data-src="images/social_pinterest.png" title="Pinterest" alt="Pinterest">
							</a>
						</div>
						<div class="logo">
							<a href="http://plus.google.com" target="_blank">
								<img class="lazy" data-src="images/social_googleplus.png" title="Google+" alt="Google+">
							</a>
						</div>
						<div class="logo">
							<a href="http://linkedin.com" target="_blank">
								<img class="lazy" data-src="images/social_linkedin.png" title="LinkedIn" alt="LinkedIn">
							</a>
						</div>
						<div class="logo">
							<a href="http://medium.com" target="_blank">
								<img class="lazy" data-src="images/social_medium.png" title="Medium" alt="Medium">
							</a>
						</div>
						<div class="logo">
							<a href="http://skype.com/" target="_blank">
								<img class="lazy" data-src="images/social_skype.png" title="Skype" alt="Skype">
							</a>
						</div>
						<div class="logo">
							<a href="http://line.me/" target="_blank">
								<img class="lazy" data-src="images/social_line.png" title="LINE" alt="LINE">
							</a>
						</div>
						<div style="clear: both"></div>
					</div>
					<div class="box box_right">
						<div class="center_fill" style="height: 140px;"></div>
						<img class="lazy" data-src="images/twitter_demo.png" title='' alt=''>
					</div>
					<div style="clear: both"></div>
				</div>
			</li>
			<li>
				<div id="youtubefb">
					<div class="box box_left">
						<div class="center_fill" style="height: 140px;"></div>
						<h2>The Easiest Way to Enlarge YouTube Thumbnails</h2>
						Add "fb" after the YouTube URL like <a>youtubeFB.com</a> or <a>youtuFB.be</a> and paste it!					</div>
					<div class="box box_right">
						<div class="center_fill" style="height: 70px;"></div>
						<div>
							<img class="lazy" data-src="//media.giphy.com/media/l4HoiEDeKRvc24zzW/giphy.gif">
						</div>
					</div>
					<div style="clear: both"></div>
				</div>
			</li>
		</ul>
	</div>
	<div class="section div_hr">
		<a class="btn btn-success btn-lg" href="https://pics.ee/register.php?lang=">Create Your Free Account</a><br>
		or try the <a href="https://pics.ee/picsee_ext_test" target="_blank">PicSee Chrome Extension</a>	</div>
	<div class="section anal_box">
		<h2>Performance Analytics</h2>
		<ul>
			<li>
				<div>
					<img class="lazy" data-src="images/ana_title.png" />
					<h3>Check performance analytics</h3>
					Add a  "+" after the URL to view link analytics				</div>
			</li>
			<li>
				<div>
					<img class="lazy" data-src="images/ana_src.png" />
					<h3>Track your viewers</h3>
					We group views by source, e.g. Facebook App, FB Messenger... etc.				</div>
			</li>
			<li>
				<div>
					<img class="lazy" data-src="images/ana_pcm.png" />
					<h3>Mobile vs. Desktop</h3>
					Know your viewers' device				</div>
			</li>
			<li>
				<div>
					<img class="lazy" data-src="images/ana_map.png" />
					<h3>Click Maps</h3>
					Click Maps shows the locations of your viewers				</div>
			</li>
			<li>
				<div>
					<img class="lazy" data-src="images/ana_hclk.png" />
					<h3>Hourly click statistics</h3>
					Select a date under "Daily Click Count" to see more detailed statistics				</div>
			</li>
			<li>
				<div>
					<img class="lazy" data-src="images/ana_dlk.png" />
					<h3>Facebook Likes</h3>
					We also provide statistics for the Likes your posts get on Facebook				</div>
			</li>
		</ul>
		<div style="clear: both"></div>
	</div>
	<div class="section div_hr">
		<a class="btn btn-success btn-lg" href="https://pics.ee/register.php?lang=">Create Your Free Account</a><br>
		or try the <a href="https://pics.ee/picsee_ext_test" target="_blank">PicSee Chrome Extension</a>	</div>
	<div class="section footer_box">
		<div class="footer_title">
			<img src="images/picsee_light_web.png" />
			<span id="ajax_ct">10,000,000,000</span> clicks by the World		</div>
		<div class="footer_section">
			<h3>Products</h3>
			<ul>
				<li><a href="https://pics.ee/register.php?lang=">Pricing</a></li>
				<li><a href="about.php">Famous Users</a></li>
				<li><a href="tools.php">Tools</a></li>
				<li><a href="policy.php">Terms and Privacy Policy</a></li>
			</ul>
		</div>
		<div style="float: left; margin: 30px; height: 100px; width: 1px; background: #666;"></div>
		<div class="footer_section">
			<h3>Company</h3>
			<ul>
				<li><a href="javascript: showHideHTML('#help_box');">Contact Us</a></li>
				<li><a href="https://www.facebook.com/picsee.co" data-block="#about" target="_blank">Follow Us</a></li>
				<li>Patents</li>
			</ul>
		</div>
		<div style="clear: both"></div>
		<div class="copy_right">&copy; COPYRIGHT 2015-2018 PICSEE INC. ALL RIGHTS RESERVED<br>This website has nothing to do with Facebook or YouTube. Facebook trademark are property of Facebook Inc (Palo Alto, CA 94301, USA); YouTube trademark are property of Google Inc (1600 Amphitheatre Parkway Mountain View, CA 94043. USA).</div>
	</div>
</div>
<div id="help_icon" onmouseover="showHideHTML('#help_box');">Help</div>
<div id="help_box" onmouseout="showHideHTML('#help_box');">
	<div class="fb-page" data-href="https://www.facebook.com/picsee.co" data-tabs="messages" data-height="300" data-small-header="true" data-adapt-container-width="true" data-hide-cover="true" data-show-facepile="false"><blockquote cite="https://www.facebook.com/picsee.co" class="fb-xfbml-parse-ignore"><a href="https://www.facebook.com/picsee.co">PicSee 皮克看見</a></blockquote></div>
</div>
<div id="hide_page" style="display:none;"><iframe src=""></iframe></div>
<div id="hide_page_fb" style="display:none;"><iframe src=""></iframe></div>
<div id="invite_member" align="center" style="display: none; text-align: left; color: #333;">
	<form target="_blank" action="https://pics.ee/invite_count">
		<h3 style="color: #0A112C;">Get PicSee membership for free</h3>
		You have created more than <span id='invite_count'>10</span> links with PicSee.You can view history <a href='https://pics.ee/member_preview' target='_blank'>here</a> to see which link is the most popular, or registermembership to view and edit history any time.		<div align="center" style="padding-top: 30px">
			<input type="submit" class="btn btn-success" value="More Info About Membership">
			<input type="button" class="btn btn-default" onclick="$.unblockUI()" value="Remind Me Next Time">
			<span style="font-size: small; color: #666; padding-top: 20px; display: block;">If you are already a member, you can click here <a href='https://pics.ee/invite_count3' target='_blank'>login</a> to import the link from this computer.</span>
		</div>
	</form>
</div>
<div id="invite_pro" align="center" style="text-align: left; color: #333; display:none;">
  <form target="_blank" action="" style="padding: 30px; text-align: left;">
    <h3 id="invite_pro_title" style="color: #0A112C; margin: 0 0 15px 15px;">
    
    </h3>
    <div id="invite_pro_desc" style="font-size: medium; margin-left: 15px;">
      <p>Thank you for using PicSee from Taiwan, we have recently launched the Profit-sharing plan.</p>
     <p>The Profit-sharing plan is accessed by invitation. Many well-known Youtubers have participated in the plan. If you have any question, please let us know. Looking forward to see your works!😃</p>    </div>
    <div align="center" style="padding-top: 30px">
      <a id="invite_intent" class="btn btn-success" onclick="inviteEvent('click');ga('send', 'event', 'Invite', 'click');" href="https://pro.pics.ee/" target="_blank" >Learn more</a>
      <input type="button" class="btn btn-default" onclick="inviteEvent('next');ga('send', 'event', 'Invite', 'next');" value="Next time">
      <input type="button" class="btn btn-danger" onclick="inviteEvent('block');ga('send', 'event', 'Invite', 'block');" value="Never show">
    </div>
  </form>
</div>
<div id="videoJS"></div>
<div id="fb-root"></div>
</body>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/zh_TW/sdk.js#xfbml=1&version=v2.6&appId=150378901782986";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script>
<script type="text/javascript">
//訊息泡泡
getNotice();
setInterval(function(){
	getNotice();
},300000);

var last_count = 0;
var updateCount = function(){
	if(!isUpI) return;
	$.ajax({
		url: "getCount.php",
		type: "GET",
		dataType: 'html',
		cache: false,

		success: function(textPage){
			if(last_count == 0){
				$('#ajax_ct').countTo({
					from: parseInt(textPage),
					to: parseInt(textPage)+20,
					speed: 10000,
					formatter: function (value, options) {
						return value.toFixed(options.decimals).replace(/\B(?=(?:\d{3})+(?!\d))/g, ',');
					}
				});
				last_count = parseInt(textPage)+20;
			}else{
				$('#ajax_ct').countTo({
					from: parseInt(last_count),
					to: parseInt(textPage),
					speed: 10000,
					formatter: function (value, options) {
						return value.toFixed(options.decimals).replace(/\B(?=(?:\d{3})+(?!\d))/g, ',');
					}
				});
				last_count = textPage;
			}
		},

		error:function(xhr, ajaxOptions, thrownError){
		}
	});
}
updateCount();
var upI = setInterval(updateCount, 10000);
window.onfocus = function() {
	//瀏覽器切換回來
	/*updateCount();
	clearInterval(upI);
	upI = setInterval(updateCount, 10000);*/
	isUpI = true;
};
window.onblur = function() {
	//瀏覽器離開視窗
	//clearInterval(upI);
	isUpI = false;
};


var base_url = (location.hostname == "picsee.co")?"https://pics.ee/":((location.pathname.indexOf('/picsee/') == 0)?("http://"+location.hostname+"/picsee/"):"http://"+location.hostname+"/");
$('#hide_page iframe').attr("src", base_url+"about_helper.php");
//for evan debug
//var base_url = 'http://localhost:8888/picsee/';

$('.flexslider').flexslider({
	animation: "slide",
	after: function(slider){
        $(window).scrollTop(window.scrollY+1);
        $(window).scrollTop(window.scrollY-1);
     }
	/*smoothHeight: true,*/
});

$("#ad_share").bootstrapSwitch()
.on('switchChange.bootstrapSwitch', function(event, state) {
	if(state) setAd(1);
	else setAd(0);
});

$("#play_icon").bootstrapSwitch()
.on('switchChange.bootstrapSwitch', function(event, state) {
	if(state) setPlayIcon(1);
	else setPlayIcon(0);
});

/*$("#fb_pixel").bootstrapSwitch({
	disabled: true
}).on('switchChange.bootstrapSwitch', function(event, state) {
	if(state) setPixel(1);
	else setPixel(0);
});*/

if($.cookie("group_id") === null || $.cookie("group_id") == "") getUTM();
else setGroup();

//把browser id加進來
if(getBrowserId() != '0') $.cookie("browser_id", getBrowserId(), { expires: 1000000, path: '/'});

$("#url").keyup(function (e) {
	if (e.keyCode == 13) {
		getLinkSimple(true);
	}
});
$('#url').bind('paste', function(){
	setTimeout("getLinkSimple()", 100);
});
$('#from_url_input').bind('paste', function(){
	setTimeout("setImgUrl()", 100);
});
$('#link_image_hint').on('mousedown', function(e) {
    e.stopPropagation();
    return false;
});

</script>
</html>