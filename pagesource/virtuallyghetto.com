<!DOCTYPE html>
<!--[if IE 8]>
<html class="ie8" lang="en-US">
<![endif]-->
<!--[if gt IE 8]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
<meta property="twitter:account_id" content="16227829" />
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width" />
<title>virtuallyGhetto</title>
<link rel="profile" href="https://gmpg.org/xfn/11" />
<link rel="pingback" href="https://www.virtuallyghetto.com/xmlrpc.php" />
<link href="https://fonts.googleapis.com/css?family=Roboto+Slab:300,400,700,100" rel='stylesheet' type='text/css'>
<script>(function(d, s, id){
				 var js, fjs = d.getElementsByTagName(s)[0];
				 if (d.getElementById(id)) {return;}
				 js = d.createElement(s); js.id = id;
				 js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.6";
				 fjs.parentNode.insertBefore(js, fjs);
			   }(document, 'script', 'facebook-jssdk'));</script><link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//ws.sharethis.com' />
<link rel='dns-prefetch' href='//maxcdn.bootstrapcdn.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="virtuallyGhetto &raquo; Feed" href="https://www.virtuallyghetto.com/feed" />
<link rel="alternate" type="application/rss+xml" title="virtuallyGhetto &raquo; Comments Feed" href="https://www.virtuallyghetto.com/comments/feed" />
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.virtuallyghetto.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.4"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56692,8205,9792,65039],[55357,56692,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='crayon-css' href='https://www.virtuallyghetto.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-tomorrow-night-css' href='https://www.virtuallyghetto.com/wp-content/plugins/crayon-syntax-highlighter/themes/tomorrow-night/tomorrow-night.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css' href='https://www.virtuallyghetto.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='easy_author_image-css' href='https://www.virtuallyghetto.com/wp-content/plugins/easy-author-image/css/easy-author-image.css?ver=4.9.4' type='text/css' media='all' />
<link rel='stylesheet' id='simple-share-buttons-adder-font-awesome-css' href='//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css?ver=4.9.4' type='text/css' media='all' />
<link rel='stylesheet' id='m1-style-css' href='https://www.virtuallyghetto.com/wp-content/themes/m1/style.css?ver=4.9.4' type='text/css' media='all' />
<link rel='stylesheet' id='simple-social-icons-font-css' href='https://www.virtuallyghetto.com/wp-content/plugins/simple-social-icons/css/style.css?ver=2.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='slb_core-css' href='https://www.virtuallyghetto.com/wp-content/plugins/simple-lightbox/client/css/app.css?ver=2.6.0' type='text/css' media='all' />
<link rel='stylesheet' id='easy_table_style-css' href='https://www.virtuallyghetto.com/wp-content/plugins/easy-table/themes/cuscosky/style.css?ver=1.6' type='text/css' media='all' />
<style id='rocket-lazyload-inline-css' type='text/css'>
.rll-youtube-player{position:relative;padding-bottom:56.23%;height:0;overflow:hidden;max-width:100%;background:#000;margin:5px}.rll-youtube-player iframe{position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;background:0 0}.rll-youtube-player img{bottom:0;display:block;left:0;margin:auto;max-width:100%;width:100%;position:absolute;right:0;top:0;border:none;height:auto;cursor:pointer;-webkit-transition:.4s all;-moz-transition:.4s all;transition:.4s all}.rll-youtube-player img:hover{-webkit-filter:brightness(75%)}.rll-youtube-player .play{height:72px;width:72px;left:50%;top:50%;margin-left:-36px;margin-top:-36px;position:absolute;background:url(https://www.virtuallyghetto.com/wp-content/plugins/rocket-lazy-load/assets/img/play.png) no-repeat;cursor:pointer}
</style>
<link rel='stylesheet' id='jetpack_css-css' href='https://www.virtuallyghetto.com/wp-content/plugins/jetpack/css/jetpack.css?ver=5.9' type='text/css' media='all' />
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/www.virtuallyghetto.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script id='st_insights_js' type='text/javascript' src='https://ws.sharethis.com/button/st_insights.js?publisher=4d48b7c5-0ae3-43d4-bfbe-3ff8c17a8ae6&#038;product=simpleshare'></script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/themes/m1/js/modernizr.js?ver=4.9.4'></script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/themes/m1/js/off-canvas-nav-simple.js?ver=4.9.4'></script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/themes/m1/js/superfish.js?ver=4.9.4'></script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/plugins/simple-social-icons/svgxuse.js?ver=1.1.21'></script>
<script type="text/javascript">
	!function(){var analytics=window.analytics=window.analytics||[];if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.0.0";
		window.analytics.load("87b6nylkx2");
	window.analytics.page();
	  }}();
</script>
<link rel='https://api.w.org/' href='https://www.virtuallyghetto.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.virtuallyghetto.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.virtuallyghetto.com/wp-includes/wlwmanifest.xml" />
<meta name="generator" content="WordPress 4.9.4" />
<link rel='shortlink' href='https://wp.me/4ymB2' />

<script type="text/javascript">
        (function(){
          var bsa = document.createElement('script');
              bsa.type= 'text/javascript';
              bsa.async = true;
              bsa.src='//s3.buysellads.com/ac/bsa.js';
          (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
        })();
        </script>

<script type="text/javascript">
	window._wp_rp_static_base_url = 'https://wprp.zemanta.com/static/';
	window._wp_rp_wp_ajax_url = "https://www.virtuallyghetto.com/wp-admin/admin-ajax.php";
	window._wp_rp_plugin_version = '3.6.4';
	window._wp_rp_post_id = '160288';
	window._wp_rp_num_rel_posts = '6';
	window._wp_rp_thumbnails = false;
	window._wp_rp_post_title = 'Getting+started+with+VMware+Pivotal+Container+Service+%28PKS%29+Part+1%3A+Overview';
	window._wp_rp_post_tags = ['pks', 'cloud+native+apps', 'kubernetes', 'pivotal', 'bosh', 'pcf', 'vsan', 'cloud+native', 'nsx', 'vsphere', 'automation', 'esxi', 'lab', 'blog', 'pk', 'a', 'servic', 'video', 'project', 'light', 'googl', 'case', 'cloud', 'vmware', 'manag', 'glynn', 'app'];
	window._wp_rp_promoted_content = true;
</script>
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel='dns-prefetch' href='//jetpack.wordpress.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//public-api.wordpress.com' />
<link rel='dns-prefetch' href='//0.gravatar.com' />
<link rel='dns-prefetch' href='//1.gravatar.com' />
<link rel='dns-prefetch' href='//2.gravatar.com' />
<link rel='dns-prefetch' href='//i0.wp.com' />
<link rel='dns-prefetch' href='//i1.wp.com' />
<link rel='dns-prefetch' href='//i2.wp.com' />
<script type="text/javascript">
    jQuery(document).ready(function($) {
                $('nav ul.menu').superfish({
                        hoverClass:  'sfHover',
                        disableHI:   true,
                        delay:       0,                               // no delay on mouseout
                        animation:   {opacity:'show',height:'show'},  // fade-in and slide-down animation
                        speed:       'fast',                          // faster animation speed
                        cssArrows:   true                             // arrows
                });
        });
  </script>
<style type="text/css" media="screen"> .simple-social-icons ul li a, .simple-social-icons ul li a:hover, .simple-social-icons ul li a:focus { background-color: #999999 !important; border-radius: 4px; color: #ffffff !important; border: 0px #ffffff solid !important; font-size: 18px; padding: 9px; }  .simple-social-icons ul li a:hover, .simple-social-icons ul li a:focus { background-color: #a02724 !important; border-color: #ffffff !important; color: #ffffff !important; }  .simple-social-icons ul li a:focus { outline: 1px dotted #a02724 !important; }</style>

<meta property="og:type" content="website" />
<meta property="og:title" content="virtuallyGhetto" />
<meta property="og:url" content="https://www.virtuallyghetto.com/" />
<meta property="og:site_name" content="virtuallyGhetto" />
<meta property="og:image" content="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2016/10/vghetto.png?fit=240%2C240&amp;ssl=1" />
<meta property="og:image:width" content="240" />
<meta property="og:image:height" content="240" />
<meta property="og:locale" content="en_US" />
<link rel="icon" href="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2016/10/vghetto.png?fit=32%2C32&#038;ssl=1" sizes="32x32" />
<link rel="icon" href="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2016/10/vghetto.png?fit=192%2C192&#038;ssl=1" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2016/10/vghetto.png?fit=180%2C180&#038;ssl=1" />
<meta name="msapplication-TileImage" content="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2016/10/vghetto.png?fit=240%2C240&#038;ssl=1" />
<link rel="stylesheet" type="text/css" id="wp-custom-css" href="https://www.virtuallyghetto.com/?custom-css=fa6ab2ea38" />
<style>
                .top-menu-container, .top-menu ul ul, .navigation-main ul ul, .navigation-main li.sfHover:hover { background-color:  #ffffff; }                        .top-menu a, .top-menu ul ul a, .navigation-main a, .navigation-main ul ul a, .navigation-main li.sfHover a, .m1-social-icons a { color: #0a0a0a; }                        </style>
</head>
<body class="home blog">
<div id="page" class="hfeed site">
<header id="masthead" class="site-header" role="banner">
<section class="top-menu-container">
<div class="top-menu-inside">
<div class="m1-social-icons">
</div>
</div>
</section>
<section class="site-branding">
<a class="nav-btn" id="nav-open-btn">Menu</a>
<div class="site-title-wrap">
<hgroup>
<h1 class="site-title"><a href="https://www.virtuallyghetto.com/" title="virtuallyGhetto" rel="home">virtuallyGhetto</a></h1>
<p class="site-description"></p>
</hgroup>
</div>
<div id="header-widget-area">
</div>
<nav id="site-navigation" class="navigation-main" role="navigation">
<a class="close-btn" id="nav-close-btn">Close Menu</a>
<div class="screen-reader-text skip-link"><a href="#content" title="Skip to content">Skip to content</a></div>
<div class="menu-main-container"><ul id="menu-main" class="menu"><li id="menu-item-510" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-510"><a href="https://www.virtuallyghetto.com/about">About</a></li>
<li id="menu-item-760" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-760"><a href="#">Automation</a>
<ul class="sub-menu">
<li id="menu-item-591" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-591"><a href="https://www.virtuallyghetto.com/vmware-kickstart">VMware Kickstart</a></li>
<li id="menu-item-593" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-593"><a href="https://www.virtuallyghetto.com/kickstart">VMware API/SDK/CLI</a></li>
<li id="menu-item-592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-592"><a href="https://www.virtuallyghetto.com/vmware-vmavima">VMware vMA/VIMA</a></li>
<li id="menu-item-13682" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-13682"><a href="https://www.virtuallyghetto.com/ovf">VMware OVF / OVFTOOL</a></li>
</ul>
</li>
<li id="menu-item-448" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-448"><a href="https://www.virtuallyghetto.com/apple">Apple Mac Mini/Pro</a></li>
<li id="menu-item-450" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-450"><a href="https://www.virtuallyghetto.com/nested-virtualization">Nested Virtualization</a></li>
<li id="menu-item-449" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-449"><a href="https://www.virtuallyghetto.com/vcsa">VCSA</a></li>
<li id="menu-item-10631" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10631"><a href="https://www.virtuallyghetto.com/vsan">VSAN</a></li>
</ul></div> </nav>
</section>
</header>
<div id="main" class="site-main">
<div id="primary" class="content-area">
<div id="content" class="site-content" role="main">
<article id="post-160288" class="post-160288 post type-post status-publish format-standard hentry category-automation category-cloud-native category-esxi-2 category-nsx category-vsan category-vsphere tag-bosh tag-cloud-native-apps tag-kubernetes tag-pcf tag-pivotal tag-pks">
<header class="entry-header">
<h1 class="entry-title"><a href="https://www.virtuallyghetto.com/2018/03/getting-started-with-vmware-pivotal-container-service-pks-part-1-overview.html" rel="bookmark">Getting started with VMware Pivotal Container Service (PKS) Part 1: Overview</a></h1>
<div class="entry-meta">
Posted on <a href="https://www.virtuallyghetto.com/2018/03/getting-started-with-vmware-pivotal-container-service-pks-part-1-overview.html" title="9:30 am" rel="bookmark"><time class="entry-date" datetime="2018-03-23T09:30:36+00:00">03/23/2018</time></a><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://www.virtuallyghetto.com/author/lamw" title="View all posts by William Lam" rel="author">William Lam</a></span></span> </div>
</header>
<div class="entry-content">
<p>This past week and half, I have been spending quite a bit of time familiarizing myself with the recently released <a href="https://blogs.vmware.com/cloudnative/2018/02/12/pivotal-container-service-ga/" target="_blank" rel="noopener">VMware Pivotal Container Service solution</a>, also referred to as VMware PKS for short (yes, that is a K not a C which is a nod to Google's container scheduler Kubernetes). VMware PKS is part of a project that I am currently working on and I figure I would share the process and steps I took to deploy VMware PKS in my own personal lab, in case other folks are interested in trying out this neat and powerful solution for deploying Cloud Native Apps using Kubernetes which was <a href="https://blogs.vmware.com/cloudnative/2017/08/29/vmware-pivotal-container-service/" target="_blank" rel="noopener">co-developed between VMware, Pivotal and Google</a>.</p>
<p>If you would like to learn more about this first release of VMware PKS and the benefits it provides to both developers (consumers) and operators (admins/SRE) for Kubernetes infrastructure, check out this blog post <a href="https://blogs.vmware.com/cloudnative/2018/02/12/pivotal-container-service-ga/" target="_blank" rel="noopener">here</a>. Merlin Glynn, one of the Product Managers for PKS also did an awesome light board video overview of VMware PKS if you want the sparks notes version. If you simply want to give PKS a try without deploying anything, the CNA folks have also published a PKS HOL which can you find <a href="https://labs.hol.vmware.com/HOL/catalogs/catalog/874?src=so_5a314d05ddb83&amp;cid=70134000001SkJd" target="_blank" rel="noopener">here</a>.</p>
<p><div class="rll-youtube-player" data-id="2g1KE5zdbRs"></div><noscript><iframe width="560" height="315" src="https://www.youtube.com/embed/2g1KE5zdbRs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen="allowfullscreen"></iframe></noscript><br />
This will be the first, in a series of articles outlining my VMware PKS deployment and configuration which hopefully can help benefit others as it took me several attempts while learning about the solution. Although the first few articles will include manual guidance, rest assure, there will be some cool automation towards the end but I figure that folks may want to go through this once by hand to get a good understanding on all the different components and how they interact with each other. Plus, some of the PKS-specific automation is still being worked on by the product team and hopefully I will be able to share some of that real soon.</p>
<ul>
<li><a href="https://www.virtuallyghetto.com/2018/03/getting-started-with-vmware-pivotal-container-service-pks-part-1-overview.html" target="_blank" rel="noopener">Getting started with VMware Pivotal Container Service (PKS) Part 1: Overview</a></li>
</ul>
<p> <a href="https://www.virtuallyghetto.com/2018/03/getting-started-with-vmware-pivotal-container-service-pks-part-1-overview.html#more-160288" class="more-link">Continue reading <span class="meta-nav">&rarr;</span></a></p>
</div>
<footer class="entry-meta">
<span class="cat-links">
Category: <a href="https://www.virtuallyghetto.com/category/automation" rel="category tag">Automation</a>, <a href="https://www.virtuallyghetto.com/category/cloud-native" rel="category tag">Cloud Native</a>, <a href="https://www.virtuallyghetto.com/category/esxi-2" rel="category tag">ESXi</a>, <a href="https://www.virtuallyghetto.com/category/nsx" rel="category tag">NSX</a>, <a href="https://www.virtuallyghetto.com/category/vsan" rel="category tag">VSAN</a>, <a href="https://www.virtuallyghetto.com/category/vsphere" rel="category tag">vSphere</a> </span>
<span class="sep"> | </span>
<span class="tags-links">
Tags: <a href="https://www.virtuallyghetto.com/tag/bosh" rel="tag">BOSH</a>, <a href="https://www.virtuallyghetto.com/tag/cloud-native-apps" rel="tag">cloud native apps</a>, <a href="https://www.virtuallyghetto.com/tag/kubernetes" rel="tag">Kubernetes</a>, <a href="https://www.virtuallyghetto.com/tag/pcf" rel="tag">PCF</a>, <a href="https://www.virtuallyghetto.com/tag/pivotal" rel="tag">Pivotal</a>, <a href="https://www.virtuallyghetto.com/tag/pks" rel="tag">PKS</a> </span>
<span class="sep"> | </span>
<span class="comments-link"><a href="https://www.virtuallyghetto.com/2018/03/getting-started-with-vmware-pivotal-container-service-pks-part-1-overview.html#comments">5 Comments</a></span>
</footer>
</article>
<article id="post-160265" class="post-160265 post type-post status-publish format-standard hentry category-automation category-nsx category-powercli tag-nsx-t tag-powercli">
<header class="entry-header">
<h1 class="entry-title"><a href="https://www.virtuallyghetto.com/2018/03/how-to-troubleshoot-nsx-t-api-errors-when-using-powercli.html" rel="bookmark">How to troubleshoot NSX-T API errors when using PowerCLI?</a></h1>
<div class="entry-meta">
Posted on <a href="https://www.virtuallyghetto.com/2018/03/how-to-troubleshoot-nsx-t-api-errors-when-using-powercli.html" title="9:16 am" rel="bookmark"><time class="entry-date" datetime="2018-03-21T09:16:25+00:00">03/21/2018</time></a><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://www.virtuallyghetto.com/author/lamw" title="View all posts by William Lam" rel="author">William Lam</a></span></span> </div>
</header>
<div class="entry-content">
<p>In the last few days, I have been ramping back up on NSX-T usage, especially as I take a closer look at <a href="https://cloud.vmware.com/pivotal-container-service" target="_blank" rel="noopener">VMware Pivotal Container Service (PKS)</a> which hopefully I will be able to share more with an upcoming blog series (at least, thats the plan when I find some spare time). While working on some Automation using the NSX-T REST APIs and the new NSX-T <a href="https://www.virtuallyghetto.com/2017/10/nsx-t-powercli-community-module.html" target="_blank" rel="noopener">PowerCLI cmdlets</a>, I found it to be pretty challenging and frustrating to troubleshoot NSX-T error messages thrown from the  PowerCLI cmdlets.</p>
<p>For example, below is a PowerCLI snippet which I wrote to create a new T1 Logical Router in NSX-T.</p>
<div id="crayon-5ab68a0935a3a699878723" class="crayon-syntax crayon-theme-tomorrow-night crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$edgeClusterService = Get-NsxtService -Name "com.vmware.nsx.edge_clusters"
$edgeCluster = $edgeClusterService.list().results | where { $_.display_name -eq "Edge-Cluster-01" }
$logicalRouterService = Get-NsxtService -Name "com.vmware.nsx.logical_routers"
$lrSpec = $logicalRouterService.Help.create.logical_router.Create()
$lrSpec.display_name = "Foo"
$lrSpec.router_type = "TIER1"
$lrSpec.high_availability_mode = "ACTIVE_STANDBY"
$lrSpec.failover_mode = "FAILOVER_MODE_PREEMPTIVE"
$lrSpec.edge_cluster_id = "ea655f88-e184-47fe-9352-8ab9d8c955a7"
$lrAdd = $logicalRouterService.create($lrSpec)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5ab68a0935a3a699878723-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab68a0935a3a699878723-2">2</div><div class="crayon-num" data-line="crayon-5ab68a0935a3a699878723-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab68a0935a3a699878723-4">4</div><div class="crayon-num" data-line="crayon-5ab68a0935a3a699878723-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab68a0935a3a699878723-6">6</div><div class="crayon-num" data-line="crayon-5ab68a0935a3a699878723-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab68a0935a3a699878723-8">8</div><div class="crayon-num" data-line="crayon-5ab68a0935a3a699878723-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab68a0935a3a699878723-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5ab68a0935a3a699878723-1"><span class="crayon-sy">$</span><span class="crayon-v">edgeClusterService</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Get</span><span class="crayon-o">-</span><span class="crayon-v">NsxtService</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Name</span><span class="crayon-h"> </span><span class="crayon-s">"com.vmware.nsx.edge_clusters"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab68a0935a3a699878723-2"><span class="crayon-sy">$</span><span class="crayon-v">edgeCluster</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">edgeClusterService</span><span class="crayon-sy">.</span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-e">where</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_</span><span class="crayon-sy">.</span><span class="crayon-v">display_name</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-s">"Edge-Cluster-01"</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5ab68a0935a3a699878723-3"><span class="crayon-sy">$</span><span class="crayon-v">logicalRouterService</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Get</span><span class="crayon-o">-</span><span class="crayon-v">NsxtService</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Name</span><span class="crayon-h"> </span><span class="crayon-s">"com.vmware.nsx.logical_routers"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab68a0935a3a699878723-4"><span class="crayon-sy">$</span><span class="crayon-v">lrSpec</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">logicalRouterService</span><span class="crayon-sy">.</span><span class="crayon-v">Help</span><span class="crayon-sy">.</span><span class="crayon-v">create</span><span class="crayon-sy">.</span><span class="crayon-v">logical_router</span><span class="crayon-sy">.</span><span class="crayon-e">Create</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5ab68a0935a3a699878723-5"><span class="crayon-sy">$</span><span class="crayon-v">lrSpec</span><span class="crayon-sy">.</span><span class="crayon-v">display_name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Foo"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab68a0935a3a699878723-6"><span class="crayon-sy">$</span><span class="crayon-v">lrSpec</span><span class="crayon-sy">.</span><span class="crayon-v">router_type</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"TIER1"</span></div><div class="crayon-line" id="crayon-5ab68a0935a3a699878723-7"><span class="crayon-sy">$</span><span class="crayon-v">lrSpec</span><span class="crayon-sy">.</span><span class="crayon-v">high_availability_mode</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"ACTIVE_STANDBY"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab68a0935a3a699878723-8"><span class="crayon-sy">$</span><span class="crayon-v">lrSpec</span><span class="crayon-sy">.</span><span class="crayon-v">failover_mode</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"FAILOVER_MODE_PREEMPTIVE"</span></div><div class="crayon-line" id="crayon-5ab68a0935a3a699878723-9"><span class="crayon-sy">$</span><span class="crayon-v">lrSpec</span><span class="crayon-sy">.</span><span class="crayon-v">edge_cluster_id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"ea655f88-e184-47fe-9352-8ab9d8c955a7"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab68a0935a3a699878723-10"><span class="crayon-sy">$</span><span class="crayon-v">lrAdd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">logicalRouterService</span><span class="crayon-sy">.</span><span class="crayon-e">create</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">lrSpec</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>

<p>However, when I ran the code, PowerCLI threw back a pretty generic and useless error which I am sure some of you have probably seen before "<em><b>A server error occurred: 'com.vmware.vapi.std.errors.invalid.frequest': . Check $Error[0].Exception.ServerError</b></em>". Even checking the error variable as stated in the error message did not yield any further details or specific to the issue I was running into.</p>
<p> <a href="https://www.virtuallyghetto.com/2018/03/how-to-troubleshoot-nsx-t-api-errors-when-using-powercli.html#more-160265" class="more-link">Continue reading <span class="meta-nav">&rarr;</span></a></p>
</div>
<footer class="entry-meta">
<span class="cat-links">
Category: <a href="https://www.virtuallyghetto.com/category/automation" rel="category tag">Automation</a>, <a href="https://www.virtuallyghetto.com/category/nsx" rel="category tag">NSX</a>, <a href="https://www.virtuallyghetto.com/category/powercli" rel="category tag">PowerCLI</a> </span>
<span class="sep"> | </span>
<span class="tags-links">
Tags: <a href="https://www.virtuallyghetto.com/tag/nsx-t" rel="tag">NSX-T</a>, <a href="https://www.virtuallyghetto.com/tag/powercli" rel="tag">powercli</a> </span>
<span class="sep"> | </span>
<span class="comments-link"><a href="https://www.virtuallyghetto.com/2018/03/how-to-troubleshoot-nsx-t-api-errors-when-using-powercli.html#respond">Leave a comment</a></span>
</footer>
</article>
<article id="post-160207" class="post-160207 post type-post status-publish format-standard hentry category-apple-2 category-esxi-2 tag-10gbe tag-esxi tag-mac-mini tag-mac-pro tag-sfp tag-sonnett tag-thunderbolt tag-thunderbolt-3">
<header class="entry-header">
<h1 class="entry-title"><a href="https://www.virtuallyghetto.com/2018/03/thunderbolt-to-10gbe-network-adapters-for-esxi.html" rel="bookmark">Thunderbolt to 10GbE Network Adapters for ESXi</a></h1>
<div class="entry-meta">
Posted on <a href="https://www.virtuallyghetto.com/2018/03/thunderbolt-to-10gbe-network-adapters-for-esxi.html" title="10:26 am" rel="bookmark"><time class="entry-date" datetime="2018-03-15T10:26:39+00:00">03/15/2018</time></a><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://www.virtuallyghetto.com/author/lamw" title="View all posts by William Lam" rel="author">William Lam</a></span></span> </div>
</header>
<div class="entry-content">
<p>I was recently made aware of this <a href="https://elatov.github.io/2016/03/10gb-and-thunderbolt-iscsi-ssd-testing/#esxi-iperf-test" target="_blank" rel="noopener">article</a> in which the author, Karim Elatov, had successfully demonstrated the use of a <a href="https://amzn.to/2FIPiaJ" target="_blank" rel="noopener">Sonnett Thunderbolt 2 to 10 Gigabit Ethernet Adapter</a> with ESXi running on an <a href="https://www.virtuallyghetto.com/apple" target="_blank" rel="noopener">Apple Mac Mini</a>. As far as I am aware of, this may be the first public confirmation that such a device would work with ESXi, not to mention having it functional on the Mac Mini. I know in past years, there have been unconfirmed reports on various forums mentioning a Thunderbolt to 10GbE solution that works with ESXi but it was unclear on whether custom drivers were needed or if it would even work with newer versions of ESXi.</p>
<p><a href="https://i2.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/03/prodhdr_twin10g.jpg?ssl=1" data-slb-active="1" data-slb-asset="411362735" data-slb-internal="0" data-slb-group="160207"><img data-attachment-id="160208" data-permalink="https://www.virtuallyghetto.com/2018/03/thunderbolt-to-10gbe-network-adapters-for-esxi.html/prodhdr_twin10g#main" data-orig-file="https://i2.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/03/prodhdr_twin10g.jpg?fit=899%2C285&amp;ssl=1" data-orig-size="899,285" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="prodhdr_twin10g" data-image-description="" data-medium-file="https://i2.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/03/prodhdr_twin10g.jpg?fit=300%2C95&amp;ssl=1" data-large-file="https://i2.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/03/prodhdr_twin10g.jpg?fit=770%2C244&amp;ssl=1" class="alignnone wp-image-160208 size-full" src="data:image/gif;base64,R0lGODdhAQABAPAAAP///wAAACwAAAAAAQABAEACAkQBADs=" data-lazy-src="https://i2.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/03/prodhdr_twin10g.jpg?resize=770%2C244&#038;ssl=1" alt="" width="770" height="244" data-lazy-srcset="https://i2.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/03/prodhdr_twin10g.jpg?w=899&amp;ssl=1 899w, https://i2.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/03/prodhdr_twin10g.jpg?resize=300%2C95&amp;ssl=1 300w, https://i2.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/03/prodhdr_twin10g.jpg?resize=768%2C243&amp;ssl=1 768w" data-lazy-sizes="(max-width: 770px) 100vw, 770px" data-recalc-dims="1" /><noscript><img data-attachment-id="160208" data-permalink="https://www.virtuallyghetto.com/2018/03/thunderbolt-to-10gbe-network-adapters-for-esxi.html/prodhdr_twin10g#main" data-orig-file="https://i2.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/03/prodhdr_twin10g.jpg?fit=899%2C285&amp;ssl=1" data-orig-size="899,285" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="prodhdr_twin10g" data-image-description="" data-medium-file="https://i2.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/03/prodhdr_twin10g.jpg?fit=300%2C95&amp;ssl=1" data-large-file="https://i2.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/03/prodhdr_twin10g.jpg?fit=770%2C244&amp;ssl=1" class="alignnone wp-image-160208 size-full" src="https://i2.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/03/prodhdr_twin10g.jpg?resize=770%2C244&#038;ssl=1" alt="" width="770" height="244" srcset="https://i2.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/03/prodhdr_twin10g.jpg?w=899&amp;ssl=1 899w, https://i2.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/03/prodhdr_twin10g.jpg?resize=300%2C95&amp;ssl=1 300w, https://i2.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/03/prodhdr_twin10g.jpg?resize=768%2C243&amp;ssl=1 768w" sizes="(max-width: 770px) 100vw, 770px" data-recalc-dims="1" /></noscript></a><br />
This topic has been popular amongst our customers who virtualize Apple MacOS on vSphere. In fact, several years back I had written an article on <a href="https://www.virtuallyghetto.com/2015/01/thunderbolt-storage-for-esxi.html" target="_blank" rel="noopener">Thunderbolt Storage for ESXi</a>, which includes a number of solutions that our customers have implemented to provide remote storage for their vSphere infrastructure running on either an Apple XServe, Mac Pro or Mac Mini. Questions around a functional Thunderbolt to 10GbE has definitely been asked about, but I had never heard from any customer who have had a successful story to share, at least until now.</p>
<p>From Karim's post, it looks like he was able to get this working using ESXi 6.0 but it was unclear if there was anything he needed to do to get the device recognized. I reached out to Karim and he was able to confirm that the Thunderbolt device was recognized by ESXi without any additional driver installation. In fact, if you look at this console output on his blog, you will see that it simply uses the inbox Intel ixgbe driver. I had also asked if Karim tried this with the latest version of ESXi, which is currently at 6.5 Update 1. Karim was kind enough to perform one additional test for me which was to confirm the device would still work with the latest ESXi release, which you can see for yourself in the screenshot below.</p>
<p> <a href="https://www.virtuallyghetto.com/2018/03/thunderbolt-to-10gbe-network-adapters-for-esxi.html#more-160207" class="more-link">Continue reading <span class="meta-nav">&rarr;</span></a></p>
</div>
<footer class="entry-meta">
<span class="cat-links">
Category: <a href="https://www.virtuallyghetto.com/category/apple-2" rel="category tag">Apple</a>, <a href="https://www.virtuallyghetto.com/category/esxi-2" rel="category tag">ESXi</a> </span>
<span class="sep"> | </span>
<span class="tags-links">
Tags: <a href="https://www.virtuallyghetto.com/tag/10gbe" rel="tag">10GbE</a>, <a href="https://www.virtuallyghetto.com/tag/esxi" rel="tag">esxi</a>, <a href="https://www.virtuallyghetto.com/tag/mac-mini" rel="tag">mac mini</a>, <a href="https://www.virtuallyghetto.com/tag/mac-pro" rel="tag">mac pro</a>, <a href="https://www.virtuallyghetto.com/tag/sfp" rel="tag">SFP+</a>, <a href="https://www.virtuallyghetto.com/tag/sonnett" rel="tag">Sonnett</a>, <a href="https://www.virtuallyghetto.com/tag/thunderbolt" rel="tag">thunderbolt</a>, <a href="https://www.virtuallyghetto.com/tag/thunderbolt-3" rel="tag">thunderbolt 3</a> </span>
<span class="sep"> | </span>
<span class="comments-link"><a href="https://www.virtuallyghetto.com/2018/03/thunderbolt-to-10gbe-network-adapters-for-esxi.html#comments">4 Comments</a></span>
</footer>
</article>
<article id="post-160178" class="post-160178 post type-post status-publish format-standard hentry category-vsan tag-hcl tag-rss tag-vsan">
<header class="entry-header">
<h1 class="entry-title"><a href="https://www.virtuallyghetto.com/2018/03/how-to-check-when-the-vsan-hardware-compatibility-list-hcl-is-updated.html" rel="bookmark">How to check when the VSAN Hardware Compatibility List (HCL) is updated?</a></h1>
<div class="entry-meta">
Posted on <a href="https://www.virtuallyghetto.com/2018/03/how-to-check-when-the-vsan-hardware-compatibility-list-hcl-is-updated.html" title="8:58 am" rel="bookmark"><time class="entry-date" datetime="2018-03-13T08:58:41+00:00">03/13/2018</time></a><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://www.virtuallyghetto.com/author/lamw" title="View all posts by William Lam" rel="author">William Lam</a></span></span> </div>
</header>
<div class="entry-content">
<p>While catching up on emails from being out on paternity leave, I came across a VSAN HCL feature request that I had filed in early December of last year. I was pleasantly surprise to see that it had been marked resolved. The <a href="https://www.vmware.com/resources/compatibility/search.php?deviceCategory=vsan" target="_blank" rel="noopener">VSAN Hardware Compatibility List</a> is continuously being updated to include new hardware platforms and components that have been certified by our hardware vendors.</p>
<p>This of course is great news for our customers, but one challenge that I have heard on several occasion is how to keep up with the changes, especially the addition of new components? The VSAN HCL allows you to subscribe and get notification on individual components which is useful to get the latest recommendation. However, in the case of new components being add or even removed, there is no easy solution and most folks resort to manually checking the VSAN HCL by hand.</p>
<p>VSAN itself does include an <a href="https://kb.vmware.com/s/article/2109870" target="_blank" rel="noopener">HCL healthcheck</a>, which you can have it directly pull the latest <a href="https://www.virtuallyghetto.com/2015/05/how-to-download-offline-vsan-hcl-file-for-vsan-health-check-plugin.html" target="_blank" rel="noopener">VSAN HCL JSON</a> from VMware's website, although this may not always be possible for customers without direct or proxy access to the internet. This means for customers who may have dark sites, they must periodically download the latest VSAN HCL JSON and distribute that throughout their vCenter Server, where as a more ideal solution is to only push the update when a new JSON has been provided by VMware.</p>
<p>My feature request was quite simple, it asks for a method in which customers can easily subscribe and get notified of when the VSAN HCL database has been updated. This has been delivered as a tiny RSS feed service.</p>
<p> <a href="https://www.virtuallyghetto.com/2018/03/how-to-check-when-the-vsan-hardware-compatibility-list-hcl-is-updated.html#more-160178" class="more-link">Continue reading <span class="meta-nav">&rarr;</span></a></p>
</div>
<footer class="entry-meta">
<span class="cat-links">
Category: <a href="https://www.virtuallyghetto.com/category/vsan" rel="category tag">VSAN</a> </span>
<span class="sep"> | </span>
<span class="tags-links">
Tags: <a href="https://www.virtuallyghetto.com/tag/hcl" rel="tag">hcl</a>, <a href="https://www.virtuallyghetto.com/tag/rss" rel="tag">RSS</a>, <a href="https://www.virtuallyghetto.com/tag/vsan" rel="tag">VSAN</a> </span>
<span class="sep"> | </span>
<span class="comments-link"><a href="https://www.virtuallyghetto.com/2018/03/how-to-check-when-the-vsan-hardware-compatibility-list-hcl-is-updated.html#respond">Leave a comment</a></span>
</footer>
</article>
<article id="post-160016" class="post-160016 post type-post status-publish format-standard hentry category-automation category-powercli category-security tag-cpuid-ibpb tag-cpuid-ibrs tag-cpuid-stibp tag-intel-sighting tag-powercli tag-security tag-spectre">
<header class="entry-header">
<h1 class="entry-title"><a href="https://www.virtuallyghetto.com/2018/01/automating-intel-sighting-remediation-using-powercli-ssh-not-required.html" rel="bookmark">Automating Intel Sighting remediation using PowerCLI (SSH not required)</a></h1>
<div class="entry-meta">
Posted on <a href="https://www.virtuallyghetto.com/2018/01/automating-intel-sighting-remediation-using-powercli-ssh-not-required.html" title="7:06 am" rel="bookmark"><time class="entry-date" datetime="2018-01-14T07:06:21+00:00">01/14/2018</time></a><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://www.virtuallyghetto.com/author/lamw" title="View all posts by William Lam" rel="author">William Lam</a></span></span> </div>
</header>
<div class="entry-content">
<p>In case you may not be aware, Intel recently notified VMware that certain Intel Broadwell and Haswell CPUs are affected by Intel Sighting after applying the latest microcode update to remediate against the Spectre vulnerability. VMware has published the following <a href="https://kb.vmware.com/s/article/52345" target="_blank" rel="noopener">KB 52345</a> which provides more details on the affected Intel CPUs along with the recommended workaround in case you have already applied the latest ESXi patches containing the faulty microcode. I highly recommend you carefully read over the KB before, even if you have not applied the ESXi patches proceeding further.</p>
<p>With this updated news, I have also updated my existing Spectre verification script (found <a href="https://www.virtuallyghetto.com/2018/01/verify-hypervisor-assisted-guest-mitigation-spectre-patches-using-powercli.html" target="_blank" rel="noopener">here</a>) to include the additional Intel Sighting information which can help customers easily identify whether they have ESXi hosts that are impacted. In this article, I will provide a solution to help automate the deployment of the Intel Sighting remediation as outlined in the KB article, but unlike the manual steps outlined in the KB, SSH access to the underlying ESXi host will NOT required.</p>
<p><strong>Step 1</strong> - Download the <a href="https://www.virtuallyghetto.com/2018/01/verify-hypervisor-assisted-guest-mitigation-spectre-patches-using-powercli.html" target="_blank" rel="noopener"><strong>VerifyESXiMicrocode.ps1</strong></a> PowerCLI script as well as the new PowerCLI script <a href="https://github.com/lamw/vghetto-scripts/blob/master/powershell/IntelSightingWorkaround.ps1" target="_blank" rel="noopener"><strong>IntelSightingWorkaround.ps1</strong></a></p>
<p><strong>Step 2</strong> - Run the "<strong>Verify-ESXiMicrocodePatch</strong>" function against a specific vSphere Cluster or ESXi host to determine if you are impacted by the Intel Sighting issue. Below is a screenshot for a system which is affected by Intel Sighting and we can determine this by seeing a value of "True" under the IntelSighting column.</p>
<p><a href="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/hypervisor-assisted-guest-updated-screenshot-05.png?ssl=1" data-slb-active="1" data-slb-asset="642108325" data-slb-internal="0" data-slb-group="160016"><img data-attachment-id="160044" data-permalink="https://www.virtuallyghetto.com/2018/01/automating-intel-sighting-remediation-using-powercli-ssh-not-required.html/hypervisor-assisted-guest-updated-screenshot-05#main" data-orig-file="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/hypervisor-assisted-guest-updated-screenshot-05.png?fit=2345%2C129&amp;ssl=1" data-orig-size="2345,129" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="hypervisor-assisted-guest-updated-screenshot-05" data-image-description="" data-medium-file="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/hypervisor-assisted-guest-updated-screenshot-05.png?fit=300%2C17&amp;ssl=1" data-large-file="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/hypervisor-assisted-guest-updated-screenshot-05.png?fit=770%2C42&amp;ssl=1" class="alignnone size-full wp-image-160044" src="data:image/gif;base64,R0lGODdhAQABAPAAAP///wAAACwAAAAAAQABAEACAkQBADs=" data-lazy-src="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/hypervisor-assisted-guest-updated-screenshot-05.png?resize=770%2C42&#038;ssl=1" alt="" width="770" height="42" data-recalc-dims="1" /><noscript><img data-attachment-id="160044" data-permalink="https://www.virtuallyghetto.com/2018/01/automating-intel-sighting-remediation-using-powercli-ssh-not-required.html/hypervisor-assisted-guest-updated-screenshot-05#main" data-orig-file="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/hypervisor-assisted-guest-updated-screenshot-05.png?fit=2345%2C129&amp;ssl=1" data-orig-size="2345,129" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="hypervisor-assisted-guest-updated-screenshot-05" data-image-description="" data-medium-file="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/hypervisor-assisted-guest-updated-screenshot-05.png?fit=300%2C17&amp;ssl=1" data-large-file="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/hypervisor-assisted-guest-updated-screenshot-05.png?fit=770%2C42&amp;ssl=1" class="alignnone size-full wp-image-160044" src="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/hypervisor-assisted-guest-updated-screenshot-05.png?resize=770%2C42&#038;ssl=1" alt="" width="770" height="42" data-recalc-dims="1" /></noscript></a><br />
<strong>Step 3</strong> (Optional) - This step is optional, but I wanted to demonstrate how you can tell whether the Intel Sighting workaround has been applied correctly. You can use the "<strong>Verify-ESXiMicrocodePatchAndVM</strong>" function which provides information from a Virtual Machine's perspective and whether the new CPU instructions are exposed to the VM. In the screenshot below, I have a Test VM called TestVM-03 that has been powered on and as you can see, the three new CPU instructions (IBR,IBPB and STIB) are present as I have not applied the Intel Sighting workaround.</p>
<p><a href="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-1.png?ssl=1" data-slb-active="1" data-slb-asset="1529052024" data-slb-internal="0" data-slb-group="160016"><img data-attachment-id="160023" data-permalink="https://www.virtuallyghetto.com/2018/01/automating-intel-sighting-remediation-using-powercli-ssh-not-required.html/remediating-intel-sighting-using-powercli-1#main" data-orig-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-1.png?fit=1001%2C133&amp;ssl=1" data-orig-size="1001,133" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="remediating-intel-sighting-using-powercli-1" data-image-description="" data-medium-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-1.png?fit=300%2C40&amp;ssl=1" data-large-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-1.png?fit=770%2C102&amp;ssl=1" class="alignnone size-full wp-image-160023" src="data:image/gif;base64,R0lGODdhAQABAPAAAP///wAAACwAAAAAAQABAEACAkQBADs=" data-lazy-src="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-1.png?resize=770%2C102&#038;ssl=1" alt="" width="770" height="102" data-recalc-dims="1" /><noscript><img data-attachment-id="160023" data-permalink="https://www.virtuallyghetto.com/2018/01/automating-intel-sighting-remediation-using-powercli-ssh-not-required.html/remediating-intel-sighting-using-powercli-1#main" data-orig-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-1.png?fit=1001%2C133&amp;ssl=1" data-orig-size="1001,133" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="remediating-intel-sighting-using-powercli-1" data-image-description="" data-medium-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-1.png?fit=300%2C40&amp;ssl=1" data-large-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-1.png?fit=770%2C102&amp;ssl=1" class="alignnone size-full wp-image-160023" src="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-1.png?resize=770%2C102&#038;ssl=1" alt="" width="770" height="102" data-recalc-dims="1" /></noscript></a><br />
<strong>Step 4</strong> (Optional) - This step is also optional, but I wanted to demonstrate how you can quickly check the contents of /etc/vmware/config without requiring SSH access or direct ESXi Shell access. You can use the "<strong>Get-Esxconfig</strong>" function and specify an ESXi host to query. The screenshot below confirms that we have not deployed the Intel Sighting workaround.</p>
<p><a href="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-2.png?ssl=1" data-slb-active="1" data-slb-asset="1991623277" data-slb-internal="0" data-slb-group="160016"><img data-attachment-id="160024" data-permalink="https://www.virtuallyghetto.com/2018/01/automating-intel-sighting-remediation-using-powercli-ssh-not-required.html/remediating-intel-sighting-using-powercli-2#main" data-orig-file="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-2.png?fit=983%2C216&amp;ssl=1" data-orig-size="983,216" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="remediating-intel-sighting-using-powercli-2" data-image-description="" data-medium-file="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-2.png?fit=300%2C66&amp;ssl=1" data-large-file="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-2.png?fit=770%2C169&amp;ssl=1" class="alignnone size-full wp-image-160024" src="data:image/gif;base64,R0lGODdhAQABAPAAAP///wAAACwAAAAAAQABAEACAkQBADs=" data-lazy-src="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-2.png?resize=770%2C169&#038;ssl=1" alt="" width="770" height="169" data-recalc-dims="1" /><noscript><img data-attachment-id="160024" data-permalink="https://www.virtuallyghetto.com/2018/01/automating-intel-sighting-remediation-using-powercli-ssh-not-required.html/remediating-intel-sighting-using-powercli-2#main" data-orig-file="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-2.png?fit=983%2C216&amp;ssl=1" data-orig-size="983,216" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="remediating-intel-sighting-using-powercli-2" data-image-description="" data-medium-file="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-2.png?fit=300%2C66&amp;ssl=1" data-large-file="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-2.png?fit=770%2C169&amp;ssl=1" class="alignnone size-full wp-image-160024" src="https://i0.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-2.png?resize=770%2C169&#038;ssl=1" alt="" width="770" height="169" data-recalc-dims="1" /></noscript></a><br />
<strong>Step 5</strong> - Once we have identified the ESXi hosts that are impacted by Intel Sightin (See step 2), we need to create a text file that contains the Hostname/IP of ESXi hosts (one on each line) that we wish to remediate. This will then be used as an input to the remediation function. In the example here, I have a single host to remediate and have added its name to a file that I have called "affected_hosts".txt (it can be named anything).</p>
<p><span style="color: #ff0000;"><strong>Note:</strong></span> The remediation does NOT require the ESXi host to reboot for the changes to go into effect, but you may still want to consider following standard procedures of putting the host into Maintenance Mode if you wish to control when VMs will see the masked instruction which will require a VM power cycle (OS restart is not sufficient).</p>
<p>To apply the remediation, you will use the "<strong>Set-IntelSightingsWorkaround</strong>" function which has a single mandatory parameter called AffectedHostList. Below is a screenshot of running the function and the remediation is fairly quick as it is merely appending a single string to the /etc/vmware/config configuration file. After the remediation has completed, we can then use the "<strong>Get-Esxconfig</strong>" function to confirm that we have added the masked CPU instruction to the ESXi host as shown in screenshot below.</p>
<p><a href="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-3.png?ssl=1" data-slb-active="1" data-slb-asset="2002983504" data-slb-internal="0" data-slb-group="160016"><img data-attachment-id="160025" data-permalink="https://www.virtuallyghetto.com/2018/01/automating-intel-sighting-remediation-using-powercli-ssh-not-required.html/remediating-intel-sighting-using-powercli-3#main" data-orig-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-3.png?fit=1532%2C352&amp;ssl=1" data-orig-size="1532,352" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="remediating-intel-sighting-using-powercli-3" data-image-description="" data-medium-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-3.png?fit=300%2C69&amp;ssl=1" data-large-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-3.png?fit=770%2C177&amp;ssl=1" class="alignnone size-full wp-image-160025" src="data:image/gif;base64,R0lGODdhAQABAPAAAP///wAAACwAAAAAAQABAEACAkQBADs=" data-lazy-src="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-3.png?resize=770%2C177&#038;ssl=1" alt="" width="770" height="177" data-recalc-dims="1" /><noscript><img data-attachment-id="160025" data-permalink="https://www.virtuallyghetto.com/2018/01/automating-intel-sighting-remediation-using-powercli-ssh-not-required.html/remediating-intel-sighting-using-powercli-3#main" data-orig-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-3.png?fit=1532%2C352&amp;ssl=1" data-orig-size="1532,352" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="remediating-intel-sighting-using-powercli-3" data-image-description="" data-medium-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-3.png?fit=300%2C69&amp;ssl=1" data-large-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-3.png?fit=770%2C177&amp;ssl=1" class="alignnone size-full wp-image-160025" src="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-3.png?resize=770%2C177&#038;ssl=1" alt="" width="770" height="177" data-recalc-dims="1" /></noscript></a><br />
<strong>Step 6</strong> - As the KB mentions, for the changes to go into affect, you will need to perform a complete power cycle of your VMs before they can see the new masked CPU instructions. If you recall earlier, I had a VM called TestVM-03 which saw the three new CPU instructions. If we power cycle the VM and re-run the "<strong>Verify-ESXiMicrocodePatchAndVM</strong>" function against our VM, we should now see that the three CPU instructions have been properly masked away as shown in the screenshot below.</p>
<p><a href="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-4.png?ssl=1" data-slb-active="1" data-slb-asset="720683224" data-slb-internal="0" data-slb-group="160016"><img data-attachment-id="160026" data-permalink="https://www.virtuallyghetto.com/2018/01/automating-intel-sighting-remediation-using-powercli-ssh-not-required.html/remediating-intel-sighting-using-powercli-4#main" data-orig-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-4.png?fit=997%2C146&amp;ssl=1" data-orig-size="997,146" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="remediating-intel-sighting-using-powercli-4" data-image-description="" data-medium-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-4.png?fit=300%2C44&amp;ssl=1" data-large-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-4.png?fit=770%2C113&amp;ssl=1" class="alignnone size-full wp-image-160026" src="data:image/gif;base64,R0lGODdhAQABAPAAAP///wAAACwAAAAAAQABAEACAkQBADs=" data-lazy-src="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-4.png?resize=770%2C113&#038;ssl=1" alt="" width="770" height="113" data-recalc-dims="1" /><noscript><img data-attachment-id="160026" data-permalink="https://www.virtuallyghetto.com/2018/01/automating-intel-sighting-remediation-using-powercli-ssh-not-required.html/remediating-intel-sighting-using-powercli-4#main" data-orig-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-4.png?fit=997%2C146&amp;ssl=1" data-orig-size="997,146" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="remediating-intel-sighting-using-powercli-4" data-image-description="" data-medium-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-4.png?fit=300%2C44&amp;ssl=1" data-large-file="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-4.png?fit=770%2C113&amp;ssl=1" class="alignnone size-full wp-image-160026" src="https://i1.wp.com/www.virtuallyghetto.com/wp-content/uploads/2018/01/remediating-intel-sighting-using-powercli-4.png?resize=770%2C113&#038;ssl=1" alt="" width="770" height="113" data-recalc-dims="1" /></noscript></a><br />
When it is time to remove the workaround, the process is also very straight forward as well. You can use the "<strong>Remove-IntelSightingsWorkaround</strong>" function which also accepts a list of ESXi hosts to remediate. Once the remediation has completed and you wish to expose the new CPU instructions to the VMs, you will also need to power cycle the VMs for CPU instructions to be unmasked.</p>
</div>
<footer class="entry-meta">
<span class="cat-links">
Category: <a href="https://www.virtuallyghetto.com/category/automation" rel="category tag">Automation</a>, <a href="https://www.virtuallyghetto.com/category/powercli" rel="category tag">PowerCLI</a>, <a href="https://www.virtuallyghetto.com/category/security" rel="category tag">Security</a> </span>
<span class="sep"> | </span>
<span class="tags-links">
Tags: <a href="https://www.virtuallyghetto.com/tag/cpuid-ibpb" rel="tag">cpuid.IBPB</a>, <a href="https://www.virtuallyghetto.com/tag/cpuid-ibrs" rel="tag">cpuid.IBRS</a>, <a href="https://www.virtuallyghetto.com/tag/cpuid-stibp" rel="tag">cpuid.STIBP</a>, <a href="https://www.virtuallyghetto.com/tag/intel-sighting" rel="tag">Intel Sighting</a>, <a href="https://www.virtuallyghetto.com/tag/powercli" rel="tag">powercli</a>, <a href="https://www.virtuallyghetto.com/tag/security" rel="tag">security</a>, <a href="https://www.virtuallyghetto.com/tag/spectre" rel="tag">Spectre</a> </span>
<span class="sep"> | </span>
<span class="comments-link"><a href="https://www.virtuallyghetto.com/2018/01/automating-intel-sighting-remediation-using-powercli-ssh-not-required.html#comments">22 Comments</a></span>
</footer>
</article>
<nav role="navigation" id="nav-below" class="navigation-paging">
<h1 class="screen-reader-text">Post navigation</h1>
<div class="nav-previous"><a href="https://www.virtuallyghetto.com/page/2"><span class="meta-nav">&larr;</span> Older posts</a></div>
</nav>
</div>
</div>
<div id="secondary" class="widget-area" role="complementary">
<aside id="text-5" class="widget widget_text"> <div class="textwidget"><div class="circular_author"></div>
<center><b>William Lam</b></center></div>
</aside><aside id="simple-social-icons-4" class="widget simple-social-icons"><ul class="aligncenter"><li class="ssi-github"><a href="https://github.com/lamw" target="_blank"><svg role="img" class="social-github" aria-labelledby="social-github"><title id="social-github">Github</title><use xlink:href="https://www.virtuallyghetto.com/wp-content/plugins/simple-social-icons/symbol-defs.svg#social-github"></use></svg></a></li><li class="ssi-gplus"><a href="https://plus.google.com/114142893306148938477" target="_blank"><svg role="img" class="social-gplus" aria-labelledby="social-gplus"><title id="social-gplus">Google+</title><use xlink:href="https://www.virtuallyghetto.com/wp-content/plugins/simple-social-icons/symbol-defs.svg#social-gplus"></use></svg></a></li><li class="ssi-linkedin"><a href="https://www.linkedin.com/in/lamwilliam/" target="_blank"><svg role="img" class="social-linkedin" aria-labelledby="social-linkedin"><title id="social-linkedin">Linkedin</title><use xlink:href="https://www.virtuallyghetto.com/wp-content/plugins/simple-social-icons/symbol-defs.svg#social-linkedin"></use></svg></a></li><li class="ssi-rss"><a href="https://www.virtuallyghetto.com/rss" target="_blank"><svg role="img" class="social-rss" aria-labelledby="social-rss"><title id="social-rss">RSS</title><use xlink:href="https://www.virtuallyghetto.com/wp-content/plugins/simple-social-icons/symbol-defs.svg#social-rss"></use></svg></a></li><li class="ssi-twitter"><a href="https://twitter.com/lamw" target="_blank"><svg role="img" class="social-twitter" aria-labelledby="social-twitter"><title id="social-twitter">Twitter</title><use xlink:href="https://www.virtuallyghetto.com/wp-content/plugins/simple-social-icons/symbol-defs.svg#social-twitter"></use></svg></a></li></ul></aside><aside id="search-5" class="widget widget_search"> <form method="get" id="searchform" class="searchform" action="https://www.virtuallyghetto.com/" role="search">
<label for="s" class="screen-reader-text">Search</label>
<input type="search" class="field" name="s" value="" id="s" placeholder="Search &hellip;" />
<input type="submit" class="submit" id="searchsubmit" value="Search" />
</form>
</aside><aside id="bsa-6" class="widget widget_bsa">

<div id="bsap_1282588" class="bsarocks bsap_6d274f0434e88e8f84574d74902bc1c4"></div>

</aside> </div>
</div>
<footer id="colophon" class="site-footer" role="contentinfo">
<div class="site-info">
<a href="https://wordpress.org/" title="A Semantic Personal Publishing Platform" rel="generator">Proudly powered by WordPress</a>
<span class="sep"> | </span>
Theme: m1 Theme by <a href="http://m1themes.com" title="m1 Themes" rel="designer">m1 Themes</a>. </div>
</footer>
</div>
<script type="text/javascript">
  analytics.track("Viewed Home Page", {"noninteraction":true}, {"library":"analytics-wordpress"});
    
</script>
<div style="display:none">
</div>
<!--[if lte IE 8]>
<link rel='stylesheet' id='jetpack-carousel-ie8fix-css'  href='https://www.virtuallyghetto.com/wp-content/plugins/jetpack/modules/carousel/jetpack-carousel-ie8fix.css?ver=20121024' type='text/css' media='all' />
<![endif]-->
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/plugins/jetpack/_inc/build/photon/photon.min.js?ver=20130122'></script>
<script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201812'></script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/plugins/simple-share-buttons-adder/js/ssba.js?ver=4.9.4'></script>
<script type='text/javascript'>
Main.boot( [] );
</script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/themes/m1/js/skip-link-focus-fix.js?ver=20130115'></script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/plugins/jetpack/_inc/build/lazy-images/js/lazy-images.min.js?ver=5.9'></script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-includes/js/wp-embed.min.js?ver=4.9.4'></script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/plugins/jetpack/_inc/build/spin.min.js?ver=1.3'></script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/plugins/jetpack/_inc/build/jquery.spin.min.js?ver=1.3'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/www.virtuallyghetto.com\/wp-admin\/admin-ajax.php","nonce":"94803f9ed1","display_exif":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/www.virtuallyghetto.com\/wp-login.php?redirect_to=https%3A%2F%2Fwww.virtuallyghetto.com%2F2018%2F03%2Fthunderbolt-to-10gbe-network-adapters-for-esxi.html","blog_id":"1","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"local_comments_commenting_as":"<fieldset><label for=\"email\">Email (Required)<\/label> <input type=\"text\" name=\"email\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-email-field\" \/><\/fieldset><fieldset><label for=\"author\">Name (Required)<\/label> <input type=\"text\" name=\"author\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-author-field\" \/><\/fieldset><fieldset><label for=\"url\">Website<\/label> <input type=\"text\" name=\"url\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-url-field\" \/><\/fieldset>"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/plugins/jetpack/_inc/build/carousel/jetpack-carousel.min.js?ver=20170209'></script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/plugins/simple-lightbox/client/js/prod/lib.core.js?ver=2.6.0'></script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/plugins/simple-lightbox/client/js/prod/lib.view.js?ver=2.6.0'></script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/plugins/simple-lightbox/themes/baseline/js/prod/client.js?ver=2.6.0'></script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/plugins/simple-lightbox/themes/default/js/prod/client.js?ver=2.6.0'></script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/plugins/simple-lightbox/template-tags/item/js/prod/tag.item.js?ver=2.6.0'></script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/plugins/simple-lightbox/template-tags/ui/js/prod/tag.ui.js?ver=2.6.0'></script>
<script type='text/javascript' src='https://www.virtuallyghetto.com/wp-content/plugins/simple-lightbox/content-handlers/image/js/prod/handler.image.js?ver=2.6.0'></script>
<script type="text/javascript" id="slb_footer">/* <![CDATA[ */if ( !!window.jQuery ) {(function($){$(document).ready(function(){if ( !!window.SLB && SLB.has_child('View.init') ) { SLB.View.init({"ui_autofit":true,"ui_animate":true,"slideshow_autostart":true,"slideshow_duration":"6","group_loop":true,"ui_overlay_opacity":"0.8","ui_title_default":false,"theme_default":"slb_default","ui_labels":{"loading":"Loading","close":"Close","nav_next":"Next","nav_prev":"Previous","slideshow_start":"Start slideshow","slideshow_stop":"Stop slideshow","group_status":"Item %current% of %total%"}}); }
if ( !!window.SLB && SLB.has_child('View.assets') ) { {$.extend(SLB.View.assets, {"411362735":{"id":160208,"type":"image","source":"https:\/\/www.virtuallyghetto.com\/wp-content\/uploads\/2018\/03\/prodhdr_twin10g.jpg","internal":true,"sizes":{"thumbnail":{"file":"prodhdr_twin10g-150x150.jpg","width":150,"height":150,"mime-type":"image\/jpeg"},"medium":{"file":"prodhdr_twin10g-300x95.jpg","width":300,"height":95,"mime-type":"image\/jpeg"},"medium_large":{"file":"prodhdr_twin10g-768x243.jpg","width":768,"height":243,"mime-type":"image\/jpeg"},"post-thumbnail":{"file":"prodhdr_twin10g-770x250.jpg","width":770,"height":250,"mime-type":"image\/jpeg"},"wp_rp_thumbnail":{"file":"prodhdr_twin10g-150x150.jpg","width":150,"height":150,"mime-type":"image\/jpeg"},"original":{"file":"2018\/03\/prodhdr_twin10g.jpg","width":899,"height":285}},"image_meta":{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0","keywords":[]},"description":"","title":"prodhdr_twin10g","caption":""},"642108325":{"id":160044,"type":"image","source":"https:\/\/www.virtuallyghetto.com\/wp-content\/uploads\/2018\/01\/hypervisor-assisted-guest-updated-screenshot-05.png","internal":true,"image_meta":{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0","keywords":[]},"sizes":{"original":{"file":"2018\/01\/hypervisor-assisted-guest-updated-screenshot-05.png","width":2345,"height":129}},"description":"","title":"hypervisor-assisted-guest-updated-screenshot-05","caption":""},"1529052024":{"id":160023,"type":"image","source":"https:\/\/www.virtuallyghetto.com\/wp-content\/uploads\/2018\/01\/remediating-intel-sighting-using-powercli-1.png","internal":true,"image_meta":{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0","keywords":[]},"sizes":{"original":{"file":"2018\/01\/remediating-intel-sighting-using-powercli-1.png","width":1001,"height":133}},"description":"","title":"remediating-intel-sighting-using-powercli-1","caption":""},"1991623277":{"id":160024,"type":"image","source":"https:\/\/www.virtuallyghetto.com\/wp-content\/uploads\/2018\/01\/remediating-intel-sighting-using-powercli-2.png","internal":true,"image_meta":{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0","keywords":[]},"sizes":{"original":{"file":"2018\/01\/remediating-intel-sighting-using-powercli-2.png","width":983,"height":216}},"description":"","title":"remediating-intel-sighting-using-powercli-2","caption":""},"2002983504":{"id":160025,"type":"image","source":"https:\/\/www.virtuallyghetto.com\/wp-content\/uploads\/2018\/01\/remediating-intel-sighting-using-powercli-3.png","internal":true,"image_meta":{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0","keywords":[]},"sizes":{"original":{"file":"2018\/01\/remediating-intel-sighting-using-powercli-3.png","width":1532,"height":352}},"description":"","title":"remediating-intel-sighting-using-powercli-3","caption":""},"720683224":{"id":160026,"type":"image","source":"https:\/\/www.virtuallyghetto.com\/wp-content\/uploads\/2018\/01\/remediating-intel-sighting-using-powercli-4.png","internal":true,"image_meta":{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0","keywords":[]},"sizes":{"original":{"file":"2018\/01\/remediating-intel-sighting-using-powercli-4.png","width":997,"height":146}},"description":"","title":"remediating-intel-sighting-using-powercli-4","caption":""}});} }
/* THM */
if ( !!window.SLB && SLB.has_child('View.extend_theme') ) { SLB.View.extend_theme('slb_baseline',{"name":"Baseline","parent":"","styles":[{"handle":"base","uri":"https:\/\/www.virtuallyghetto.com\/wp-content\/plugins\/simple-lightbox\/themes\/baseline\/css\/style.css","deps":[]}],"layout_raw":"<div class=\"slb_container\"><div class=\"slb_content\">{{item.content}}<div class=\"slb_nav\"><span class=\"slb_prev\">{{ui.nav_prev}}<\/span><span class=\"slb_next\">{{ui.nav_next}}<\/span><\/div><div class=\"slb_controls\"><span class=\"slb_close\">{{ui.close}}<\/span><span class=\"slb_slideshow\">{{ui.slideshow_control}}<\/span><\/div><div class=\"slb_loading\">{{ui.loading}}<\/div><\/div><div class=\"slb_details\"><div class=\"inner\"><div class=\"slb_data\"><div class=\"slb_data_content\"><span class=\"slb_data_title\">{{item.title}}<\/span><span class=\"slb_group_status\">{{ui.group_status}}<\/span><div class=\"slb_data_desc\">{{item.description}}<\/div><\/div><\/div><div class=\"slb_nav\"><span class=\"slb_prev\">{{ui.nav_prev}}<\/span><span class=\"slb_next\">{{ui.nav_next}}<\/span><\/div><\/div><\/div><\/div>"}); }if ( !!window.SLB && SLB.has_child('View.extend_theme') ) { SLB.View.extend_theme('slb_default',{"name":"Default (Light)","parent":"slb_baseline","styles":[{"handle":"font","uri":"https:\/\/fonts.googleapis.com\/css?family=Yanone+Kaffeesatz","deps":[]},{"handle":"base","uri":"https:\/\/www.virtuallyghetto.com\/wp-content\/plugins\/simple-lightbox\/themes\/default\/css\/style.css","deps":[]}]}); }})})(jQuery);}/* ]]> */</script>
<script type="text/javascript" id="slb_context">/* <![CDATA[ */if ( !!window.jQuery ) {(function($){$(document).ready(function(){if ( !!window.SLB ) { {$.extend(SLB, {"context":["public","user_guest"]});} }})})(jQuery);}/* ]]> */</script>
<script type='text/javascript' src='https://stats.wp.com/e-201812.js' async='async' defer='defer'></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:5.9',blog:'67295360',post:'0',tz:'-7',srv:'www.virtuallyghetto.com'} ]);
	_stq.push([ 'clickTrackerInit', '67295360', '0' ]);
</script>
<script>(function(w, d){
	var b = d.getElementsByTagName("body")[0];
	var s = d.createElement("script"); s.async = true;
	var v = !("IntersectionObserver" in w) ? "8.5.2" : "10.3.5";
	s.src = "https://www.virtuallyghetto.com/wp-content/plugins/rocket-lazy-load/assets/js/lazyload-" + v + ".min.js";
	w.lazyLoadOptions = {
		elements_selector: "img, iframe",
		data_src: "lazy-src",
		data_srcset: "lazy-srcset",
		skip_invisible: false,
		class_loading: "lazyloading",
		class_loaded: "lazyloaded",
		threshold: 300,
		callback_load: function(element) {
			if ( element.tagName === "IFRAME" && element.dataset.rocketLazyload == "fitvidscompatible" ) {
				if (element.classList.contains("lazyloaded") ) {
					if (typeof window.jQuery != "undefined") {
						if (jQuery.fn.fitVids) {
							jQuery(element).parent().fitVids();
						}
					}
				}
			}
		}
	};
	b.appendChild(s);
}(window, document));

// Listen to the Initialized event
window.addEventListener('LazyLoad::Initialized', function (e) {
    // Get the instance and puts it in the lazyLoadInstance variable
	var lazyLoadInstance = e.detail.instance;

	var observer = new MutationObserver(function(mutations) {
		mutations.forEach(function(mutation) {
			lazyLoadInstance.update();
		} );
	} );
	
	var b      = document.getElementsByTagName("body")[0];
	var config = { childList: true, subtree: true };
	
	observer.observe(b, config);
}, false);
</script> <script>function lazyLoadThumb(e){var t='<img src="https://i.ytimg.com/vi/ID/hqdefault.jpg">',a='<div class="play"></div>';return t.replace("ID",e)+a}function lazyLoadYoutubeIframe(){var e=document.createElement("iframe"),t="https://www.youtube.com/embed/ID?autoplay=1";e.setAttribute("src",t.replace("ID",this.dataset.id)),e.setAttribute("frameborder","0"),e.setAttribute("allowfullscreen","1"),this.parentNode.replaceChild(e,this)}document.addEventListener("DOMContentLoaded",function(){var e,t,a=document.getElementsByClassName("rll-youtube-player");for(t=0;t<a.length;t++)e=document.createElement("div"),e.setAttribute("data-id",a[t].dataset.id),e.innerHTML=lazyLoadThumb(a[t].dataset.id),e.onclick=lazyLoadYoutubeIframe,a[t].appendChild(e)});</script>
</body>
</html>