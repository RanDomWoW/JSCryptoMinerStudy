

<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# books: http://ogp.me/ns/books#">
    <title>Edelweiss+</title>
    <meta charset="utf-8" />
                               <meta property="og:site_name" content="Edelweiss+" />
                               <meta property="fb:app_id" content="1669614589778994" /><meta property="og:title" content="Edelweiss+" />
                               <meta name="description" content="Edelweiss+, by Above the Treeline, is the book industry’s platform to sell, discover, and order new titles. Work better, read more." />
                               <meta property="og:description" content="Edelweiss+, by Above the Treeline, is the book industry’s platform to sell, discover, and order new titles. Work better, read more." />
                               <meta property="og:image" content="https://edel-images.azureedge.net/ea/eplus-common/eplus_logo_square.png" />
                               <meta property="og:image:alt" content="Edelweiss+ Logo" />
                               <meta property="og:type" content="website" />
                               <meta property="og:url" content="https://www.edelweiss.plus/" />
    <link type="image/x-icon" href="/favicon.ico" rel="shortcut icon">
    <link type="image/x-icon" href="/favicon.ico" rel="icon">
    <link href="/css/jquery/ui/smoothness/css?v=nUvI0RokXqzh7LU1HaQNcwpAsLCuy8FCdrU4Br9mftc1" rel="stylesheet"/>

    <link href="/bundles/HomePage/css?v=ynOoK1l9bdh0mihCqMLHcuiuOPQBiHCnFUxGXqucnic1" rel="stylesheet"/>

    <script src="/bundles/HomePage/js-top?v=7gAK1Y_96UgBAeExExE52IkqHlREN8R1u5Nmv12AaqQ1"></script>

    
    <link type="text/css" href="/css/fontsDark.css" rel="stylesheet" />
    
    <style>
        .accFont {
            color: #005373;
        }

        .bgdColorMyActions {
            background-color: #FC601F;
            color: #FFF;
        }

        .ePlusLink {
            font-weight: bold;
            color: #005373;
            text-decoration: none;
        }
        input:checked + .slider  {
            background-color: #005373;
        }
        .analyticsDisplayModesContainer input:checked + .slider  {
            background-color: #ccc;
        }

        .new-look-btn-primary {
            background-color: #005373;
            border-color: #005373;
        }

        .new-look-btn-primary:hover {
            background-color: #005373;
            border-color: #005373;
        }

        .new-look-btn-primary:focus, .new-look-btn-primary.focus {
            box-shadow: 0 0 0 0.2rem rgba(0, 83, 115, 0.5);;
        }

        .new-look-btn-primary.disabled, .new-look-btn-primary:disabled {
            background-color: #005373;
            border-color: #005373;
        }

    </style>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script>
        $.ajaxSetup({ cache: false });
        window.xhrPool = [];
        $(document).ajaxSend(function(e, jqXhr){
            xhrPool.push(jqXhr);
        });
        $(document).ajaxComplete(function(e, jqXhr) {
            xhrPool = $.grep(xhrPool, function(x) {return x != jqXhr});
        });
        google.charts.load('current', {'packages':['corechart']});
        window.cultureName = "en-US"; 
    </script> 

    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBX8tghtCOJDY7649joBwp-X0cupVWPzvs" async defer></script>
    
    <script type="text/javascript">
        var appInsights = window.appInsights || function (config) {
            function i(config) { t[config] = function () { var i = arguments; t.queue.push(function () { t[config].apply(t, i) }) } } var t = { config: config }, u = document, e = window, o = "script", s = "AuthenticatedUserContext", h = "start", c = "stop", l = "Track", a = l + "Event", v = l + "Page", y = u.createElement(o), r, f; y.src = config.url || "https://az416426.vo.msecnd.net/scripts/a/ai.0.js"; u.getElementsByTagName(o)[0].parentNode.appendChild(y); try { t.cookie = u.cookie } catch (p) { } for (t.queue = [], t.version = "1.0", r = ["Event", "Exception", "Metric", "PageView", "Trace", "Dependency"]; r.length;)i("track" + r.pop()); return i("set" + s), i("clear" + s), i(h + a), i(c + a), i(h + v), i(c + v), i("flush"), config.disableExceptionTracking || (r = "onerror", i("_" + r), f = e[r], e[r] = function (config, i, u, e, o) { var s = f && f(config, i, u, e, o); return s !== !0 && t["_" + r](config, i, u, e, o), s }), t
        }({
            instrumentationKey: "92ac9ee8-be43-47c1-ade4-8cd0439eaa82",
            maxAjaxCallsPerView: -1
            
        });

        window.appInsights = appInsights;
        
        if (telemetryFilter) {
            telemetryFilter.startFiltering(appInsights);
        }
        

        appInsights.setAuthenticatedUserContext("", "", storeInCookie = true);
        if (pageTracking) {
            pageTracking.init(appInsights, 300000);
        }
        appInsights.trackPageView();
    </script>
    
</head>
<body>
    <div id="ieBrowserWarning" class="new-look-alert new-look-alert-warning new-look-alert-dismissible textMedium" role="alert"></div>

    <div id="form1" class="overallStyles bodyStyles textMedium">
        <div id="pageBlockDiv" class="blockDivTransparent" style="display: none;"></div>
        
        <div id="pageHeader" style="display: none;">
            
            <a name="backTop"></a>
            
            
<style>
    .twoHeaderBG {
        background: none repeat scroll 0 0 #e9ebec;
    }

    .twoHeader {
        background: none repeat scroll 0 0 white;
        height: 110px;
        font-family: Open Sans;
        min-width: 920px;
        margin: 0 auto;
        padding-top: 8px;
    }

    .twoHeaderListView {
        background: none repeat scroll 0 0 #969ea4;
        font-family: Open Sans;
        max-width: 940px;
        min-width: 620px;
        margin: 0 auto;
    }

    .twoHeaderlogoDiv {
        float: left;
        color: gray;
        padding-left: 20px;
        font-weight: bold;
        font-size: 28px;
        padding-top: 6px;
        font-family: Oxygen;
    }

    .userForm {
        float: right;
        position: relative;
        margin: 0;
    }

    .user_center_nav {
        list-style-type: none;
        margin: 0;
        padding: 0;
        font-size: 10pt;
    }

        .user_center_nav li.user_center_option {
            list-style-type: none;
            float: left;
            /*border-left: 1px solid #d2d6d8;*/
            position: relative;
        }

    .header_arrow_div {
        float: left;
        padding-left: 6px;
        padding-top: 20px;
    }

    .user_center_option {
        list-style-type: none;
        float: left;
        /*border-left: 1px solid #124690;*/
        position: relative;
    }

    .user_center_nav .uc_culture a.popover_trigger {
        font-weight: bold;
    }

    .user_center_nav .uc_help a.popover_trigger {
        font-weight: bold;
    }

    .user_center_nav .uc_user a.popover_trigger {
        padding-top: 0;
        padding-bottom: 0;
    }

    .user_center_nav li a.popover_trigger {
        text-decoration: none;
        padding: 17px;
        display: block;
        color: #666666;
        font-weight: normal;
        font-size: 12px;
        line-height: 16px;
        white-space: nowrap;
        cursor: pointer;
    }

    .user_center_nav li a.popover_trigger {
        position: relative;
    }

    /*.user_center_nav li a.popover_trigger:hover {
            background-color: #666666;
            color: white;
        }*/

    .user_center_popover {
        position: absolute;
        top: 45px;
        z-index: 91002;
        /*display: none;*/
    }

    .uc_top_arrow {
        border-left: 6px solid transparent;
        border-right: 6px solid transparent;
        border-bottom: 6px solid #e9ebec;
        width: 2px;
        position: relative;
        bottom: 0;
    }

    .uc_market .popover_content {
        width: 500px;
    }

    .uc_search .popover_content {
        width: 550px;
        background: none repeat scroll 0 0 #ECECEC;
        background-color: #E5E9ED;
        /*padding: 15px;*/
    }

    .user_center_popover .popover_content {
        background: none repeat scroll 0 0 #e9ebec;
        padding: 0;
    }

    .listview_takeaction {
        background: none repeat scroll 0 0 #e9ebec;
        clear: both;
    }

    .user_center_popover_block {
        z-index: 91000;
        position: fixed;
        background: black;
        opacity: 0.5;
    }

    .user_center_popover_complete_block {
        z-index: 91000;
        position: fixed;
        background: black;
        opacity: 0.4;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
    }

    .market_selection {
        padding: 3px;
        /*width: 630px;*/
        height: 24px;
        vertical-align: middle;
    }

        /*.market_selection:hover {
            background-color: lavender;
        }*/

        .market_selection .inner {
            /*padding-top: 5px;*/
            padding-left: 5px;
        }

    .contentWrapperHeader {
        float: left;
        width: 100%;
        height: 50px;
    }

    .contentColumnHeader {
        margin: 0 250px 0 250px; /*Margins for content column. Should be "0 RightColumnWidth 0 LeftColumnWidth*/
    }

    .rightColumnHeader {
        float: right;
        width: 190px; /*Width of right column*/
        padding-right: 20px;
    }

    .headerPop_menu {
        position: absolute;
        display: none;
        top: 30px;
        z-index: 91002;
        left: 20px;
        right: 20px;
    }

    #mainHelp {
        float: right;
    }

    #mainHelpContent ul {
        margin: 0;
        padding-left: 20px;
    }

        #mainHelpContent ul li a {
            color: #fc601f;
            font-weight: bold;
            text-decoration: none;
        }
</style>
<div class="twoHeaderBG" style="clear: both; position: relative;">
    <div class="twoHeader">
        <div class="twoHeaderContent" style="position: relative; clear: both;">
            <div class="contentWrapperHeader noSelect">
                
                <div class="contentColumnHeader textMedium">
                    <div id="marketChangeSection" style="float: left;" title="Change the market you're viewing and/or your language and currency preference">
                        <div id="marketArrow" class="icon-drop-down-icon iconSVGNoColor selectArrow" style="float: left; font-size: 11px; margin-top: 5px;"></div>
                        <div style="float: left; padding-left: 4px;">
                            <div style="margin-top: 2px;" id="headerMarketCultureTag">
                                
<div class="selectableText headerStandardField" id="marketName">
    US Trade
    
</div>
<div class="headerEditField" style="display:none;" id="marketChange">Change Market, Language and Currency</div>

                            </div>
                        </div>
                    </div>
                    
                    <div style="float: right; padding-right: 10px;" id="registerEdel" title="Login to Edelweiss or register for free">
                        <div style="height: 50px;" onclick="javascript:loginRegisterSaveHash();">
                            <div class="icon-drop-down-icon iconSVGNoColor selectArrow" style="float: left; font-size: 11px; margin-top: 7px; padding-right: 5px;"></div>
                            <div class="textMedium selectableText headerStandardField accFont" style="float: left; padding-right: 4px; padding-top: 5px; font-weight: bold;">Register / Login</div>
                            <div style="clear: both;"></div>
                        </div>
                    </div>
                    
                    <div style="clear: both;"></div>
                </div>
                <div id="topHelp" class="rightColumnHeader" style="position: absolute; top: 2px; right: 3px;">
                    <a id="mainHelp" class="clickable">Help</a>
                    <div id="mainHelpContent" style="display: none">
                        <ul>
                            
                            <li>
                                <a href="#" onclick="javascript:activateEPlusTour(); return false;">Take Edelweiss+ Tour</a>
                            </li>
                            <li>
                                <a href="http://help.edelweiss.plus/" target="_blank">Get Help</a>
                            </li>
                            

                            <li>
                                <a href="#" onclick="javascript:openCustomerFeedback(); return false;">Feedback</a>
                            </li>
                            <li>
                                <a href="http://www.abovethetreeline.com/products/faqs" target="_blank">About Edelweiss+</a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div style="clear: both;"></div>
            </div>
        </div>
        <div style="position: relative; clear: both;">
            <div class="contentWrapperHeader textMedium">
                <div class="leftColumnHeader" style="position: relative;">
                    <div class="twoHeaderlogoDiv" style="cursor: pointer;" onclick="javascript:pageChange('dashboard');">
                        <img style="margin-top: 6px" src="/images/edelweisslogo_RGB.png" />
                    </div>
                </div>
                <div class="contentColumnHeader">
                    <div id="topSearch">
                        
<div id="headerSearchBox" style="height: 30px; padding: 5px; background: white; border: 1px solid silver; margin: 6px;">
    <div class="searchLeft" style="width: 110px; position: relative;">
        <span id="search-option-toggle" class="icon-gear-a dlPrefs"></span>
        <span id="search-left-label">All Titles</span>
    </div>
    <div class="searchMiddle">
        <form id="main-site-search" name="main-search" role="search" onsubmit="return tryKeywordSearch();">
            <input id="searchKeywords" name="keywords" type="search" class="textMedium fColor" placeholder="Search by ISBN; or, keywords from titles, subtitles, contributors, or series" />
        </form>
    </div>
    <div id="mainSearchIcon" style="position: absolute; top: 18px; right: 267px;" class="searchRight icon-search-icon iconSVG" onclick="$('#main-site-search').submit();"></div>
</div>
<script>
    $(function () {
        $('.searchLeft').webuiPopover({
            type: 'async',
            cache: false,
            container: "#pageContent",
            backdrop: true,
            url: '/GetTreelineControl.aspx?controlName=/uc/search/GlobalTitleSearch.ascx',
            placement: 'bottom-right'            
        });
    });
    
    function tryKeywordSearch() {
        if (document.forms["main-search"]["keywords"].value != '') {
            var hash = 'keywordSearch&' + buildUriHash({ 'q': $("#searchKeywords").val() });

            pageChange(hash);

            $("#searchKeywords").blur();
        }
        return false;
    }
    //# sourceURL=Header_Search.ascx
</script>
                    </div>
                </div>
                <div id="advSearch" class="rightColumnHeader" style="position: absolute; top: 18px; right: 3px; cursor: pointer; width: auto;">
                    <div id="advSearchlink" class="column clickable textLarge headerLink header_500" onclick="javascript:pageChange('savedFilters');">Saved Filters</div>
                    <div id="advSearchHelp" class="columnSpaced helpIcon icon-help-icon iconSVGNoColor" style="font-size: 16px; padding-left: 5px; margin-top: 1px;"></div>
                </div>
            </div>
            <div style="clear: both;"></div>
        </div>
    </div>
</div>

<script>
    
    $(function () {
        $('#advSearch').click(function () {
            pageChange('savedFilters');
        });
        $('#smileIcon').click(function () {
            openCustomerFeedback();
        })
        $('#prefsIcon').click(function () {
            openPreferencesWindow('dashboard');
        });
        $('#marketChangeSection').click(function (e) {
            openMarketSelector('session');
        });
        $('#userProfile').click(function () {
            openUserCenter(0);
        });
        $('#notices').click(function () {
            openMessageCenter(0);
        });
        $("#mainHelp").webuiPopover({
            url: "#mainHelpContent",
            container: ".twoHeaderBG",
            width: "300px"
        });
        $("#advSearchHelp").webuiPopover({
            url: "/GetTreelineControl.aspx?controlName=/uc/help/savedFilterHelp.ascx",
            container: ".twoHeaderBG",
            backdrop: true,
            type: 'async',
            cache: false,
            animation:'pop',
            placement: 'bottom-left'
        });
    });

    function goToAnalyticsDashboard(dashType, subDash, initialize) {
        $("#pageURL").val("");
        $("#menuDiv").show();
        $("#pageHeader").show();
        window.scrollTo(0, 0);
        var url = '/uc/listviews/controls/ListView_Progress_Analytics.ascx';

        $('#pageBlockDiv').show();
        $('#mainBlockDiv').show();
        window.scrollTo(0, 0);
        $("#pageContent").append("<div class='inProcessDiv bgdMenu'><div class='inProcessHeader'><div id='progressAnimation' class='column'></div><div class='columnSpaced'>Loading Analytics</div><div style='clear:both;'></div></div><div id='inProcessDetail'><div style='clear: both; overflow: auto; padding: 15px;'><div style='margin-left:15px;'>Prepping</div></div></div></div>");
        $("#progressAnimation").html(templateCache.loadingAnimation({ svgLoaderClass: '' }));
        if (url != "") {
            $.url = "/GetTreelineControl.aspx?controlName=" + url;
            $("#inProcessDetail").load($.url, function () {
                $.url = "/GetTreelineControl.aspx?controlName=/uc/analytics/Analytics_Home.ascx&dashType=" + dashType + "&subDash=" + subDash;
                if (initialize) {
                    $.url += "&init=true";
                }
                $("#interiorPageContent").load($.url);
            });
        }
    }

    /**
     * @description - Reloads site - clears session state, clears front end data
     */
    function logOut() {
        closeModal();
        $("#popover_user").hide();
        $("#menuInterior").html("<div class='menuText'>Logging out...</div>");
        $("#menuInterior").load("/GetTreelineControl.aspx?controlName=/uc/header/two_Header_LogOut.ascx");
    }

    function goSupport() {
        window.location = 'https://internal-support.edelweiss.plus';
    }

    //Open Temporary Help
    function openTempHelp() {
        
        window.open('http://prezi.com/zsx49guh7kyb/?utm_campaign=share&utm_medium=copy&rc=ex0share', '_blank');
        
    }

    function adjustBetaHomePreference(elem) {
        $(window).trigger('interaction', [function () {
            var prefValue = 0;
            if (elem.attr('checked') == "checked") {
                window.betaHome = 1;
                prefValue = 1;
                $("#betaHelp").show();
            } else {
                window.betaHome = 0;
                $("#betaHelp").hide();
            }
            $.getJSON("/getJSONData.aspx?builder=SelectBetaHome", {
                value: prefValue
            }, function () {
                window.location.reload(true);
            });
        }]);
    }

    function backToAdmin() {
        window.location = "/admin/AdminLoginTreelineUser.aspx?source=toadmin&email="
        }
</script>

            
        </div>
        <div id="menuDiv" style="display: none;">
            <div class="menuBG">
                <div id="menuInterior" class="menu">
                    
                    
<style>
    .headerLink {
        text-decoration: none;
        cursor: pointer;
    }

    .headerSpacerRight {
        padding-left: 4px;
        padding-right: 4px;
    }

    .headerSpacerLeft {
        padding-left: 4px;
        padding-right: 4px;
        border-right: 1px solid silver;
    }

    a {
        outline: 0;
    }
</style>
<div class="menuText textLarge noSelect">
    <span><a class='headerLink header_Home overallStyles' href="javascript:pageChange('dashboard');">Home</a></span>
    <span class='headerSpacerLeft'></span><span class='headerSpacerRight'></span>
    <span id="publisherMenu" class='headerLink header_4 overallStyles'>Publishers</span>
    
    <span class='headerSpacerLeft'></span><span class='headerSpacerRight'></span>
    <span class='headerLink h_2 header_2 overallStyles' data-dash="2" onclick="javascript:goToListFromDashboard(2);">Catalogs</span>
    
    <span class='headerSpacerLeft'></span><span class='headerSpacerRight'></span>
    <span class='headerLink h_0 header_0 overallStyles' data-dash="0" onclick="javascript:goToListFromDashboard(0);">Review Copies</span>
    
</div>

<script>
    $(".headerLink").hover(
        function () {
            $(this).addClass("hoverHeader");
        }, function () {
            $(this).removeClass("hoverHeader");
        }
    );

    function goDash() {
        $("#breadCrumb").hide();
        $("#focusContainer").hide();
        $("#interiorPageContent").show();
        $("#pageURL").val("");
        window.scrollTo(0, 0);
        $("#interiorPageContent").html('<div style="height:900px;padding-left:20px;">Loading...</div>');
        $.url = "/GetTreelineControl.aspx?controlName=/uc/dashboard/DashboardFrame.ascx";
        $("#interiorPageContent").load($.url);
    }
</script>

                    
                </div>
            </div>
        </div>
        <div class="bodyStyles">
            <div id="breadCrumb" style="display: none;" class="breadCrumb">
                <div id="breadCrumbContent" style="margin-left: 20px; margin-right: 20px; margin-bottom: 20px; background-color: #E9EBEC; padding-left: 4px; padding-top: 1px; padding-bottom: 1px;"></div>
            </div>
            <div id="pageContent" style="min-height: 100%; position: relative" class="twoContent textMedium overallStyles">
                <div id="mainBlockDiv" class="blockDiv" style="display: none; top: 15px; left: 0; right: 0; bottom: 20px;">
                    <h2 class="blockDivLoading" style="display: none">Loading...</h2>
                </div>
                <div id="interiorPageContent" style="min-height: 600px;"></div>
            </div>
        </div>
        <div class="footerconstraint">
            <div class="menu overallStyles textMedium" style="padding-bottom: 20px;">
                <div style="margin-left: 20px; margin-right: 20px; border-top: 1px solid #D2D6D8;">
                    <div class="copyRight" style="float: left;">© above the treeline 2018</div>
                    <div class="copyRight" style="float: right; cursor: pointer;" onclick="javascript:window.open('http://abovethetreeline.com','_blank');" >About us</div>
                </div>
            </div>
        </div>
        <div id="container-modalWrap" onclick="closeHomepageDialog()">
            <div id="innerContainer-modalWrap">
                <div id="modal">
                </div>
            </div>
        </div>
        <div id="modal-bbyf" class="textMedium overallStyles">
            <div id="innerModalContent"></div>
        </div>
        <div id="inProcessDiv">
        </div>
        <div id="popover_complete_block" class="user_center_popover_complete_block" style="display: none;"></div>
        <div id="popover_disengaged" style="display: none; position: fixed; background-color: white;"></div>
        <input id="pageURL" type="hidden" value="" />
        <input type="hidden" id="scrollpos_top" value="" />
        <input type="hidden" id="popUpControl" value="" />
        <input type="hidden" id="popUpControlParent" value="" />
        <input type="hidden" id="popUpControlDisengaged" value="" />
        <input type="hidden" id="popGoTime" value="0" />

        <input id="referredHash" type="hidden" />

        <input type="hidden" id="selectedResult_2" value="" />
        <input type="hidden" id="resultCount_2" value="" />
        <input type="hidden" id="selectedResult_4" value="" />
        <input type="hidden" id="resultCount_4" value="" />
        <input type="hidden" id="selectedResult_5" value="" />
        <input type="hidden" id="resultCount_5" value="" />
        <input type="hidden" id="selectedResult_0" value="" />
        <input type="hidden" id="resultCount_0" value="" />
        <input type="hidden" id="resultCount_1" value="" />
        <input type="hidden" id="selectedResult_3" value="" />
        <input type="hidden" id="resultCount_3" value="" />
        <input type="hidden" id="selectedResult_6" value="" />
        <input type="hidden" id="resultCount_6" value="" />
        <input type="hidden" id="selectedResult_8" value="" />
        <input type="hidden" id="resultCount_8" value="" />
        <input type="hidden" id="selectedResult_21" value="" />
        <input type="hidden" id="resultCount_21" value="" />
        <input type="hidden" id="selectedResult_20" value="" />
        <input type="hidden" id="resultCount_20" value="" />
        <input type="hidden" id="selectedResult_9" value="" />
        <input type="hidden" id="resultCount_9" value="" />
        <input type="hidden" id="selectedResult_12" value="" />
        <input type="hidden" id="resultCount_12" value="" />
        <input type="hidden" id="selectedResult_50" value="" />
        <input type="hidden" id="resultCount_50" value="" />
    </div>
</body>

<script type="text/javascript" src="/js/ckeditor/4.3.3-full/ckeditor.js"></script>
<script src="/bundles/HomePage/js-bottom?v=Avn2Fo3NNoU_7FKqLjpB5EF3h5zpXpftFeRM2xmh7hQ1"></script>


<script>
    
    window.enum = {"dashParent":{"DASHHOME":50},"dashType":{"DASHDRC":0,"DASHMYREADING":1,"DASHCATALOG":2,"DASHTAG":3,"DASH_PUBLISHER":4,"DASH_PEOPLE":5,"DASH_ORDER":6,"DASH_MARKUPS":7,"DASH_SEARCH":8,"DASHBUZZ":9,"DASHTITLEMODAL":10,"DASHCATALOGTITLES":11,"DASHPUBLICITYCAMPAIGN":12,"DASHORDERTITLES":13,"DASHPUBLISHERCATALOGS":20,"DASHPUBLISHERDRC":21,"DASHPUBLISHERBUZZ":22,"DASHPUBLISHERTAGS":23,"DASHMYEDELWEISS":30,"DASHANALYTICS":40,"DASHREVIEW":50,"DASHORGANIZATIONS":51,"KPI_HOME":100,"KPI_ATRISK":101,"KPI_RECEIVABLES":102,"KPI_PIPELINE":103,"LA_HOME":200,"LA_MOSTPOPULAR":201,"LA_WEEDING":202,"LA_CATEGORYCOMP":203,"EA_CATALOGANALYSIS":204,"EA_NOTYETRELEASED":205,"EA_WORKFLOW":206,"EA_PEERORGSTOCKANALYSIS":207,"EA_PEERBRANCHSTOCKANALYSIS":208,"EA_STOCKANALYSIS":210,"EA_CATEGORYPERFORMANCE":220,"EA_LOCATIONPERFORMANCE":221,"EA_TRENDSANALYSIS":222,"EA_TITLESETSTOCKANALYSIS":225,"EA_WEEDINGANALYSIS":230,"BA_HOME":300,"BA_MOSTPOPULAR":301,"BA_SLOWMOVERS":302,"BA_CATEGORYCOMP":303,"DASHTITLE":400,"DASHSAVEDFILTERS":500,"DASHSPIEGELBESTSELLERS":501,"DASHREQUESTS":502,"DASHNONE":-1},"resultType":{"NONE":0,"TITLETAGALL":2,"TITLE_SHELF_ANTICIPATING":10,"TITLE_SHELF_HIGH_ANTICIPATE":11,"TITLE_SHELF_READING":12,"TITLE_SHELF_FINISHED":13,"TITLE_SHELF_DNF":14,"TITLE_SHELF_FAVORITES":15,"TITLEDRCDOWNLOADSNOREVIEW":17,"TITLEDRCPROCESS_OPEN":18,"TITLEDRCREQUESTALL":19,"TITLEDRCREQUESTABLE":20,"TITLEDRCDOWNLOADABLE":21,"TITLEDRCAVAILABLE":22,"TITLEDRCREQUESTAPPROVED":23,"TITLEDRCREQUESTOPEN":24,"TITLEDRCREQUESTCLOSED":25,"TITLEDRCDOWNLOADS":26,"TITLETAGMINE":27,"TITLETAGORG":28,"TITLETAGPUBLISHER":29,"TITLETAGSHAREDWITHME":30,"TITLE_CATALOG":31,"TITLE_SEARCH":32,"PUBLISHER_MOST_VISITED":33,"PUBLISHER_PRIORITY_A":34,"PUBLISHER_PRIORITY_B":35,"PUBLISHER_PRIORITY_C":36,"PUBLISHER_PRIORITY_D":37,"PUBLISHER_VISIBLE_READERS":38,"TITLE_SEARCH_MINE":39,"PEOPLE_ACTIVITY_FRIENDS":40,"PEOPLE_ACTIVITY_AFFILIATES":41,"PEOPLE_OPENINVITES_INBOUND":42,"PEOPLE_OPENINVITES_OUTBOUND":43,"PEOPLE_ALL_FRIENDS":44,"PEOPLE_ORG_USERS":45,"PEOPLE_CONTACTS_INDIVIDUALS":46,"PEOPLE_CONTACTS_ORGANIZATIONS":47,"PEOPLE_CONTACTS_GROUPS":48,"PEOPLE_SEARCH":49,"ORDER_ACTIVE":50,"ORDER_ARCHIVED":51,"ORDERSEARCH":52,"PEOPLE_ACTIVITY_ORG":53,"PUBLICITYCAMPAIGNOPENUNSUBMITTED":54,"PUBLICITYCAMPAIGNARCHIVED":55,"PUBLICITYCAMPAIGNOPENSUBMITTED":56,"PEOPLE_ACTIVITY_EDELWEISS":57,"PUBLICITYCAMPAIGNPUBSHARED":58,"ORDERS_SHARED_WITH_ME":59,"INTERIOR_ILLUSTRATIONS":60,"CATALOG_SHARED_COLLEAGUES":70,"CATALOG_SHARED_AFFILIATES":71,"CATALOG_SHARED_FRIENDS":72,"CATALOGCOLLECTIONS":73,"CATALOGTAGMINE":74,"CATALOGTAGORG":75,"CATALOGTAGSHAREDWITHME":76,"CATALOGSHAREDWITHUSER":77,"CATALOGCOLLECTIONSSHAREDWITHME":78,"TITLE_ALL_REVIEWS":80,"TITLE_ALL_SHELVES":81,"TITLE_ALL_SOCIAL":82,"CATALOG_FEATURED":90,"PUBLISHERMINE":91,"PUBLISHERINFOPAGES":92,"TITLE_ADVANCEDSEARCH":100,"TITLE_INDIVIDUAL":101,"TITLEORDER":102,"TITLEDRCPUBLISHER":103,"TITLEREVIEWALL":104,"TITLESHELFALL":105,"TITLEBUZZFRIENDS":106,"TITLEBUZZAFFILIATES":107,"TITLEBUZZORG":108,"TITLEPUBLICITYCAMPAIGN":109,"TITLEBUZZHONORS":110,"SPIEGELBESTSELLERS":111,"TITLEDRCPROCESS_PROCESSED":181,"CATALOG_PRIORITY_A":200,"CATALOG_PRIORITY_B":201,"CATALOG_PRIORITY_C":202,"CATALOG_PUBLISHER":203,"CATALOG_WORKLIST":204,"CATALOG_RECENT":205,"CATALOG_BOOKMARKED":206,"CATALOG_SHARED_PUBLISHERS":207,"CATALOG_MYHOUSE":208,"CATALOG_OTHERHOUSES":209,"CATALOG_SEARCH":210,"CATALOGFOLDERS":211,"CATALOGPOPULAR":212,"CATALOGMYSHAREDMARKUPS":213,"CATALOGSPOSTEDINLASTSIXMONTHS":214,"CATALOGSUBSCRIPTIONUPDATES":215,"CATALOG_SHARED_PUBLISHER_SPECIFIC":216,"CATALOG_SHARED_INTERNALLY":217,"TITLEOURDRCS":260,"NOTICESSHAREDMARKUPS":301,"NOTICESFRIENDINVITES":302,"NOTICESMESSAGES":303,"NOTICESSHAREDITEMS":304,"NOTICESRCAPPROVALS":305,"NOTICESRCDECLINES":306,"NOTICESALLNEW":310,"PEOPLE_ALL_AFFILIATES":401,"PEOPLE_REPS":402,"KPI_PUBLISHERSATRISK":500,"KPI_RECEIVABLES":501,"KPI_PIPELINE":502,"BA_MOSTPOPULAR":601,"BA_SLOWMOVERS":602,"BA_CATEGORY_COMPARISON":603,"LA_MOSTPOPULAR":701,"LA_WEEDING":702,"LA_CATEGORY_COMPARISON":703,"EA_CATALOGANALYSIS":704,"EA_NOTYETRELEASED":705,"EA_WORKFLOW":706,"EA_PEERORGSTOCKANALYSIS":707,"EA_PEERBRANCHSTOCKANALYSIS":708,"EA_STOCKANALYSIS":710,"EA_CATEGORYPERFORMANCE":720,"EA_LOCATIONPERFORMANCE":721,"EA_TRENDSANALYSIS":722,"EA_TITLESETSTOCKANALYSIS":725,"EA_WEEDINGANALYSIS":730,"PRECACHE_PUBLISHERFRONTLIST":1000,"PRECACHE_POPULARCATALOGS":1001,"PRECACHE_CATALOGID":1002,"TITLEBUZZFEEDFRIENDS":1106,"TITLEBUZZFEEDAFFILIATES":1107,"TITLEBUZZFEEDORG":1108,"REVIEW_MINE":2000,"REVIEW_FRIEND":2001,"REVIEW_AFFILIATES":2002,"REVIEW_ACCOUNT":2003,"REVIEW_CUSTOM":2004,"REVIEW_SUBMITTEDTOMYHOUSE":2005,"REVIEW_SUBMITTEDTOMYHOUSEANDINMYACCOUNTS":2006,"TITLEREVIEW_CONTACT":2007,"TITLEDOWNLOAD_CONTACT":2008,"TITLEREQUEST_CONTACT":2009,"SAVEDFILTERS":2010,"SHELFSUMMARY":2011,"REQUESTSUMMARY":2012,"DOWNLOADSUMMARY":2013,"TITLEGALLEYREQUEST":2100,"PUBLISHER":3000,"SUPPORTNPS":4000,"SUPPORTUSERLOGIN":4001,"SUPPORTRECEIVABLES":4002,"SUPPORTLONGLOADTIMES":4003,"SUPPORTRECURRINGSUBSCRIPTIONS":4004,"SUPPORTACCOUNTS":4005,"SUPPORTNPSDETAIL":4006,"SUPPORTNEWUSERS":4007,"SUPPORTNOTES":4008,"SUPPORTANALYTICFRESHNESS":4009,"PUBLISHERRECENTVIEW":5800,"PUBLICITYCAMPAIGNPUBNOTSHARED":5900,"CATALOG_ALL":-1},"itemType":{"CATALOG":0,"TITLE":1,"PUBLISHER":2,"PEOPLE":3,"ORDER":4,"INTERIORS":5,"CONTACT":6,"CONTACTORGANIZATION":7,"CONTACTGROUP":8,"MARKUP":9,"TITLEPRESENTATION":10,"TITLEMINE":11,"PUBLICITYCAMPAIGN":12,"ORGANIZATION":20,"GRIDRESULTS":30,"ORDEREXPORTGRID":40,"REVIEW":50,"REQUESTBYUSER":51,"REQUEST":52,"NOTICES":60,"SAVEDFILTERS":70,"SHELVES":80,"TAGS":90,"RESULTTYPESUMMARY":100,"FOLDERS":110,"BUZZ":120,"BUZZFEED":121,"TITLEFULL":130,"NPSFEEDBACK":140,"PERFORMANCEANALYSIS":220},"listType":{"THUMBSCROLL":0,"LISTVIEW":1,"SINGLEFOCUS":2,"GRIDVIEW":3,"EXPORTPREVIEW":4,"DETAILTHUMB":5,"THUMBGRID":6,"TWOCOLUMN":7,"LEGACY":8,"ANALYTICS_ISBNVIEW":11,"ANALYTICS_FAMILYVIEW":12,"ANALYSISOFTITLESET":15,"LISTTYPENONE":-1},"thumbType":{"TITLE":0,"CATALOG":1},"displayMode":{"UNKNOWN":0,"LISTVIEW":1,"SKUMODAL":10},"filterType":{"PUBLISHER":0,"CATEGORY":1,"FORMAT":2,"PUBDATE":3,"PUBTYPE":4,"AUTHOR":5,"IMPRINT":6,"CATEGORIES":7,"THEMA":8,"PRICERANGE":9,"DRCAVAILABILITY":10,"THEMASUBJECTQUALIFIER":11,"ORDERS":20,"PERSON":30,"TAG":40,"MYTAG":41,"COLLEAGUETAG":42,"MARKUPSHAREDTAG":43,"MARKUPTAG":44,"ALLACCOUNTTAG":45,"TITLE":46,"IMPRINTMULTI":47,"AFFILIATIONMULTI":48,"ACCOUNT":50,"HONORS":51,"ACTIVITY":60,"ISACTIVE":61,"DISCOUNT":70,"SUGGESTIONS":80,"PUBSUGGESTIONS":81,"PUBORDERS":90,"STOCKED":100,"PRIORITY":110,"PRIORITYSHARED":111,"DUEDATE":120,"PERSONALREVIEWS":125,"PEERREVIEWS":126,"PEERSHELVES":127,"SUBMITSTATUS":130,"NOTES":135,"MARKUPNOTES":136,"MARKUPSHAREDNOTES":137,"ACCOUNTNOTES":138,"UPDATEDDATE":140,"EVENTREQUESTED":145,"CREATEDDATE":150,"APPOINTMENTDATE":151,"DATEADDED":152,"BOUNDVENDOR":160,"CATALOGSUBSCRIPTIONUPDATE":200,"CATALOGTYPE":201,"SUBMITTEDTOPUBLISHER":250,"PUBLISHERSUBMISSIONDATE":251,"SUBMITTEDTOINDIENEXT":260,"INDIENEXTSUBMISSIONDATE":261,"SUBMITTEDTOLIBRARYREADS":270,"LIBRARYREADSSUBMISSIONDATE":271,"SUBMITTEDTOSIBA":280,"SIBASUBMISSIONDATE":281,"TEXTREVIEW":300,"VIEWED":400,"CONFIDENCE":500,"USERTYPE":501,"SINGLETITLE":510,"STATUS":511,"CITY":600,"STATE":601,"POSTALCODE":602,"GROUPNAMES":700,"ISEDELWEISSUSER":800,"ISEDELWEISSFRIEND":801,"ISEDELWEISSACCOUNT":802,"HASDRCREQUESTS":900,"HASDRCDOWNLOADS":901,"HASREVIEWS":950,"HASEVENTGRIDACCESS":951,"SAVEDFILTER":1000},"exportType":{"UNKNOWN":0,"SQUAREONE":1,"ROSI":2,"ANTHOLOGY":3,"IMERCHANT":4,"BOOKLOG":5,"IPAGE":6,"BOOKSTOREMANAGER":7,"WORDSTOCK":8,"IBID":9,"CUSTOM":10,"WORDSTOCKEXPORT":11,"BOOKSCAPE":12,"IRT":13,"UOW":14,"ATHENA":15,"ORDERFORM":16,"HARPERCOLLINSJDEDWARDS":17,"NOLOACUMENREQUEST":18,"BASIL":19,"IPAGESPLIT":20,"RANDOMHOUSEORDER":21,"NORTONORDER":22,"BARNESANDNOBLE":23,"SCHOLASTIC":24,"READERORDERFORM":25,"ANTHOLOGY_2":26,"SCHOLASTICORDER":27,"HACHETTEORDER":28,"BOOKMANAGER":29,"BAKERANDTAYLOR":30,"WORKMAN":31,"RANDOMHOUSEORDERV2":32,"BOOKHIT":33,"LIBRI_WWS":34,"ZEUSS":35,"FOURBIT":36,"OCTOPUS":37,"HARLEQUIN":38,"KNVFITBIS":39,"KNVEUROBIS":40,"BWA":41,"HARPERUK":42,"BPM":43,"KNOVA":44,"BERTLINEMANUALORDER":45,"ANALYSISREPORT":46,"MACMILLANORDER":47,"BARCODEORDER":48,"BERTLINE":55},"exportTypes":{"EMAIL":1,"PRINT":2,"PDF":3,"WORD":4,"POWERPOINT":5,"SPREADSHEET":6,"ORDERFORM":7,"SOCIALMEDIA":8},"relationshipDirection":{"UNKNOWN":0,"OUTBOUND":1,"INBOUND":2,"BOTH":3},"userAdminArea":{"MAINPROFILE":0,"FRIENDS":1,"AFFILIATES":2,"COLLEAGUES":3,"CONTACTS":5,"INBOUNDINVITES":10,"OUTBOUNDINVITES":11,"ADDFRIENDS":12,"PUBLISHERCONTACTS":20,"ADMINISTRATION":30},"entityType":{"UNKNOWN":0,"CATALOG":1,"PRODUCT":2,"USER":3,"ORGANIZATION":4,"OUTLET":5,"SERVICE":6,"ADDRESS":7,"ORDER":8,"MAILING":9,"COLLECTION":10,"PUBLICITYCAMPAIGN":11,"REVIEW":20,"NOTE":25,"GROUP":30,"TAGCATALOG":40,"TAGTITLE":41,"TITLE":100,"APPLICATION":1000},"requiredPerformanceActivity":{"NONE":0,"CIRCULATION":1,"INVENTORY":2,"TURN":3}};

    // Prevent changes to enumerations
    Object.freeze(window.enum);
    
    Object.freeze(window.enum.dashParent);
    
    Object.freeze(window.enum.dashType);
    
    Object.freeze(window.enum.resultType);
    
    Object.freeze(window.enum.itemType);
    
    Object.freeze(window.enum.listType);
    
    Object.freeze(window.enum.thumbType);
    
    Object.freeze(window.enum.displayMode);
    
    Object.freeze(window.enum.filterType);
    
    Object.freeze(window.enum.exportType);
    
    Object.freeze(window.enum.exportTypes);
    
    Object.freeze(window.enum.relationshipDirection);
    
    Object.freeze(window.enum.userAdminArea);
    
    Object.freeze(window.enum.entityType);
    
    Object.freeze(window.enum.requiredPerformanceActivity);
    
</script>

<script type="text/javascript">
    window.loadingText = 'Loading';
    window.keywordSearch = null;

    window.cultureName = 'en-US';
    window.dashboardView = null;
    if(!window.activeSortList) {
        window.activeSortList = {};
    }
    window.quickTagAutoComplete = '';
    window.quickCatalogTagAutoComplete = '';

    //Populate Javascript Enum Variables
    populateDashTypes();
    populateUserPrefTypes();
    populateUserPrefNames();

    lightbox.option({
        'resizeDuration': 500,
        'wrapAround': true,
        'imageScrollWithPage': true
    });

    if (!Modernizr.promises) {
        ES6Promise.polyfill();
    }

    var res = {"access_message_1":"access_message_1","access_message_2":"access_message_2","activity_calculation_note":"Index calculated as (Copies On Hand) X (Days Since Last Activity)","add":"Add","add_access":"add_access","add_address":"Add Address","add_category":"Add Category","add_export_record":"Add Export Record","add_item_record":"Add Item Record","add_line_item":"Add Line Item","add_tags_dialog":"Add Tags","add_to_collection":"Add to Collection","all_titles":"All Titles","anticipating":"Anticipating","autosave_confirm":"The AutoSave feature will automatically save your changes as you make them on the page. This feature works best with a fast Internet connection and an updated web browser. Click 'OK' if you are sure you want to enable the AutoSave feature.","backlist":"Backlist","by_activity":"By Activity","by_turn":"By Turn","cancel":"Cancel","changes_saved":"Changes Saved","checked":"Checked","clear":"Clear","clearing_overrides":"Clearing all overrides.  Please wait...","clearing_overrides_error":"An error occurred while clearing overrides.","clearing_overrides_none_applied":"There are no overrides applied to this item.","click_to_add_category":"Click to add category","click_to_change_category":"click_to_change_category","click_to_clear_checked_items":"click_to_clear_checked_items","click_to_close":"Click to close","click_to_edit_review":"Click to edit review","click_to_see_review":"Click to see review","close":"Close","comments":"Comments","comments_access_message":"To access comments you must have at least one person in your friend list","confirm_close_review":"confirm_close_review","confirm_org_delete_admin":"confirm_org_delete_admin","confirm_review_delete":"Are you sure you want to delete this review?","confirm_unsubmit_review":"Are you sure you want to unsubmit this review?","confirm_user_delete_admin":"confirm_user_delete_admin","confirm_user_deletion_admin":"confirm_user_deletion_admin","contact_us":"Contact Us","content_edited":"Content Edited","contributors_plural":"contributors","convert":"Convert","convert_isbns":"Convert ISBNs","create_mailing":"create_mailing","create_markup":"Create Markup","create_new_org_admin":"create_new_org_admin","create_order":"Create Order","currently_reading":"Currently Reading","customer_feedback":"Customer Feedback","delete_address":"Delete Address","delete_address_prompt":"Are you sure you want to delete the address {0}?","descContributorBio_plural":"contributor bios","descSummary_plural":"summaries","do_you_want_to_edit_the_collection":"Do you want to edit the collection","download_review_copy":"Download Review Copy","edit_address":"Edit Address","edit_attributes":"edit_attributes","edit_export_record":"Edit Export Record","edit_markup":"Edit Markup","edit_order":"Edit Order","edit_page_numbers":"edit_page_numbers","edit_suggestions":"Edit Suggestions","enter_new_email_admin":"enter_new_email_admin","error":"Error","error_clearing_exclusions_for_lane":"There was an error when trying to clear the exclusions for this lane.","error_excluding_items":"There was an error when trying to exclude these items.","error_excluding_title":"There was an error when trying to exclude this title.","error_fatal":"An unexpected error occurred while performing this action.  Please contact Above The Treeline Support to report this issue.","error_fatal_reload":"An unexpected error occurred while performing this action. Please contact Above The Treeline Support to report this issue.  The page will now reload.","error_logging_out":"Error logging out","error_markup_editor_open":"Another markup note is currently being edited.  Please save or close the current note being edited, then try again.","error_saving_preference":"There was an error saving your AutoSave preference.  Your previous setting will remain in effect.","error_unexpected":"An unexpected error occurred while performing this action. Please try again or contact Above The Treeline Support.","export_markup":"Export Markup","export_markup_prompt":"Do you want to export markup notes with formatting?","featured_peer_reviews":"Featured Peer Reviews","feedback":"feedback","filter":"Filter","finished_reading":"Finished Reading","fresh":"Fresh","frontlist":"Frontlist","general_pub_subrights_info":"General Publisher Subrights Information","high":"High","high_turn":"High Turn","highly_anticipating":"Highly Anticipating","indicate_recommendation":"You must indicate whether you'd recommend this title or not.","indicate_role":"Please indicate what type of role you're reviewing this title as.","indicate_roll":"indicate_roll","internal":"Internal","invalid_email_alert_admin":"invalid_email_alert_admin","invalid_value":"Invalid value","item":"Item","items":"Items","less":"Less","loading":"Loading","low":"Low","low_turn":"Low Turn","manage_comparable_products":"Manage Comparable Products","markup_editor_close_warning":"Performing this action will close the current markup note editor.  Any unsaved changes will be lost.","markup_note":"Markup Note","medium":"Medium","medium_turn":"Medium Turn","message_error":"There was an error saving your message.","message_saved":"Message saved.","more":"More","move":"Move","move_item":"Move Item","much_love":"Much Love!","must_select_one_or_more":"You must select one or more items","my_backlist":"My Backlist","my_frontlist":"My Frontlist","my_titles":"My Titles","my_work":"My Work","network_connection":"Network Connection","never_owned":"Never Owned","never_stocked":"Never Stocked","no":"No","no_circulation":"No Circulation","no_filter":"No Filter","no_message":"No message was provided","no_sales":"No Sales","not_in_stock":"Not In Stock","not_owned":"Not Owned","not_set":"Not Set","note":"Note","notes_visible_to_org":"Notes that you add here are visible to other users in your account","notes_visible_to_org_and_reps":"Notes that you add here are visible to your reps and to other users in your account","nothing_to_save":"There was nothing to save","on_order":"On Order","order_alert_mark_complete":"Please consider marking this order as Completed to remove it from your Active Order list.   If you want to order other items please create a new order.","order_alert_summited_a":"WARNING: This order has already been submitted.","order_alert_summited_b":"Changes made to this order will not be updated in your account's order management system.","order_alert_summited_rep_a":"WARNING: This order has already been submitted by your rep.","order_alert_summited_rep_b":"Changes made to this order will not be updated in the publisher's order management system.","order_alert_summited_rep_c":"If you need to change this order, please notify your rep.","ordered":"Ordered","orders_suggestions":"orders_suggestions","please_provide_a_name_for_group":"please_provide_a_name_for_group","please_select_an_item_to_move":"Please select an item to move","promo_signup":"Promotional Signup","pub_date":"Pub Date","pub_message":"Publisher Message","rating_saved":"Rating successfully saved.","refreshing":"Refreshing...","remove":"Remove","remove_access":"remove_access","remove_line":"remove_line","requested_quantity":"Requested Quantity","reset":"Reset","review_deleted_OK":"Review successfully deleted.","reviews":"Reviews","sales_rights":"Sales Rights","save":"Save","save_changes":"Save Changes","saving":"Saving","saving_user_error_admin":"saving_user_error_admin","search_by_isbn":"Search by ISBN","search_only_my_publishers_by_isbn":"Search only my publishers by ISBN","search_only_my_titles_by_isbn":"Search only my titles by ISBN","select_at_least_one_title":"Please select at least one title","select_state":"Select State","select_your_language_preference":"Select your language preference","selected":"Selected","semicolon_or_comma_keywords_from":"; or, keywords from","send":"Send","series_plural":"series","set_default_address":"Set Default Address","set_default_address_prompt":"Are you sure you want to make {0} your default address?","shared":"Shared","shelves":"Shelves","show_all_x":"Show All {totaltitles}","sign_up_request_processing":"New User Account Request","speed":"speed","stable":"Stable","stale":"Stale","submit":"Submit","submitted_on":"Submitted on","subscribe":"Subscribe","subtitle_plural":"subtitles","success":"Success","switch_edit_to_save":"You must switch to 'Your Edit' to save.","thank_you_we_may_contact_you_with_questions":"Thank you! We may contact you if we have questions.","timeout":"Timeout","title":"Title","title_plural":"titles","titles":"Titles","turn_calculation_note_for_library":"Turn is calculated as number of items circulated, over the average items owned during the time frame, annualized","turn_calculation_note_for_retailer":"Turn is calculated as gross sales over average inventory value for the time frame, annualized","unsubscribe":"Unsubscribe","upload_complete":"Upload Complete","user_agreement":"User Agreement","user_details_admin":"user_details_admin","value_must_be_greater_than_0":"The value must be a whole number greater than or equal to 0.","value_must_be_greater_than_1":"The value must be a whole number greater than or equal to 1.","view_online_review_copy":"View Online Review Copy","we_are_always_trying_to_improve_gaps_in_family_data_your_report_helps_quality":"We're always trying to improve the connections between different versions of books and other materials (the 'family' for a title). Gaps in that family database are often the reason that a title is shown in analytics as not owned. Your report helps the quality of that data for everyone using Edelweiss Analytics.","word_of":"of","word_or":"or","x_of_y_titles":"{stockonlytitles} Of {totaltitles} Titles","x_selected":"{numSelected} Selected","x_selected_y_label":"{numSelected} Selected ( {classLabel} )","x_titles_total":"{totaltitles} Titles","yes":"Yes","you_approved_more_than_requested_are_you_sure":"You approved more than the user requested. Are you sure?","your_note":"Your Note"};

    ePlus.user.culture = 'en-US';
    ePlus.modules.paymentControl.setDefaults({
        paymentPluginUri: 'https://payments.edelweiss.plus/Payments/Plugin',
    });
    
    
    CKEDITOR.timestamp = "636566137108687725";

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-6177030-3', 'auto');
    ga('require', 'displayfeatures');
    ga('require', 'linkid');
    ga('set', '&uid', ':');
    ga('send', 'pageview');

    window.isTouch = !!('ontouchstart' in window || navigator.maxTouchPoints || navigator.msMaxTouchPoints);
    window.tourStarted = false;
    window.dashboardExclusionFilters = {};
    window.ePlusContextResultTypesMap = {"98875":[22,21,20,260],"116400":[106,107,108],"116423":[2001,2002,2003,2006],"98968":[73,211,213,212,77,74,75,76,-1,206,90,208,209,200,201,202,203,205,210,71,70,72,207,204,217]};
    window.ePlusContextEntityTypeMap = {"98875":2,"99615":2,"99616":2,"116400":2,"116423":2,"98968":1};

    ePlus.user.initializePreferences({"markup":{"noteFontColor":null,"noteFontSize":null,"useInlineEditor":null},"display":{"showFullMarkupNotes":null},"fonts":{"fontOption":null}});

    $(window).on({
        hashchange: onHashChangeEvent,
        interaction: onInteractionEvent,
        scroll: onScrollEvent,
        resize: resizeThings
    });
   
    createPublisherSelectMenu();

    function reloadCurrentPage() {
        changePage(window.location.hash);
    }

    function pageChange(pageHash, callback) {
        // Trigger a page interaction event
        $(window).trigger('interaction', [function () {
            location.hash = pageHash;

            if (typeof callback === 'function') {
                location.hashCallback = callback;
            }
        }]);
    }

    function changePage(pageHash, callback) {
        pageTracking.startTrackPage();
        
        // Trigger a page interaction event
        $(window).trigger('interaction', [function () {
            clearPageState();

            var pageHashParameters = pageHash.split("&");
            var pageHashPrimary = pageHashParameters[0].split("=");
            if (pageHash === "" || pageHash === "#" ||
                pageHashPrimary[0] === "#Login" || pageHashPrimary[0] === "#SignUp" || pageHashPrimary[0] === "#ForgotPassword") {
                goToWelcomePage();
            } else {
                $("#menuDiv").show();
                $("#pageHeader").show();
                if (_.startsWith(pageHash, "#dashboard")) {
                    $(".header_Home").addClass("selectedTopMenu");
                    closeLeftNav();
                    window.goToDashboard();
                }

                if (pageHashPrimary[0] === "#InviteResponse") {
                    var actionType = pageHashParameters[1].split("=")[1];

                    if (actionType === "view") {
                        location.hash = "dashboard";
                        openUserCenter(0);
                    } else {
                        openInviteConfirmation(pageHash.replace("#", "&"));
                    }
                }
                if (pageHashPrimary[0] === "#SignUpRequest") {
                    openSignUpRequestProcessing(pageHash.replace("#", "&"));
                }
                if (pageHashPrimary[0] == "#analytics") {
                    $(".header_" + pageHashPrimary[1]).addClass("selectedTopMenu");
                    var pageHashSecondary = pageHashParameters[1].split("=");
                    window.goToAnalyticsDashboard(pageHashPrimary[1], pageHashSecondary[1], true);
                    closeLeftNav();
                }
                if (pageHashPrimary[0] == "#org") {
                    window.loadInProcessDiv('Account', '/uc/listviews/controls/ListView_Progress_List.ascx&itemType=2&' + pageHash.replace("#", ""));
                }
                if (pageHashPrimary[0] == "#sku") {
                    var url = '/GetTreelineControl.aspx?controlName=/uc/listviews/ListHome.ascx&majorPage=6&' + pageHash.replace("#", "");
                    $("#interiorPageContent").load(url, callback);
                };
                if (pageHashPrimary[0] == "#catalogID") {
                    var url = '/GetTreelineControl.aspx?controlName=/uc/listviews/ListHome.ascx&majorPage=2&' + pageHash.replace("#", "");
                    $("#interiorPageContent").load(url, callback);
                };
                if (pageHashPrimary[0] == "#campaignCatalogID") {
                    var url = '/GetTreelineControl.aspx?controlName=/uc/listviews/ListHome.ascx&majorPage=8&' + pageHash.replace("#", "");
                    $("#interiorPageContent").load(url, callback);
                }
                if (pageHashPrimary[0] == "#orderID") {
                    var url = '/GetTreelineControl.aspx?controlName=/uc/listviews/ListHome.ascx&majorPage=4&' + pageHash.replace("#", "");
                    $("#interiorPageContent").load(url, callback);
                };
                if (pageHashPrimary[0] == "#viewID") {
                    window.loadInProcessDiv('Titles', '/uc/listviews/controls/ListView_Progress_List.ascx&itemType=1&resultType=100&' + pageHash.replace("#", ""));
                };
                if (pageHashPrimary[0] == "#presentationID") {
                    window.loadInProcessDiv('Titles', '/uc/listviews/controls/ListView_Progress_List.ascx&itemType=10&resultType=31&' + pageHash.replace("#", ""));
                };
                if (pageHashPrimary[0] == "#savedFilters") {
                    $(".header_" + window.dashType.filters).addClass("selectedTopMenu");
                    var url = '/GetTreelineControl.aspx?controlName=/uc/listviews/ListHome.ascx&majorPage=7&' + pageHash.replace("#", "");
                    $("#interiorPageContent").load(url, callback);
                };
                if (pageHashPrimary[0] == "#publisher") {
                    var url = '/GetTreelineControl.aspx?controlName=/uc/listviews/ListHome.ascx&majorPage=5&' + pageHash.replace("#", "");
                    $("#interiorPageContent").load(url, callback);
                };
                if (pageHashPrimary[0] == "#keywordSearch") {
                    var keywords = getUriHashParameter(window.location.hash, 'q'),
                        url = '/GetTreelineControl.aspx?controlName=/uc/listviews/ListHome.ascx&majorPage=3&keywordString=' + encodeURIComponent(keywords) + '&' + pageHash.replace("#", "");

                    $('#searchKeywords').val(keywords);
                    $("#interiorPageContent").load(url, callback);
                };
                if (pageHashPrimary[0] == "#dashList") {
                    $(".header_" + pageHashPrimary[1]).addClass("selectedTopMenu");

                    var resultType = ""
                    if (pageHashParameters.length > 1 && pageHashParameters[1].split("=")[0] == "rT") {
                        resultType = pageHashParameters[1].split("=")[1];
                        history.replaceState(null, null, document.location.pathname + '#dashList=' + pageHashPrimary[1]);
                    } else {
                        resultType = $("#selectedResult_" + pageHashPrimary[1]).val();
                    }
                    var itemCount = $("#resultCount_" + pageHashPrimary[1]).val();
                    var url = '/GetTreelineControl.aspx?controlName=/uc/listviews/ListHome.ascx&majorPage=1&resultType=' + resultType + '&itemCount=' + itemCount + '&' + pageHash.replace("#", "");
                    $("#interiorPageContent").load(url, callback);
                }

                if (pageHashPrimary[0] == "#drcRequest") {
                    var action = pageHashPrimary.length > 1 ? pageHashPrimary[1] : null;
                    var requestId = getHashValue("requestId");
                    var userId = getHashValue("userId");
                    var sku = getHashValue("sku");
                    if (action && requestId && userId && sku) {
                        openDrcQuickApprove(action, requestId, userId, sku);
                    } else {
                        alert("Invalid DRC Request Status Admin URL.");
                        pageChange("#dashboard");
                    }
                }
            }
        }]);
    }

    $(function () {
        initJsModules();
        if (location.hash === "") {
            
            goToWelcomePage();
            
        } else {
            
            var pageHashParameters = location.hash.split("&");
            var pageHashPrimary = pageHashParameters[0].split("=");
            if (pageHashPrimary[0] == "#t") {
                goToWelcomePage();
            } else {
                changePage(location.hash);
            }
            
        }
        initCustomDataTableFilters();
        checkForAlerts();
    });

    function initJsModules() {
        if (templateCache) templateCache.init("Hidden");
        o.init(false, "Edit Category",
            "You cannot have quantities less than -1 in your orders.", "You must select or create a purchase order before adding titles to one","Delete Store Line Item",
            "Are you sure you want to delete this line item?", false);
    }

    function checkForAlerts() {
        checkForBrowserAlerts();
    }

    function populateDashTypes() {
        window.dashType = {
            drc: 0,
            shelves: 1,
            catalog: 2,
            catalog_titles: 11,
            order: 6,
            order_titles: 13,
            tag: 3,
            buzz: 9,
            people: 5,
            publisher: 4,
            search: 8,
            event: 12,
            review: 50,
            filters: 500,
            analytics_BA_Home: 300,
            analytics_LA_Home: 200,
            analytics_KPI_Home: 100
        };
    }

    function populateUserPrefTypes() {
        window.userPrefType = {
            display: 'display'
        };
    }

    function populateUserPrefNames() {
        window.userPrefName = {
            showAllMarkups: 'showAllMarkups',
            showAllSuggestions: 'showAllSuggestions',
            showMarkupArea: 'showMarkupArea',
            showOrderArea: 'showOrderArea',
            showForecast: 'showForecast',
            showFullMarkupNotes: 'showFullMarkupNotes'
        };
    }
    function checkForBrowserAlerts() {
        var isIeTenOrLess = navigator.userAgent.match(/MSIE/ig);
        if (isIeTenOrLess) {
            initIeBrowserWarning();
        } 
        
        
    }

    function initIeBrowserWarning() {
        $("#ieBrowserWarning").html("<div class=\"alert-content\">\r\n            <p class=\"alert-content-message\"><span class=\"new-look-alert-header\">Incompatible Browser:</span> Edelweiss+ functionality may not work with Internet Explorer Versions 10 or below. Please switch to <a class=\"alert-link\" href=\"https://www.microsoft.com/en-us/windows/microsoft-edge\">Microsoft Edge</a>, <a href=\"https://www.mozilla.org/en-US/firefox/products/\" class=\"alert-link\">Mozilla Firefox</a>, or <a href=\"https://www.google.com/chrome/\" class=\"alert-link\">Google Chrome</a>.</p>\r\n            <a href=\"#\" class=\"close alert-link\" aria-label=\"close\">×").fadeToggle("slow", "linear");
        initAlertCloseEvent("ieBrowserWarning");
    }

    function initIe11UpgradeBrowserAlert() {
        var alertId = "ie11_upgrade_browser_alert";
        var Ie11AlertClose = function() {
            var dateString = "3/20/2018 3:58:34 AM";
            var viewCount = 0 + 1;
            var dateViewCountString = dateString + "_" + viewCount;
            savePreference("display", "ie11UpgradeAlert", dateViewCountString);
        };
        $('body').prepend(templateCache.dismissableWarningAlert(
            {
                id: alertId, 
                message: 'For a faster Edelweiss+ experience, please consider upgrading to <a class="alert-link" href="https://www.google.com/chrome/browser/desktop/index.html" target="_blank">Google Chrome</a>. If you\'re required to use Microsoft products, please use the latest version of <a class="alert-link" href="https://www.microsoft.com/en-us/windows/microsoft-edge" target="_blank">Microsoft Edge</a>.'
            }
        ));
        $("#ie11_upgrade_browser_alert").fadeToggle("slow", "linear");
        initAlertCloseEvent(alertId, Ie11AlertClose);
    }

    function initAlertCloseEvent(id, closeCallback) {
        $("#" + id + " .close").click(function(event) {
            event.preventDefault();
            $("#" + id).fadeToggle("slow", "linear");
            if (typeof closeCallback === "function") {
                closeCallback();
            }
        });
    }

    function goToDashboard() {
        $("#pageURL").val("");
        $("#menuDiv").show();
        $("#pageHeader").show();
        window.scrollTo(0, 0);
        if (window.betaHome == 1) {
            window.loadDashSplit();
        } else {
            var url = '/uc/listviews/controls/ListView_Progress_Dash.ascx';
            loadInProcessDiv('Dashboard', url);
        }
    }

    function actionWelcome() {
        var hashed = location.hash;
        $("#referredHash").val(hashed);
        closeModal();
        goToWelcomePage();
    }

    function openInviteConfirmation(pageHash) {
        $.url = '/GetTreelineControl.aspx?controlName=/uc/contacts/InviteResponse.ascx' + pageHash;
        $("#interiorPageContent").load($.url);
    }

    function openSignUpRequestProcessing(pageHash) {
        var url = '/GetTreelineControl.aspx?controlName=/uc/contacts/SignUpRequestResponse.ascx' + pageHash;
        openDialog({
            url: url,
            isModal: true,
            title: getRes("sign_up_request_processing"),
            onClose: function () {
                pageChange("#dashboard");
            }
        });
    }

    function goToWelcomePage() {
        $("#menuDiv").hide();
        $("#pageHeader").hide();
        $("#pageURL").val("");
        window.scrollTo(0, 0);
        $("#interiorPageContent").html('<div style="height:900px; font-weight: bold; margin: 8px 0 0 12px;">Loading...</div>');
        var additionalParams = "";
        if (_.startsWith(location.hash, "#Login")) {
            additionalParams = "&start=login";
        } else if (_.startsWith(location.hash, "#SignUp")) {
            additionalParams = "&start=register";
        } else if (_.startsWith(location.hash, "#ForgotPassword")) {
            additionalParams = "&start=login&step=forgotpassword";
        }
        $.url = "/GetTreelineControl.aspx?controlName=/uc/welcome/Welcome.ascx" + additionalParams;
        $("#interiorPageContent").load($.url);
        if (location.hash !== "") {
            var pageHashParameters = location.hash.split("&");

            var pageHashPrimary = pageHashParameters[0].split("=");
            if (pageHashPrimary[0] === "#t") {
                var pageHashSecondary = pageHashParameters[1].split("=");
                var pageHashTertiary = pageHashParameters[2].split("=");
                openSetPassword(pageHashSecondary[1], pageHashPrimary[1], pageHashTertiary[1]);
            }
        }
    }

    function refreshMenuDashboard(resultType, dashboardType, itemID) {
        var uri = "/GetTreelineControl.aspx?controlName=/uc/menus/Menu_Dashboard.ascx";
        if (resultType !== undefined) {
            uri += "&resultType=" + resultType;
        }
        if (dashboardType !== undefined) {
            uri += "&dashboardType=" + dashboardType;
        }
        if (itemID !== undefined) {
            uri += "&itemID=" + itemID;
        }
        $("#menuInterior").load(uri, function() {
            $(".headerLink").css("font-weight", "");
            $(".header_" + dashboardType).css("font-weight", "700");
            createPublisherSelectMenu();
        });
    }

    function loadInProcessDiv(whatsLoading, url) {
        $('#pageBlockDiv').show();
        $('#mainBlockDiv').show();
        window.scrollTo(0, 0);
        $("#pageContent").append("<div class='inProcessDiv bgdMenu'><div class='inProcessHeader'><div id='progressAnimation' class='column'></div><div class='columnSpaced'>Loading " + whatsLoading + "</div><div style='clear:both;'></div></div><div id='inProcessDetail'><div style='clear: both; overflow: auto; padding: 15px;'><div style='margin-left:15px;'>Prepping</div></div></div></div>");
        $("#progressAnimation").html(templateCache.loadingAnimation({ svgLoaderClass: '' }));
        if (url != "") {
            $.url = "/GetTreelineControl.aspx?controlName=" + url;
            $("#inProcessDetail").load($.url, function () {
                if (whatsLoading == 'Dashboard') {
                    if (window.betaHome == 1 && 'False' == 'True') {
                        window.loadDashSplit();
                    } else {
                        $.url = "/GetTreelineControl.aspx?controlName=/uc/dashboard/DashboardFrame_V2.ascx";
                        $("#interiorPageContent").load($.url, function () { pageTracking.stopTrackPage();});
                    } 
                } else {
                    if (whatsLoading == 'KPI') {
                        $.url = "/GetTreelineControl.aspx?controlName=/uc/analytics/KPI_Home.ascx";
                        $("#interiorPageContent").load($.url);
                    }
                }
            });
        }
    }

    function goToBetaSignUp() {
        $("#pageURL").val("");
        window.scrollTo(0, 0);
        $("#interiorPageContent").html('<div style="height:900px;">Loading...</div>');
        $.url = "/GetTreelineControl.aspx?controlName=/uc/welcome/BetaSignUp.ascx";
        $("#interiorPageContent").load($.url);
        $("#menuDiv").hide();
        $("#pageHeader").hide();
    }

    function addMargin() {
        window.scrollTo(0, window.pageYOffset - 70);
    }

    window.addEventListener('hashchange', addMargin);

    function loadNewPage(url, sourcePop) {
        $("#interiorPageContent").html('<div style="height:900px;padding-left:20px;">Loading...</div>');
        window.scrollTo(0, 0);
        //$("#menuDiv").hide()
        if (sourcePop != '') {
            $("#popover_" + sourcePop).hide();
        }
        $("#pageURL").val(url);
        $.url = "/GetTreelineControl.aspx?controlName=" + url;
        $("#interiorPageContent").load($.url);
    }

    // create the back to top button
    $('body').prepend('<div onclick="javascript:window.scrollTo(0, 0);" class="back-to-top icon-navi-up-icon"></div>');
    
    function setInputDefaultText(inputControl) {
        $('#' + inputControl).val($('#' + inputControl).attr('defaultValue'));
        $('#' + inputControl).focus(function () {
            if ($(this).val() == $(this).attr('defaultValue')) {
                $(this).val('');
            }
        });
        $('#' + inputControl).blur(function () {
            if ($(this).val() == '') {
                $(this).val($(this).attr('defaultValue'));
            }
        });
    }

        function changeWorklistStatus(catalogId) {
        
        window.modalAlert("You must be logged in to use this feature. The good news is that Edelweiss+ registration is free! To log-in, register or learn more, click <span style='cursor:pointer;font-weight:bold;' onclick='javascript:actionWelcome();'>here</span>")
        

        return false;
    }

    function addToWorklistSimple(catalogId) {
        $(".worklist_" + catalogId).removeClass("icon-rating-inactive-icon");
        $(".worklist_" + catalogId).removeClass("accFont");
        $(".worklist_" + catalogId).addClass("icon-rating-active-icon");
        $(".worklist_" + catalogId).addClass("accFont");
        $(".worklist_" + catalogId).addClass("colorCommunity");

        if ($("#dash_2").length) {
            $(".worklist_" + catalogId).show();
        }

        if ($("#value_204").length > 0) {
            $("#value_204").html($("#value_204").html() * 1 + 1);
            $("#headerCount_2").html($("#headerCount_2").html() * 1 + 1);
        }
        //My Edelweiss Value
        if ($("#meVal_204").length > 0) {
            $("#meVal_204").html($("#meVal_204").html() * 1 + 1);
        }
        $.getJSON("/getJSONData.aspx?builder=AddToWorkList", { catalogID: catalogId }, function (data) {
            if (data.id == 0) {
                $(".worklist_" + catalogId).addClass("icon-rating-inactive-icon");
                $(".worklist_" + catalogId).removeClass("icon-rating-active-icon");
                $(".worklist_" + catalogId).removeClass("colorCommunity");
                if ($("#value_204").length > 0) {
                    $("#value_204").html($("#value_204").html() * 1 - 1);
                }
            } else {
                $(".wl_" + catalogId).attr("title", "Remove from Work List");
                $(".wlText_" + catalogId).html("On Worklist");
            }
        });
    }

    function removeFromWorklistSimple(catalogId) {
        $(".worklist_" + catalogId).addClass("icon-rating-inactive-icon");
        $(".worklist_" + catalogId).addClass("accFont");
        $(".worklist_" + catalogId).removeClass("icon-rating-active-icon");
        $(".worklist_" + catalogId).removeClass("accFont");
        $(".worklist_" + catalogId).removeClass("colorCommunity");
        
        if ($("#value_204").length > 0) {
            $("#value_204").html($("#value_204").html() * 1 - 1);
            $("#headerCount_2").html($("#headerCount_2").html() * 1 - 1);
        }
        //My Edelweiss Value
        if ($("#meVal_204").length > 0) {
            $("#meVal_204").html($("#meVal_204").html() * 1 - 1);
        }
        $.getJSON("/getJSONData.aspx?builder=RemoveFromWorklist", { catalogID: catalogId }, function (data) {
            if (data.code != "OK") {
                $(".worklist_" + catalogId).removeClass("icon-rating-inactive-icon");
                $(".worklist_" + catalogId).addClass("icon-rating-active-icon");
                $(".worklist_" + catalogId).addClass("colorCommunity");

                if ($("#value_204").length > 0) {
                    $("#value_204").html($("#value_204").html() * 1 + 1);
                }
            } else {
                $(".wl_" + catalogId).attr("title", "Add to Work List");
                $(".wlText_" + catalogId).html("Add to Work List");
            }
        });
    }

    function addToWorklist(resultType, catalogNumber, catalogId) {
        displayMessage("Adding catalog to worklist", 1000, "300px");
        $.getJSON("/getJSONData.aspx?builder=AddToWorkList", { catalogID: catalogId }, function (data) {
            if (data.id > 0) {
                $("#" + resultType + "_" + catalogNumber).remove();
                $("#value_204").html($("#value_204").html() * 1 + 1);
                $("#value_" + resultType).html($("#value_" + resultType).html() * 1 - 1);
                $("#headerCount_2").html($("#headerCount_2").html() * 1 - 1);
                $("#resultCount_2").val($("#headerCount_2").html());
            }
        });
    }

    function RemoveWLItem(key, workListId, pageTag, catalogNumber, thumbType) {
        displayMessage("Removing catalog from worklist", 1000, "300px");
        $.getJSON("/getJSONData.aspx?builder=RemoveItemFromCollection", { key: key, collectionID: workListId },
             function (data) {
                 if (data.code === "ERROR") {
                     alert('An error occurred');
                 }
                 else {
                     if (thumbType === "204") {
                         $("#" + thumbType + "_" + catalogNumber).remove();
                         $("#value_204").html($("#value_204").html() * 1 - 1);
                         $("#headerCount_2").html($("#headerCount_2").html() * 1 - 1);
                         $("#resultCount_2").val($("#headerCount_2").html());
                         var sly = new Sly('#frame' + thumbType);
                         sly.reload();
                     } else {
                         $("#addWL_" + pageTag + "_" + catalogNumber).show();
                         $("#removeWL_" + pageTag + "_" + catalogNumber).hide();
                         $("#value_204").html($("#value_204").html() * 1 - 1);
                     }
                 }
             });
         }

         //Tags
         function UpdateQuickTagAutoCompletes(acString, acInputs) {
             window.quickTagAutoComplete = acString

             if (acInputs && acInputs.length) {
                 var dataArray = acString.split("~");

                 acInputs.each(function () {
                     $(this).setOptions({ data: dataArray });
                 });
             }
         }

         function UpdateQuickCatalogTagAutoCompletes(acString) {
             window.quickCatalogTagAutoComplete = acString;
         }

         function UpdateQuickGroupAutoCompletes(acString) {
             $("#quickGroupAutoComplete").val(acString);
         }

         function saveShelf(sku, newShelf, shelfIcon) {
             var oldShelf = +$("#currentShelf_" + sku).val();
             if (newShelf != oldShelf) {
                 window.savingModal('Saving');
                 $.getJSON("/GetJSONData.aspx?builder=SetShelfStatus", { sku: sku, status: newShelf }, function (data) {
                     if (data.code == "OK") {
                         var oldShelfIcon = $("#currentShelfIcon_" + sku).val();
                         $(".myShelf_" + sku).removeClass(oldShelfIcon);
                         $(".myShelf_" + sku).addClass(shelfIcon);
                         if (oldShelf <= 0) {
                             $(".myShelf_" + sku).removeClass("hidden");
                             if ($(".simpleShelf_" + sku).length > 0) {
                                 $(".simpleShelf_" + sku).show()
                             }
                         }
                         if (newShelf <= 0) {
                             $(".myShelf_" + sku).addClass("hidden");
                             if ($(".simpleShelf_" + sku).length > 0) {
                                 $(".simpleShelf_" + sku).hide()
                             }
                         }
                         $("#currentShelf_" + sku).val(newShelf);
                         $("#currentShelfIcon_" + sku).val(shelfIcon);
                         closeModal();
                         //Update Dashboard If Appropriate
                         var refresh = 0
                         if ($("#dash_1").length > 0) {
                             var resultType = $("#selectedResult_1").val()
                             if (oldShelf == 15 || newShelf == 15) {
                                 if (resultType == '10' || resultType == '81') {
                                     refresh = 1;
                                 }
                             }
                             if (oldShelf == 16 || newShelf == 16) {
                                 if (resultType == '11' || resultType == '81') {
                                     refresh = 1;
                                 }
                             }
                             if (oldShelf == 20 || newShelf == 20) {
                                 if (resultType == '12' || resultType == '81') {
                                     refresh = 1;
                                 }
                             }
                             if (oldShelf == 30 || newShelf == 30) {
                                 if (resultType == '13' || resultType == '81') {
                                     refresh = 1;
                                 }
                             }
                             if (oldShelf == 40 || newShelf == 40) {
                                 if (resultType == '14' || resultType == '81') {
                                     refresh = 1;
                                 }
                             }
                             if (oldShelf == 50 || newShelf == 50) {
                                 if (resultType == '15' || resultType == '81') {
                                     refresh = 1;
                                 }
                             }
                             if (refresh == 1) {
                                 window.GetDashboardValue(translateShelfToResultType(oldShelf), 0);
                                 window.GetDashboardValue(translateShelfToResultType(newShelf), 0);
                                 refreshThumbnails(resultType, 1, 10);
                                 
                                 refreshWidgetsWithResultType(translateShelfToResultType(oldShelf));
                                 refreshWidgetsWithResultType(translateShelfToResultType(newShelf));
                             }
                         }
                     }
                     else
                         alert(data.text);
                 });
             }
         }

         function translateShelfToResultType(shelf) {
             switch(shelf) {
                 case 15:
                return 10;
            case 16:
                return 11;
             case 20:
                return 12;
             case 30:
                return 13;
             case 40:
                 return 14;
             case 50:
                 return 15;
         }
     }

     function saveRating(sku, newRating, ratingIcon) {
         var oldRating = $("#currentRating_" + sku).val();
         $.getJSON("/GetJSONData.aspx?builder=SetRating", { sku: sku, rating: newRating }, function (data) {
             if (data.code === "OK") {
                 var oldRatingIcon = $("#currentRatingIcon_" + sku).val();
                 $(".myRating_" + sku).removeClass(oldRatingIcon);
                 $(".myRating_" + sku).addClass(ratingIcon);
                 if (oldRating <= 0) {
                     $(".myRating_" + sku).removeClass("hidden");
                     if ($(".simpleRating_" + sku).length > 0) {
                         $(".simpleRating_" + sku).show()
                     }
                 }
                 if (newRating <= 0) {
                     $(".myRating_" + sku).addClass("hidden");
                     if ($(".simpleRating_" + sku).length > 0) {
                         $(".simpleRating_" + sku).hide()
                     }
                 }
                 $("#currentRating_" + sku).val(newRating);
                 $("#currentRatingIcon_" + sku).val(ratingIcon);
                 //Update Dashboard If Appropriate
                 var refresh = 0
                 if ($("#dash_1").length > 0) {
                         var resultType = $("#selectedResult_1").val()
                         if (oldRating == 1 || newRating == 1) {
                             if (resultType == '80') {
                                 refresh = 1;
                             }
                         }
                         if (oldRating == 2 || newRating == 2) {
                             if (resultType == '80') {
                                 refresh = 1;
                             }
                         }
                         if (oldRating == 3 || newRating == 3) {
                             if (resultType == '80') {
                                 refresh = 1;
                             }
                         }
                         if (oldRating == 4 || newRating == 4) {
                             if (resultType == '80') {
                                 refresh = 1;
                             }
                         }
                         if (refresh == 1) {
                             refreshThumbnails(resultType, 1, 10)
                             }
                         }
                     }
                     else
                         alert(data.text);
             });
             }

            function enableSingleCheckbox($checkId) {
                if ($checkId.hasClass("box_unchecked")) {
                    $checkId.addClass("box_checked").removeClass("box_unchecked");
                } else {
                    $checkId.addClass("box_unchecked").removeClass("box_checked");
                }
            }

            function enableMultipleCheckbox($checkId, commonClass) {
                 $("." + commonClass).addClass("box_unchecked").removeClass("box_checked");
                 $("#" + $checkId.attr("id")).addClass("box_checked").removeClass("box_unchecked");
             }

             function submitReview(sku) {
                 window.savingModal('Saving');
                 var alertmessage = "";
                 var rating = $("#currentRating_" + sku).val();
                 if (rating <= 0) {
                     alertmessage = "Please indicate your recommendation (This will be a more stylized alert soon)";
                     alert(alertmessage);
                     closeSavingModal();
                 }
                 else {
                     $.comment = encodeURIComponent($('#userComment_' + sku).val());
                     var submitToPub = 0;
                     if ($('#submit_pub').hasClass("box_checked")) { submitToPub = 1 }
                     var submitToIndie = 0;
                     if ($('#SubmitToIndie').hasClass("box_checked")) { submitToIndie = 1 }
                     var submitToLibraryReads = 0;
                     if ($('#submit_libraryReads').hasClass("box_checked")) { submitToLibraryReads = 1 }

                     $.post("/getJSONData.aspx?builder=SaveBuyerReview",
                         {
                             sku: sku,
                             rating: rating,
                             comment: $.comment,
                             SubmitToPub: submitToPub,
                             SubmitToIndie: submitToIndie,
                             submitToLibraryReads: submitToLibraryReads
                         },
                     function (data) {
                         //$("#reviewSave").addClass("hidden");
                         //$("#reviewClear").removeClass("hidden");
                         closeModal();
                     }, "json");
                     return false;
                 }
             }

             function clearReview(sku) {
                 if (confirm("Are you sure you want to delete this review? (nicer prompt coming soon)")) {
                     $.getJSON("/getJSONData.aspx?builder=ClearBuyerReview", { sku: sku },
                         function (data) {
                             $("#userComment_" + sku).val("");
                             $("#reviewSave").addClass("hidden");
                             $("#reviewClear").addClass("hidden");
                         });
                 }
             }

             function clearAssessment(sku) {
                 var $dialog = $("#reviewTitleTurbo_" + sku);

                 $dialog.trigger("showBlock", "deleting...");

                 if (confirm("Are you sure you want to delete this review?")) {
                     $.getJSON("/getJSONData.aspx?builder=ClearBuyerAssessment", { sku: sku }, function (data) {
                         $dialog.trigger("hideBlock");
                         $(".love_" + sku).addClass("icon-heart-o")
                         $(".love_" + sku).removeClass("icon-heart")
                         $(".love_" + sku).addClass("muchLoveOpen")
                         $(".love_" + sku).removeClass("muchLoveFull")

                         if ($(".myRating_" + sku).length > 0) {
                             $(".myRating_" + sku).html(-1);
                             $(".myRating_" + sku).addClass("hidden");

                             if (window.items && window.sortrefine) {
                                 if (getListViewProperty("itemType") != 50) {
                                     window.sortrefine[window.items.indexOf(sku)].PersonalReviews = 0;
                                     getRefineNumbers();
                                 }
                             }
                         }

                         incrementQHeadCount(20, -1);

                         //If displayed, update the "Downloaded, Not Reviewed" resultType bubble
                         if ($("#value_17").length > 0) {
                             window.GetDashboardValue(17, 0, 0);
                            }

                         if ($(".simpleRating_" + sku).length > 0) {
                             $(".simpleRating_" + sku).hide()
                         }
                         if ($("#dash_1").length > 0) {
                             var resultType = $("#selectedResult_1").val();
                             if (resultType == '104') {
                                 refreshThumbnails(resultType, 1, 10)
                             }
                         }

                         if ($(".reviewBlock_" + sku).length > 0) {
                             $(".reviewBlock_" + sku).html("");
                             $(".assessment_" + sku).html("-");
                             $(".reviewTime_" + sku).html('Today');
                           }
                         $dialog.trigger("close");
                     });
                   }
               }

               function showModalReview_User(userId, sku) {
                   $("#container-modalWrap").show();
                   $('html, body').css("overflow", "hidden");
                   $("#modal-bbyf").show();
                   $("#modal-bbyf").css("width", "700px");

                   $("#modal-bbyf").html('<div style="padding:20px;height:300px;"><div><div id="modalReview"></div></div>');
                   var htmlString = "<div style='float:left;'><img src='" + $("#hiddenJacket_" + sku).val() + "' /></div>";
                   htmlString += "<div style='float:left;padding-left:20px;width:490px;'>";
                   htmlString += "<div style='clear:both;'>" + $("#userSummary_" + userId).html() + "</div>";
                   htmlString += "<div class='textMedium' style='clear:both;margin-top:5px;'>" + $("#rating_" + userId + "_" + sku).html() + "</div>";
                   htmlString += "<div class='textMedium' style='clear:both;height:200px;overflow:auto;margin-top:20px;'>" + $("#fullReview_" + userId + "_" + sku).val() + "</div>";
                   htmlString += "</div><div style='clear:both;'></div>";

                   $("#modalReview").html(htmlString);
                   $("#modal-bbyf").html($("#modal-bbyf").html() + '<div style="background-color: white; text-align: center; font-size: 12px;border-top:1px solid #D2D6D8;cursor:pointer;" onclick="javascript:closeHomepageDialog()">Close</div>');
            }

            function closeHomepageDialog() {
                $("#container-modalWrap").hide();
                $("#modal-bbyf").hide();
                $("#modal-bbyf").css("top", "200px");
                $("#modal-bbyf").css("left", "0");
                $("#modal-bbyf").css("right", "0");
                $("#modal-bbyf").css("bottom", null);
                $("#modal-bbyf").css("width", null);

                $('html, body').css({
                    'overflow': 'auto',
                    'height': 'auto'
                });
                if ($("#titleFocus").css("display") !== "none") {
                    $("#titleFocus").hide();
                }
            }

            function displayMessage(messageText, autoTime, width) {
                $("#container-modalWrap").show();
                $('html, body').css("overflow", "hidden");
                $("#modal-bbyf").css("width", width);
                $("#modal-bbyf").show();
                $("#modal-bbyf").html("<div style='padding:30px;'>" + messageText + "</div>");
                if (autoTime > 0) {
                    setTimeout(function () {
                        closeHomepageDialog();
                    }, autoTime);
                }
            }
    
            function showIllustrations(sku, itemNumber) {
                $('#intImage_1_' + sku).show();
                $('#intImage_0_' + sku).hide();
                if ($('#TitleView_illustrations' + itemNumber).attr("data-status") == 0) {
                    populateIllustrations(sku, itemNumber, $(".standardTitleFrame").width());
                }

            }



            function populateTitles(resultType, dashboardType, itemCount, divHeight, dashCount) {
                savingModalOverlay('Loading', "dashboardFrame" + dashboardType);
        $.url = "/GetTreelineControl.aspx?controlName=/uc/thumbviews/ThumbScrollSlick.ascx&dashCount=" + dashCount + "&divHeight=" + divHeight + "&itemCount=" + itemCount + "&resultType=" + resultType + "&displayType=1&dashboardType=" + dashboardType;
        $("#dashTitles_" + dashboardType).load($.url);
    }

    function populateReviews(resultType, dashboardType, itemCount, divHeight, dashCount) {
        savingModalOverlay('Loading', "dashboardFrame" + dashboardType);
        $.url = "/GetTreelineControl.aspx?controlName=/uc/thumbviews/ThumbScrollSlick.ascx&dashCount=" + dashCount + "&divHeight=" + divHeight + "&itemCount=" + itemCount + "&resultType=" + resultType + "&displayType=50&dashboardType=" + dashboardType;
        $("#dashTitles_" + dashboardType).load($.url);
    }

    function populateTitles_TagVariant(resultType, dashboardType, tag) {
        savingModalOverlay(window.loadingText, "dashboardFrame" + dashboardType);
        $.url = "/GetTreelineControl.aspx?controlName=/uc/thumbviews/ThumbScrollSlick.ascx&divHeight=280&tag=" + tag + "&resultType=" + resultType + "&dashboardType=" + dashboardType + "&displayType=1";
        $("#dashTitles_" + dashboardType).load($.url);
    }

    function populateCatalogs(resultType, dashboardType, divHeight, dashCount, callback) {
        if (divHeight < 280) {
            divHeight = 280;
        }
        savingModalOverlay('Loading', "dashboardFrame" + dashboardType);
       $.url = "/GetTreelineControl.aspx?controlName=/uc/thumbviews/ThumbScrollSlick.ascx&dashCount=" + dashCount + "&divHeight=" + divHeight + "&resultType=" + resultType + "&displayType=0&dashboardType=" + dashboardType;
       $("#dashTitles_" + dashboardType).load($.url, callback);
   }

   function populateCatalogsList(resultType, dashboardType, divHeight, dashCount) {
       if (divHeight < 280) {
           divHeight = 280;
       }

       savingModalOverlay('Loading', "dashboardFrame" + dashboardType);
             //$("#dashTitles_" + dashboardType).html('<div style="height:235px;overflow: hidden;"><div id="loadMessage_' + dashboardType + '"  style="margin-top: 30px; height: 50px;padding-left:40px;">Loading Catalogs...</div></div>');
             $.url = "/GetTreelineControl.aspx?controlName=/uc/thumbviews/ThumbList.ascx&dashCount=" + dashCount + "&divHeight=" + divHeight + "&resultType=" + resultType + "&displayType=0&dashboardType=" + dashboardType;
             $("#dashTitles_" + dashboardType).load($.url);
         }

         function populateCatalogs_TagVariant(resultType, dashboardType, tag) {
             var creator = ""
             if ($("#tagCreator").val() != "") { creator = "&creator=" + encodeURI($("#tagCreator").val()) }
             savingModalOverlay('Loading', "dashboardFrame" + dashboardType);
             $.url = "/GetTreelineControl.aspx?controlName=/uc/thumbviews/ThumbScrollSlick.ascx&divHeight=280&tag=" + tag + "&resultType=" + resultType + "&displayType=0&dashboardType=" + dashboardType + creator;
             $("#dashTitles_" + dashboardType).load($.url);
         }

         function populatePublishers(resultType, dashboardType, dashCount) {
             $("#dashTitles_" + dashboardType).html('<div style="height:235px;overflow: hidden;"><div id="loadMessage_' + dashboardType + '" style="margin-top: 30px; height: 50px;padding-left:40px;">Loading Publishers...</div></div>');
             $.url = "/GetTreelineControl.aspx?controlName=/uc/thumbviews/ThumbScroll.ascx&divHeight=183&dashCount=" + dashCount + "&thumbHeight=80&resultType=" + resultType + "&displayType=2&dashboardType=" + dashboardType;
             $("#dashTitles_" + dashboardType).load($.url);
         }

         function populatePeople(resultType, dashboardType, dashCount) {
             savingModalOverlay('Loading', "dashboardFrame" + dashboardType);
             $.url = "/GetTreelineControl.aspx?controlName=/uc/thumbviews/ThumbScrollSlick.ascx&dashCount=" + dashCount + "&thumbHeight=80&resultType=" + resultType + "&displayType=3&dashboardType=" + dashboardType;
             $("#dashTitles_" + dashboardType).load($.url);
         }

         function populateOrders(resultType, dashboardType, dashCount) {
             savingModalOverlay('Loading', "dashboardFrame" + dashboardType);
             $.url = "/GetTreelineControl.aspx?controlName=/uc/thumbviews/ThumbScrollSlick.ascx&dashCount=" + dashCount + "&thumbHeight=80&resultType=" + resultType + "&displayType=4&dashboardType=" + dashboardType
             $("#dashTitles_" + dashboardType).load($.url);
         }

         function populatePubilicityCampaigns(resultType, dashboardType, dashCount) {
             var thumbHeight = 80
             savingModalOverlay('Loading', "dashboardFrame" + dashboardType);
            $.url = "/GetTreelineControl.aspx?controlName=/uc/thumbviews/ThumbScrollSlick.ascx&dashCount=" + dashCount + "&thumbHeight=" + thumbHeight + "&resultType=" + resultType + "&displayType=12&dashboardType=" + dashboardType
            $("#dashTitles_" + dashboardType).load($.url);
        }

        function populateFixedJackets(catalogId, thumbHeight) {
            $("#jackets_" + catalogId).html('<div style="overflow: hidden;"><div style="margin-top: 30px; height: 50px;padding-left:40px;">Loading Titles...</div></div>')
             $.url = "/GetTreelineControl.aspx?controlName=/uc/thumbviews/ThumbFixed.ascx&thumbHeight=" + thumbHeight + "&catalogID=" + catalogId + "&resultType=31&displayType=1"
             $("#jackets_" + catalogId).load($.url);
         }

         function populateFixedJackets_People(resultType, userId) {

             $.url = "/GetTreelineControl.aspx?controlName=/uc/thumbviews/ThumbFixed.ascx&thumbHeight=110&userID=" + userId + "&resultType=" + resultType + "&displayType=1"
        $("#jackets_" + resultType + "_" + userId).load($.url);
    }

    function populateFixedCovers(resultType, orgId) {
        $("#covers_" + resultType + "_" + orgId).html('<div style="overflow: hidden;"><div style="margin-top: 30px; height: 50px;padding-left:40px;">Loading Catalogs...</div></div>')
        $.url = "/GetTreelineControl.aspx?controlName=/uc/thumbviews/ThumbFixed.ascx&thumbHeight=110&orgID=" + orgId + "&resultType=" + resultType + "&displayType=0"
        $("#covers_" + resultType + "_" + orgId).load($.url);
    }


    function renderCompDetail(sku, source, view, mailingID) {
        window.savingModalOverlay('Loading', "compHolder_" + source + "_" + sku)
        $.url = "/GetTreelineControl.aspx?controlName=/uc/product/CompsBasicDetailGrid.ascx&sku=" + sku + "&source=" + source + "&mailingID=" + mailingID;
        $(".compHolder_" + source + "_" + sku).load($.url, function() {
            window.closeSavingModalOverlay("compHolder_" + source + "_" + sku)
            $(".compHolder_" + source + "_" + sku).show();
            $(".noCompHolder_" + source + "_" + sku).hide();
            if ($("#compsFor_" + sku).length > 0 && window.hasPosData) {
                loadCompAnalytics($("#compsFor_" + sku).val(), sku, getListViewProperty("selectedOrgID"), 'single');
            }
        });
    }
    
    function reloadDashboard(dashboardType) {
        $("#dashboard_" + dashboardType).html('<div style="height:170px;overflow: hidden;"><div style="margin-top: 30px; height: 50px;padding-left:40px;">Loading...</div></div>');
        $.url = "/GetTreelineControl.aspx?controlName=/uc/dashboard/Dashboard.ascx&dashboardType=" + dashboardType;
        $("#dashboard_" + dashboardType).load($.url);
    }

    function populateWelcomeTitles(resultType, itemCount) {
        $("#welcomeScroll").html('<div style="height:170px;overflow: hidden;"><div style="margin-top: 30px; height: 50px;padding-left:40px;">Loading Titles...</div></div>');
        $.url = "/GetTreelineControl.aspx?controlName=/uc/thumbviews/ThumbScroll.ascx&thumbHeight=130&itemCount=" + itemCount + "&resultType=" + resultType + "&displayType=title";
        $("#welcomeScroll").load($.url);
    }

    function showNoteDetail(sku) {
        $("#noteWidget" + sku).html('<div style="height:200px;background:#E9EBEC;width:515px;overflow: hidden;"><div style="margin-top: 200px; height: 50px;padding-left:40px;">Loading...</div></div>');
        $.url = "/GetTreelineControl.aspx?controlName=/uc/product/ProductNotes.ascx&sku=" + sku;
        $("#noteWidget" + sku).load($.url);
        animateUp("noteWidget" + sku);
    }

    function showDisplayNote(sku) {
        $.url = "/GetTreelineControl.aspx?controlName=/uc/product/two_Notes.ascx&reload=1&sku=" + sku;
        $("#displayNote" + sku).load($.url);
    }

    function animateDown(controlDiv) {
        var div = $("#" + controlDiv);

        var height = div.height();

        div.css({
            overflow: "hidden",
            marginTop: 0,
            height: height
        }).animate({
            marginTop: height,
            height: 0
        }, 1000, function () {
            $(this).css({
                display: "none",
                overflow: "",
                height: "",
                marginTop: ""
            });
        });
    }

    function animateUp(controlDiv) {
        var div = $("#" + controlDiv + ":not(:visible)");

        var height = div.css({
            display: "block"
        }).height();

        div.css({
            overflow: "hidden",
            marginTop: height,
            height: 0
        }).animate({
            marginTop: 0,
            height: height
        }, 1000, function () {
            $(this).css({
                display: "",
                overflow: "",
                height: "",
                marginTop: ""
            });
        });
    }

    function openListViewTags(sku, displayOnly, focusOn) {
        if ($("#curTags_" + sku).html() != "" && $("#curTags_" + sku).html() != 'Loading' && $(".myTags_" + sku).html() * 1 == 0 && $(".orgTags_" + sku).length == 0) {
            $("#curTags_" + sku).html("")
        } else {
            if ($("#curTags_" + sku).html() == "") {
                $("#curTags_" + sku).html("Loading");
            }
            $.url = "/GetTreelineControl.aspx?controlName=/uc/controls/tagTitleInline.ascx&sku=" + sku + "&displayOnly=" + displayOnly + "&focusOn=" + focusOn;
            $("#curTags_" + sku).load($.url);
        }
    }

    function openListViewNote(sku) {
        $.getJSON("/getJSONData.aspx?builder=GetOrgNote", { sku: sku }, function (data) {
            if (data.data == "SUCCESS") {
                if (data.text == "" || data.text == undefined) {
                    $("#curNote_" + sku).html("");
                } else {
                    $("#curNote_" + sku).html("<div class='notes-tags-label'>Note</div><div class='notes-tags-content'>" + data.text + '</div>');
                }
            }
        }, "json");
    }

    function openListViewAccountNotes(skus) {
        if(!_.isArray(skus)) {
            return;
        }
        var postParams = JSON.stringify(skus);
        var selectedOrgId = getListViewProperty("selectedOrgID");
        if (!_.isString(selectedOrgId)) {
            for (var i = 0, max = skus.length; i < max; i++) {
                $("#curAccountNote_" + skus[i]).html("");
            }
        } else {
            $.ajax({
                type: "POST",
                data: postParams,
                cache: false,
                url: "api/me/notes/accounts/" + selectedOrgId,
                contentType: "application/json",
                success: function(data) {
                    var selectedAccountName = $("#selectedAccountName").text().trim();
                    if (selectedAccountName && selectedAccountName.length > 0) {
                        selectedAccountName += " Notes";
                    }
                    var defaultLabel = "Account Notes";
                    for (var i = 0, max = skus.length; i < max; i++) {
                        if (data[skus[i]]) {
                            var notesText = buildAccountNotes(data[skus[i]]);
                            $("#curAccountNote_" + skus[i])
                                .html("<div class='notes-tags-label'>" + (selectedAccountName || defaultLabel) + "</div><div class='notes-tags-content'>" + notesText + '</div>');
                        } else {
                            $("#curAccountNote_" + skus[i]).html("");
                        }
                    }
                }
            });
        }
    }
    function openListViewAccountTags(skus) {
        if(!_.isArray(skus)) {
            return;
        }
        var postParams = JSON.stringify(skus);
        var selectedOrgId = getListViewProperty("selectedOrgID");
        if (!_.isString(selectedOrgId)) {
            for (var i = 0, max = skus.length; i < max; i++) {
                $("#account-shared-tags-" + skus[i]).html("");
            }
        } else {
            $.ajax({
                type: "POST",
                data: postParams,
                url: "api/me/orgtags/accounts/" + selectedOrgId,
                contentType: "application/json",
                success: function(data) {
                    var selectedAccountName = $("#selectedAccountName").text().trim();
                    if (selectedAccountName && selectedAccountName.length > 0) {
                        selectedAccountName += " Tags";
                    }
                    var defaultLabel = "Account Tags";
                    for (var i = 0, max = skus.length; i < max; i++) {
                        if (data[skus[i]]) {
                            var tagsHtml = buildAccountTags(data[skus[i]]);
                            $("#account-shared-tags-" + skus[i])
                                .html("<div class='notes-tags-label'>" + (selectedAccountName || defaultLabel) + "</div><div class='notes-tags-content shared-tag-container'>" + tagsHtml + '</div>');
                        } else {
                            $("#account-shared-tags-" + skus[i]).html("");
                        }
                    }
                }
            });
        }
    }

    function buildAccountTags(tags) {
        var tagInnerHtml = _.reduce(tags, function(html, tag) {
            var nameString = '';
            if (tag.firstName && tag.lastName && _.size(tag.firstName.trim()) > 0 && _.size(tag.lastName.trim()) > 0) {
                nameString = ' (' + tag.firstName.substring(0, 1) + '. ' + tag.lastName + ')';
            }
            return html + '<li class="colleagueTag-tag colleague-tag-text">' + tag.value + nameString + '</li>';
        }, "");
        return '<ul class="colleagueTag">' + tagInnerHtml + '</ul>';
    }

    function buildAccountNotes(notes) {
        var notesText = "";
        for (var i = 0; i < notes.length; i++) {
            notesText += notes[i].text + " ";
        }
        return notesText;
    }

    function goToAnalyticsHome(dashboardType, subDash) {
        pageChange("analytics=" + dashboardType + "&subDash=" + subDash);
    }

    function isAnalyticsRowsUsed() {
        return parseInt(getListViewProperty("dashboardType")) === parseInt(getEnumValue("dashType", "LA_HOME"))
            || parseInt(getListViewProperty("listType")) === parseInt(getEnumValue("listType", "ANALYSISOFTITLESET"));
    }

    function getSelectedItems() {
        var rows = isAnalyticsRowsUsed() ? EdelweissAnalytics.rows : window.rows;
        var arr = [];
        for (var i = 0; i < rows.length; i++) {
            if (rows[i].selected == 1) {
                arr.push(rows[i].item);
            }
        }
        return arr;
    }

    function getSelectedItemsIntoString() {
        var rows = isAnalyticsRowsUsed() ? EdelweissAnalytics.rows : window.rows;
        var selectedItems = getSelectedItems();
        return _.join(selectedItems, ',');
    }

    function getItemsWithClass(classToCheck, classToCheckFor, attributeToRetrieve) {
        var arr = new Array();
        $("." + classToCheck + "." + classToCheckFor).each(function (i, obj) {
            arr[arr.length] = $(this).attr(attributeToRetrieve);
        });
        return arr;
    }

    function getItemsWithClassIntoString(classToCheck, classToCheckFor, attributeToRetrieve) {
        var result = "";
        $("." + classToCheck + "." + classToCheckFor).each(function (i, obj) {
            if (result != "") {
                result += ","; }
            result += $(this).attr(attributeToRetrieve);
        });
        return result;
    }

    function getItemsWithClassAndAttributeIntoString(classToCheck, classToCheckFor, attributeToCheckFor, attributeValue, attributeToRetrieve) {
        var result = "";
        var $element = $("." + classToCheck + "." + classToCheckFor)
        $element.each(function (i, obj) {
            if($(this).attr(attributeToCheckFor) == attributeValue){
                if (result != "") {
                    result += ","; 
                }
                result += $(this).attr(attributeToRetrieve);
            }
        });
        return result;
    }

    //The function to open and close the 'Content' link in the moreTitleInfo.ascx page
    function ToggleContentReference(id, sku, mode) {
        if (mode == 1 && (!$('#' + id).is(":hidden"))) {
            //Show all when the overall content page is shown already
            $(".expandContent").show()
            $('#' + id + '-plus-arrow').hide();
        } else {
            $('#' + id + '-plus-arrow').show();
            $('#' + id).toggle();
            if (!$('#' + id).is(":hidden")) {
                $('#' + id + '-arrow').removeClass("icon-drop-down-icon");
                $('#' + id + '-arrow').addClass("icon-drop-up-icon-01");
                $.url = "/GetTreelineControl.aspx?controlName=/uc/product/two_Enhanced.ascx&sku=" + sku + "&idPrefix=" + id + "&mode=" + mode;
                $('#' + id).load($.url);
                if (mode == 1) { $('#' + id + '-plus-arrow').hide(); }
            }
            else {
                $('#' + id + '-arrow').addClass("icon-drop-down-icon");
                $('#' + id + '-arrow').removeClass("icon-drop-up-icon-01");
                $(".expandContent").hide()
            }
        }
    }

    function HideContentReference() {
        $('.content_plus_arrow').show();
        $('.content_arrow').addClass("icon-drop-down-icon");
        $('.content_arrow').removeClass("icon-drop-up-icon-01");
        $('.titleContentDiv').hide();
    }

    function ShowContentReference(id, sku, mode) {
        if (mode == 1 && (!$('#' + id).is(":hidden"))) {
            //Show all when the overall content page is shown already
            $(".expandContent").show()
            $('#' + id + '-plus-arrow').hide();
        } else {
            if ($('#' + id).is(":hidden")) {
                $('#' + id).toggle();
                $('#' + id + '-plus-arrow').show();
                $('#' + id + '-arrow').removeClass("icon-drop-down-icon");
                $('#' + id + '-arrow').addClass("icon-drop-up-icon-01");
                $.url = "/GetTreelineControl.aspx?controlName=/uc/product/two_Enhanced.ascx&sku=" + sku + "&idPrefix=" + id + "&mode=" + mode;
                $('#' + id).load($.url);
                if (mode == 1) { $('#' + id + '-plus-arrow').hide(); }
            }
        }
    }

//The function to open and close the 'Content' link in the moreTitleInfo.ascx page
function ToggleRelatedProduct(id, sku) {
    $('#' + id + '-plus-arrow').show();
    $('#' + id).toggle();
    if (!$('#' + id).is(":hidden")) {
        $('#' + id + '-arrow').removeClass("icon-drop-down-icon");
        $('#' + id + '-arrow').addClass("icon-drop-up-icon-01");
        $.url = "/GetTreelineControl.aspx?controlName=/uc/product/RelatedBasic.ascx&sku=" + sku + "&idPrefix=" + id + "&mailingId=" + getListViewProperty("selectedMailingID");
        $('#' + id).load($.url);
    }
    else {
        $('#' + id + '-arrow').addClass("icon-drop-down-icon");
        $('#' + id + '-arrow').removeClass("icon-drop-up-icon-01");
        //$(".expandContent").hide()
    }
}
    
//The function to open and close the 'Content' link in the moreTitleInfo.ascx page
function ToggleComps(id, sku, isPublisherCompsVisible) {
    $('#' + id + '-plus-arrow').show();
    $('#' + id).toggle();
    if (!$('#' + id).is(":hidden")) {
        $('#' + id + '-arrow').removeClass("icon-drop-down-icon");
        $('#' + id + '-arrow').addClass("icon-drop-up-icon-01");
        var mailingId = getListViewProperty("selectedMailingID");
        if (!mailingId) {
            mailingId = getHashValue("mailingID");
        }
        $.url = "/GetTreelineControl.aspx?controlName=/uc/product/CompsBasic.ascx&sku=" + sku + "&idPrefix=" + id + "&mailingID=" + mailingId + (isPublisherCompsVisible !== undefined ? "&isPublisherCompsVisible=" + isPublisherCompsVisible : "");
        $('#' + id).load($.url);
    } else {
        $('#' + id + '-arrow').addClass("icon-drop-down-icon");
        $('#' + id + '-arrow').removeClass("icon-drop-up-icon-01");
        //$(".expandContent").hide()
    }
}


//The function to open and close the 'Content' link in the moreTitleInfo.ascx page
function ToggleReferences(id, sku, orgId, catalogId, pubOrgId, cms) {
    $('#' + id + '-plus-arrow').show();
    $('#' + id).toggle();
    if (!$('#' + id).is(":hidden")) {
        $('#' + id + '-arrow').removeClass("icon-drop-down-icon");
        $('#' + id + '-arrow').addClass("icon-drop-up-icon-01");
        $.url = "/GetTreelineControl.aspx?controlName=/uc/product/lookup/ProductLookup.ascx" +
                "&sku=" + sku + "&idPrefix=" + id + "&orgID=" + orgId + "&catalogID=" + catalogId + "&pubOrgId=" + pubOrgId + "&cms=" + cms;
        $('#' + id).load($.url);
    }
    else {
        $('#' + id + '-arrow').addClass("icon-drop-down-icon");
        $('#' + id + '-arrow').removeClass("icon-drop-up-icon-01");
        //$(".expandContent").hide()
    }
}

    function showIntImage(sku) {
        $("#intImage_0_" + sku).hide();
        $("#intImage_1_" + sku).show();
    }

    function hideIntImage(sku) {
        $("#intImage_0_" + sku).show();
        $("#intImage_1_" + sku).hide();
    }

    function ShowComps(id, sku, isPublisherCompsVisible) {
        var mailingId = getListViewProperty("selectedMailingID");
        if ($('#' + id).is(":hidden")) {
            $('#' + id + '-plus-arrow').show();
            $('#' + id).toggle();
            $('#' + id + '-arrow').removeClass("icon-drop-down-icon");
            $('#' + id + '-arrow').addClass("icon-drop-up-icon-01");
            $.url = "/GetTreelineControl.aspx?controlName=/uc/product/CompsBasic.ascx&sku=" + sku + "&idPrefix=" + id + "&mailingID=" + mailingId  + (isPublisherCompsVisible !== undefined ? "&isPublisherCompsVisible=" + isPublisherCompsVisible : "");
            $('#' + id).load($.url);
        }
    }
    
    function HideComps() {
        $('.comps_arrow').addClass("icon-drop-down-icon");
        $('.comps_arrow').removeClass("icon-drop-up-icon-01");
        $('.titleCompsDiv').hide();
    }

function AddCompTitleToMarkup(sku, compSKU) {
    savingChildModal('Saving');
    var mailingId = getListViewProperty("selectedMailingID");
    $.getJSON("/getJSONData.aspx?m=CompProduct&builder=AddCompTitles&sku=" + sku + "&CompSkus=" + compSKU + "&dORGID=&mailingID=" + mailingId + "&catalogID=0",
            function (data) {
                if (data.code == "SUCCESS") {
                    if ($(".cbd").length == 0) {
                        renderCompDetail(sku, 0, 0, mailingId);
                    } else {
                        renderCompDetail(sku, 0, 1, mailingId);
                    }

                    $(".comp-add-" + compSKU + "-to-" + sku).hide();
                    $('#compsModal' + sku).trigger("destroy");
                    $('#compsSearchModal').trigger("destroy");
                }
                else {
                    alert(data.text);
                }
            }, "json");

}

function AddPublisherCompTitle(sku, compSKU) {
    savingChildModal('Saving');
    var values = {
        sku: sku,
        compSKU: compSKU
    };
    $.getJSON("/getJSONData.aspx?m=CompProduct&builder=AddPublisherComps",
        values,
        function (data) {
            if (data.code == "SUCCESS") {
                changeTitleAdminView('7');
                var compsAddedCount = _.isNil(data.data) ? 0 : parseInt(data.data, 10);
                var currentCompsCount = 0;

                if ($("#modal_7-count").length) {
                    currentCompsCount = parseInt($("#modal_7-count").html(), 10);
                }

                $("#modal_7-count").html(currentCompsCount + compsAddedCount);
                $('#compsModal' + sku).trigger("destroy");
                $('#compsSearchModal').trigger("destroy");
            }
            else {
                alert(data.text);
            }
        }, "json");

}

function openListViewHeaders(header) {
    if ($('#popover_' + header).css("display") == "none") {
        $('.pop_menu').slideUp();
        
        $('#popover_listView_block').show();
        
        if (header == 'actions') {
            $('#popover_' + header + '_arrow').css("left", $("#ic_" + header).position().left * 1 + 8 + "px");
        } else {
            $('#popover_' + header + '_arrow').css("left", "17px");
            $('#popover_' + header).css("left", $("#ic_" + header).position().left * 1 - 8 + "px");
        }
        $('#popover_' + header).slideDown();
    }
}

function openAnalyticsListViewHeaders(header, dashType) {
    if ($('#popover_' + header).css("display") == "none") {
        $('.pop_menu').slideUp();
    
        var detailListPosition = $('#detailList_' + dashType).position();
        var listTop = detailListPosition.top;
        $('#popover_analyticsListView_block').css(
        {
            top: listTop          
        });

        $('#popover_analyticsListView_block').show();
       
        if (header == 'actions') {
            $('#popover_' + header + '_arrow').css("left", $("#ic_" + header).position().left * 1 + 8 + "px");
        } else {
            $('#popover_' + header + '_arrow').css("left", "17px");
            $('#popover_' + header).css("left", $("#ic_" + header).position().left * 1 - 8 + "px");
        }
        $('#popover_' + header).slideDown();
    }
}

function closeListViewHeaders(header) {
    $('#popover_' + header).slideUp();
    $('#popover_listView_block').hide();
}


//The functions to open and close the catalog hovers
function openCatalogHover(selectedControl, hoverContent) {
    createCatalogHover(selectedControl, hoverContent);
    var o1 = $("." + selectedControl).position();
    var left = o1.left - 1;
    var top = o1.top;
    var controlWidth = $("." + selectedControl).width() * 1;
    $("#pop_arrow").css("left", left * 1 + controlWidth / 2 - 7 + "px");
    $("#pop_arrow").css("left", "90%");
    $("#popFrame").css("top", top + 20 + "px");
    //$("#pop_content").html(decodeURI(hoverContent));
    $("#popFrame").slideDown();
}
function createCatalogHover(selectedControl, hoverContent) {
    try {
        $("#popFrame").remove();
        var dHTML = '<div id="popFrame" class="socialMainPop" style="position: absolute; display: none; z-index: 91002;left:0;right:0;">';
        dHTML += '<div id="pop_arrow" class="hover_top_arrow" style="left: 150px;"></div>';
        dHTML += '<div id="pop_content" class="popover_content bgdHelp overallStyles textMedium" style="cursor: pointer;font-weight:normal;padding: 15px;color:#fff;">' + decodeURI(hoverContent) + '</div></div>';
        $("." + selectedControl).after(dHTML);
    }
    catch(err) {
        alert('here')
    }
}
function closeCatalogHover() {
    $("#popFrame").remove();
}

//The functions to open and close the menus on the Action Strip
function initializeHover(elem, text) {
    $("." + elem).mouseout(function () {
        window.closeHover();
    }).mouseover(function () {
        window.openHover(elem, text);
    });
}

function deleteCollection(collectionID) {
    var message = "Are you sure you want to delete this collection?";

    modalConfirm({
        message: message,
        width: "400px",
        height: "200px",
        buttons: {
            "Yes": function() {
                $.post("/getJSONData.aspx?m=Collection&builder=DeleteCollection", { collectionID: collectionID }, function (data) {
                    if (data.code == "OK") {
                        goToCollections();
                    }
                }, "json");
                closeModal();
            },
            "No": function() {
                closeModal();
            }
        }
    });
}

function addNewCollection() {
    window.savingModal('Saving');
    var collectionValues = {
        collectionName: $("#collectionName").val(),
        collectionOverview: $("#collectionOverview").val()
    };
    $.post("/getJSONData.aspx?builder=CreateNewUserCollection", collectionValues, function (data3) {
        if (data3.code == "SUCCESS") {
            var catalogId = data3.data;
            pageChange('catalogID=' + catalogId);
            closeModal();
        }
    }, "json");
}

function matchTitlesToCollections(sku, priorities, compTitles, markupNotes, tags, mailingId, doEditCollection) {
    //Get Catalogs In and Catalogs Out
    var collections_In = getItemsWithClassIntoString('addCollectionOption', 'box_checked', 'catalogID');
    var markups;
    var catalogs = { collections_In: collections_In };

    var doCopyPriorities = $(priorities).hasClass('box_checked');
    var doCopyCompTitles = $(compTitles).hasClass('box_checked');
    var doCopyMarkupNotes = $(markupNotes).hasClass('box_checked');
    var doCopyTags = $(tags).hasClass('box_checked');

    if ( doCopyPriorities || doCopyCompTitles || doCopyMarkupNotes || doCopyTags){
        $.getJSON("/getJSONData.aspx?builder=GetMarkupsFromCatalogID", catalogs, function (data) {
            if(data.code == "SUCCESS"){
                markups = data.data;
                openSelectMarkupsModal(markups, sku, mailingId, "Please select which markups to override in each collection.");
            }
            else if (data.code == "NOSELECTION") {
                AddToOrRemoveFromCollection(sku, priorities, compTitles, markupNotes, tags, mailingId, false, false, doEditCollection);
            }
        });
    }
    else{
        AddToOrRemoveFromCollection(sku, priorities, compTitles, markupNotes, tags, mailingId, false, false, doEditCollection);
    }
}

    function AddToOrRemoveFromCollection(sku, priorities, compTitles, markupNotes, tags, mailingId, doCloseModalFirst, doRemove, doEditCollection){
        if (doCloseModalFirst) {
            closeModal();
        }

        window.savingModal('Saving');

        var collections_In = getItemsWithClassIntoString('addCollectionOption', 'box_checked', 'catalogID');
        var collections_Out = [];
        if (doRemove) {
            collections_Out = collections_In;
            collections_In = [];
        }
        var targetMailingIds = getItemsWithClassIntoString('markupSelectionOption', 'box_checked', 'data-mailingId');

        var doCopyPriorities = $(priorities).hasClass('box_checked');
        var doCopyCompTitles = $(compTitles).hasClass('box_checked');
        var doCopyMarkupNotes = $(markupNotes).hasClass('box_checked');
        var doCopyTags = $(tags).hasClass('box_checked');

        var mode = "singleTitle";

        if (sku == "All") {
            skuList = getSelectedItems();
            skuList = skuList.join(",");
            mode = "multipleTitle";
        } else {
            skuList = sku;
        }

        if ($("#createNewCollection").hasClass("box_checked") && $("#collectionName").val() != "" && !doRemove) {
            var collectionValues = {
                collectionName: $("#collectionName").val(),
                collectionOverview: $("#collectionOverview").val()
            };
            $.post("/getJSONData.aspx?builder=CreateNewUserCollection", collectionValues, function (data3) {
                if (data3.code == "SUCCESS") {
                    collections_In += "," + data3.data;
                    var values = {
                        CatalogsIn: collections_In,
                        CatalogsOut: collections_Out,
                        targetMailingIds: targetMailingIds,
                        skus: skuList,
                        doCopyPriorities: doCopyPriorities,
                        doCopyCompTitles: doCopyCompTitles,
                        doCopyMarkupNotes: doCopyMarkupNotes,
                        doCopyTags: doCopyTags,
                        sourceMailingID: mailingId
                    };
                    $.post("/getJSONData.aspx?builder=AddToCollection", values, function (data2) {
                        if (data2.code == "SUCCESS") {
                            var collectionInfo = getCollectionInfoIfAddedToSingleCollection(collections_In);

                            closeSavingModal();
                            closeModal();

                            if (mode == "singleTitle") {
                                $(".myCollections_" + sku).html(data2.data);
                                if (data2.data > 0) {
                                    if (!$(".myCollections_" + sku).hasClass("hidden")) {
                                        $(".myCollections_" + sku).show();
                                    }
                                    if ($(".simpleCollections_" + sku).length > 0) {
                                        $(".simpleCollections_" + sku).show()
                                    }
                                } else {
                                    $(".myCollections_" + sku).hide();
                                    if ($(".simpleCollections_" + sku).length > 0) {
                                        $(".simpleCollections_" + sku).hide()
                                    }
                                }
                                if (doEditCollection) {
                                    goToEditCollection(collectionInfo);
                                }
                            } else {
                                //Loop Through and Replace values in myCollections for each visible SKU
                                $.post("/getJSONData.aspx?builder=RefreshCollectionTotals", { skus: skuList }, function (data) {
                                    if (data && data.length) {
                                        for (var i = 0; i < data.length; i++) {
                                            if ($(".myCollections_" + data[i].text).length > 0) {
                                                $(".myCollections_" + data[i].text).html(data[i].data);
                                                if (data[i].data > 0) {
                                                    if (!$(".myCollections_" + data[i].text).hasClass("hidden")) {
                                                        $(".myCollections_" + data[i].text).show();
                                                    }
                                                    if ($(".simpleCollections_" + data[i].text).length > 0) {
                                                        $(".simpleCollections_" + data[i].text).show()
                                                    }
                                                } else {
                                                    $(".myCollections_" + data[i].text).hide();
                                                    if ($(".simpleCollections_" + data[i].text).length > 0) {
                                                        $(".simpleCollections_" + data[i].text).hide()
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    if (doEditCollection) {
                                        goToEditCollection(collectionInfo);
                                    }
                                }, "json");
                            }
                        }
                        else{
                            closeSavingModal();
                            alert(data2.text);
                        }
                    }, "json");
                }
            }, "json");
        } else {
            var values = {
                CatalogsIn: collections_In,
                CatalogsOut: collections_Out,
                targetMailingIds: targetMailingIds,
                skus: skuList,
                doCopyPriorities: doCopyPriorities,
                doCopyCompTitles: doCopyCompTitles,
                doCopyMarkupNotes: doCopyMarkupNotes,
                doCopyTags: doCopyTags,
                sourceMailingID: mailingId
            };
            
            $.post("/getJSONData.aspx?builder=AddToCollection", values, function (data) {
                if (data.code == "SUCCESS") {
                    var collectionInfo = getCollectionInfoIfAddedToSingleCollection(collections_In);

                    closeModal();
                    closeSavingModal();

                    if (mode == "singleTitle") {
                        $(".myCollections_" + sku).html(data.data);
                        if (data.data > 0) {
                            if (!$(".myCollections_" + sku).hasClass("hidden")) {
                                $(".myCollections_" + sku).show();
                            }
                            if ($(".simpleCollections_" + sku).length > 0) {
                                $(".simpleCollections_" + sku).show()
                            }
                        } else {
                            $(".myCollections_" + sku).hide();
                            if ($(".simpleCollections_" + sku).length > 0) {
                                $(".simpleCollections_" + sku).hide()
                            }
                        }
                        if (doEditCollection) {
                            goToEditCollection(collectionInfo);
                        }
                    } else {
                        //Loop Through and Replace values in myCollections for each visible SKU
                        $.post("/getJSONData.aspx?builder=RefreshCollectionTotals", { skus: skuList }, function (data) {
                            if (data && data.length) {
                                for (var i = 0; i < data.length; i++) {
                                    if ($(".myCollections_" + data[i].text).length > 0) {
                                        $(".myCollections_" + data[i].text).html(data[i].data);
                                        if (data[i].data > 0) {
                                            if (!$(".myCollections_" + data[i].text).hasClass("hidden")) {
                                                $(".myCollections_" + data[i].text).show();
                                            }
                                            if ($(".simpleCollections_" + data[i].text).length > 0) {
                                                $(".simpleCollections_" + data[i].text).show()
                                            }
                                        } else {
                                            $(".myCollections_" + data[i].text).hide();
                                            if ($(".simpleCollections_" + data[i].text).length > 0) {
                                                $(".simpleCollections_" + data[i].text).hide()
                                            }
                                        }
                                    }
                                }
                            }
                            if (doEditCollection) {
                                goToEditCollection(collectionInfo);
                            }
                        }, "json");
                    }
                }
                else{
                    closeSavingModal();
                    alert(data.text);
                }
            }, "json");
        }
    }

    // Presentation Mode Functions
    function changePresentationImage(pageNumber, sku) {
        $(".presNav" + sku).removeClass("extraBold");
        var activeFrame = $(".activeFrame" + sku).html();
        var inactiveFrame = $(".inactiveFrame" + sku).html();
        var imagePath = $(".presentationImagePath" + sku).html();
        $(".pictureFrame" + sku + inactiveFrame).css("background-image", "url('" + imagePath + $('.presentationPage' + sku + pageNumber).html() + "?height=450')");
        $(".pr_selectedPage" + sku).html(pageNumber);
        $('.pictureFrame' + sku + activeFrame).fadeOut(1, function () {
            $('.pictureFrame' + sku + inactiveFrame).fadeIn(100);
            $(".activeFrame" + sku).html(inactiveFrame);
            $(".inactiveFrame" + sku).html(activeFrame);
        });
        $(".presNav" + sku + pageNumber).addClass("extraBold");
    }

    function focusNext(sku) {
        var focusSection = $(".pr_selectedPage" + sku).html() * 1;
        if (focusSection == $("#pr_totalPages" + sku).val() - 1) {
            changePresentationImage(0, sku);
        } else {
            changePresentationImage(focusSection + 1, sku);

        }
    }
    function focusPrevious(sku) {
        var focusSection = $(".pr_selectedPage" + sku).html() * 1;
        if (focusSection == 0) {
            changePresentationImage($("#pr_totalPages" + sku).val() - 1, sku);
        } else {
            changePresentationImage(focusSection - 1, sku);
        }
    }

    function loadTitleFrame_Basic(sku) {
        $.url = "/GetTreelineControl.aspx?controlName=/uc/listviews/TitleFrame_Basic.ascx&sku=" + sku;
        $("#stripPresentation" + sku).addClass("hidden");
        $("#titleFrame_Presentation" + sku).remove();
        $("#titleFrame_Basic" + sku).removeClass("hidden");
    }

    function loadTitleFrame_Presentation(sku) {
        if ($("#stripPresentation" + sku).hasClass("hidden")) {
            $.url = "/GetTreelineControl.aspx?controlName=/uc/listviews/TitleFrame_Presentation.ascx&sku=" + sku + "&source=lv";
            $("#stripPresentation" + sku).removeClass("hidden");
            $("#titleFrame_Basic" + sku).addClass("hidden");
            $(".legacyContainer", $("#as_" + sku)).addClass("hidden");
            $("#presentationHolder" + sku).load($.url);
        } else {
            $(".legacyContainer", $("#as_" + sku)).removeClass("hidden");
            loadTitleFrame_Basic(sku);
        }
    }

    function saveMarkupPotential(mailingId, sku, potential) {
        $("#markupPotential" + sku).css("background-color", "#FC601F");
        $.getJSON("/GetJSONData.aspx?builder=SetMarkupPotential", { sku: sku, potential: potential, mailingID: mailingId }, function (data) {
            if (data.code == "OK") {
                $("#markupPotential" + sku).css("background-color", "#FFF");
                $("#poError_" + sku).hide();
                $("#poSave_" + sku).hide();
                $("#markupPotential" + sku).val(data.data);
            }
            else {
                if (data.code == "numeric") {
                    $("#poError_" + sku).show();
                } else {
                    alert(data.text);
                }
            }

        });
    }

    function toggleCheckBox(element) {
        if ($(element).hasClass("box_checked")) {
            $(element).removeClass("box_checked").addClass("box_unchecked");
        } else {
            $(element).addClass("box_checked").removeClass("box_unchecked");
        }
    }

    function changeOrderStatus(elem, orderId, resultType, orderStatus) {
        var status = !_.isNil(elem) ? elem.attr("data-Status") : orderStatus;
        if (_.isNil(status)) {
            return;
        }

        $.getJSON("/GetJSONData.aspx?builder=ChangeOrderStatus", { orderList: orderId, newStatus: status }, function() {
                $("#as_" + orderId).parent().slideUp();
                removeListViewItem(orderId);
                updateRefineFilterCounts();
                adjustTotalResultsCount(-1);

                var activeOrdersResultType = "50",
                    completedOrdersResultType = "51";
            
                if (status === "3") {
                    adjustResultTypeCount(activeOrdersResultType, -1);
                    adjustResultTypeCount(completedOrdersResultType, 1);
                } else {
                    adjustResultTypeCount(activeOrdersResultType, 1);
                    adjustResultTypeCount(completedOrdersResultType, -1);
                }
        });
    }

    function setOrderLineItemMode(exportType) {
        var BOOKSCAPE = '12';
        var SQUAREONE = '1';
        var IS_PUBLISHER = false;
        if ((exportType == BOOKSCAPE || exportType == SQUAREONE) && !IS_PUBLISHER) {
            o.setStoreMultiLineMode(true);
        } else {
            o.setStoreMultiLineMode(false);
        }
    }

    function SaveOrganizationPreference(type, name, value, callbackFunction) {
            $.getJSON("/getJSONData.aspx?builder=SaveOrganizationPreference", { type: type, name: name, value: value },
                function (data) {
                    if (typeof callbackFunction === "function") {
                        callbackFunction(data);
                    }
                });
        }

        function SearchEditItem(orderId, mode) {
            $("body").trigger("orderAlert", [
                orderId,
                function () {
                    if (!mode)
                        mode = 0;

                    $.url = '/GetTreelineControl.aspx?controlName=/uc/search/searchSku.ascx&orderID=' + orderId + '&mode=' + mode;

                    if (mode == 1)
                        $.title = getRes("add_item_record");
                    else
                        $.title = getRes("add_export_record");

                    var buttonList = {};

                    buttonList[getRes("close")] = function () {
                        closeModal();
                        if ($.orderDirty == true)
                            $('#exportContent').trigger("mappingUpdated");
                    };

                    openModal($.url, "500px", "100px");
                }
            ]);
        }

        function SaveOrderRecordChanges(orderID, changes, isNew, OrderOrgID, DupCheck, sortBy, sortDirection, mode, sku) {
            if (changes.length > 0) {
                window.savingModal('Saving');

            var exportType = "";
            var reportname = "";
            if($('#exportType').attr("val")){
                var exportInfo = $('#exportType').attr("val").split("~");
                var exportType = exportInfo[0];
                var reportname = exportInfo[1];
            }

            var values = {
                changes: JSON.stringify(changes),
                orderID: orderID,
                isNew: isNew,
                OrderOrgID: OrderOrgID,
                DupCheck: DupCheck,
                sortBy: sortBy,
                sortDirection: sortDirection,
                reportName: reportname
            };

            $.post("/getJSONData.aspx?builder=SaveOrderEdits", values, function (data) {
                closeSavingModal();

                if (data.code) {
                    if (data.code == "NEW") {
                        $('#addSKUIcon').webuiPopover('destroy');
                        if(typeof loadExportPreview === "function"){
                            loadExportPreview($("#curStartRow").val());
                        }
                        closeModal();
                    } else if (data.code == "ERROR") {
                        $('#message').html('<div class="error" style="clear:both;width:100%;color:Red;font-weight:bold;">' + data.text + '</div>');
                    } else if (data.code == "duplicate") {
                        if (confirm(data.text)) {
                            saveOrderExportRecord(false, mode);
                        }
                        closeModal();
                    } else {
                        $.orderDirty = true;
                    }
                } else {
                    if (typeof loadExportPreview === "function") {
                        loadExportPreview($("#curStartRow").val());
                    }

                    if (typeof window.UpdateListRow == "function") {
                        window.UpdateListRow(data);
                    }

                    if (typeof window.refreshMessages == 'function') {
                        window.refreshMessages();
                    }

                    if (getListViewProperty("itemType") === 1) {
                        closeModal();
                }
            }
            }, "json");
    }
    }

    function ProductEditRecord(id, orderID, referenceNumber, exportType, sku, index, field, value, isDynamic, isSKULevelOverride) {
        this.id = id;
        this.orderID = orderID;
        this.referenceNumber = referenceNumber;
        this.exportType = exportType;
        this.sku = sku;
        this.index = index;
        this.field = field;
        this.value = value;
        this.mappingCode = null;
        this.mappingFromCode = null;
        this.mappingIsPermanent = null;
        this.isDynamic = isDynamic;
        this.errorCode = null;
        this.isSKULevelOverride = isSKULevelOverride;
    }

             function removeComp(sku, compsku, targetOrg, mailingId, catalogID) {
                 $("#markUpComp_" + sku).html("Saving. Please wait...");
                 $.post("/getJSONData.aspx?m=CompProduct&builder=RemoveCompTitles", { sku: sku, compsku: compsku, org: targetOrg, mailingID: mailingId, catalogID: catalogID },
                 function (data) {
                     if (data.code == "SUCCESS") {
                         var cbd = $(".cbd").length
                         if (cbd == 0) {
                             renderCompDetail(sku, 0, 0, mailingId);
                         } else {
                             renderCompDetail(sku, 0, 1, mailingId);
                         } 

                         if (sku === compsku && $("#compToSelf")) {
                             $("#compToSelf" + sku).show();
                         }
                         $(".comp-add-" + compsku + "-to-" + sku).show();
                     }
                     else {
                         alert(data.text);
                     }
                 }, "json");
             }

        function ActivateLineItemDept(sku, storeId, lineItem) {
            $(".inputCatLoc").each(function () {
                var inputId = $(this).attr("id");

                LoadCategories(inputId, storeId, sku, lineItem);

                     var key = inputId.replace("inputCatLoc_", ""),
                         currentCategory = $(".catLoc_" + key).html(),
                         hasCategory = currentCategory != '' && currentCategory != 'Add Category',
                    categoryValue = hasCategory ? currentCategory : "";

                $(this).val(categoryValue);
            });

                $(".inputCatLoc").first().select().focus();
            }

                 function LoadCategories(autoid, storeId, sku, lineItem) {
                     if (storeId != undefined && $("input#Department_Categories").data("storeID") == storeId) {
                         LoadDepartments(autoid, sku, storeId, lineItem);
                     } else {
                         $("input#Department_Categories").val("");

                    var passedStore = storeId;
                    if (storeId == "All") {
                        passedStore = "";
                    }
                    $.get("/getJSONData.aspx?builder=GetStoreCategories", { storeID: passedStore }, function (data) {
                        if (data != "EMPTY") {
                            if ($('#Department_Categories').length == 0)
                                $('body').append("<input type='hidden' value='' id='Department_Categories' />");
                            $("input#Department_Categories").data("storeID", storeId);
                            $("input#Department_Categories").val(data);

                                 LoadDepartments(autoid, sku, storeId, lineItem);
                             }
                         });
                     }

                     $('#Cat_Dept_Auto_Loading').hide();
                 }
                 function LoadDepartments(autoid, sku, storeId, lineItem) {
                     var data = $("input#Department_Categories").val();
                     if (data) {
                         var list = data.split("~");
                         $("#" + autoid).autocomplete(list, {
                             matchContains: true,
                             max: 200
                         }).result(function (event) {
                             event.stopPropagation();
                             saveCategories(sku, storeId, lineItem, true);
                             return false;
                         });
                     }
                 }


            function AddUserCompTitle(sku, compSku) {
                $.getJSON("/getJSONData.aspx?builder=AddUserCompTitles&sku=" + sku + "&CompSkus=" + compSku,
                             function(data){                               
                                 if (data.code == "SUCCESS") {
                                     $("#cw_" + compSku).remove();
                                     $("#compTitles_" + sku).html($("#compTitles_" + sku).html() * 1 + 1);
                                     var id = "comps_1_" + sku;
                                     $.url = "/GetTreelineControl.aspx?controlName=/uc/product/CompsBasic.ascx&sku=" + sku + "&idPrefix=" + id;
                                     $('#' + id).load($.url);
                                     closeChildModal();
                                     closeModal();
                                 }
                                 else
                                 {
                                     alert(data.text);
                                 }
                             }, "json"); 
 
            }

            function RestoreUserCompTitle(sku, compSku, mailingID) {
                $.getJSON("/getJSONData.aspx?builder=RestoreUserCompTitles&sku=" + sku + "&CompSkus=" + compSku,
                             function(data){                               
                                 if (data.code == "SUCCESS") {
                                     $("#cw_" + compSku).remove();
                                     $("#compTitles_" + sku).html($("#compTitles_" + sku).html() * 1 + 1);
                                     var id = "comps_1_" + sku;
                                     $.url = "/GetTreelineControl.aspx?controlName=/uc/product/CompsBasic.ascx&sku=" + sku + "&idPrefix=" + id + "&mailingID=" + mailingID;
                                     $('#' + id).load($.url);
                                     closeModal();
                                 }
                                 else
                                 {
                                     alert(data.text);
                                 }
                             }, "json"); 
 
            }

            function RemoveUserCompTitle(sku, compSku) {
                $.post("/getJSONData.aspx?builder=RemoveUserCompTitles", { sku: sku, compSku: compSku },
                function (data) {
                    if (data.code == "SUCCESS") {
                        $("#cw_" + compSku).remove();
                        $("#compTitles_" + sku).html($("#compTitles_" + sku).html() * 1 - 1);
                        $("#compsHidden_" + sku).html($("#compsHidden_" + sku).html() * 1 + 1)
                        if ($("#compsHidden_" + sku).html() * 1 > 0) {
                            $("#compsHidDiv_" + sku).show();
                        } else {
                            $("#compsHidDiv_" + sku).hide();
                        }
                        var cbd = $(".cbd").length
                        var mailingId = getListViewProperty("selectedMailingID");
                        $(".comp-add-" + compSku + "-to-" + sku).show();

                        if (cbd == 0) {
                            renderCompDetail(sku, 0, 0, mailingId);
                             } else {
                                 renderCompDetail(sku, 0, 1, mailingId);
                             } 
                         }
                         else {
                             alert(data.text);
                         }
                     }, "json");
                 }

                 function ClearDashboardValue(resultType, itemId) {
                     $(itemId > 0 ? "#value_" + resultType + "_" + itemId : "#value_" + resultType).html("...");
                 }

                 function ClearDashboardValues(resultTypes) {
                     if (!resultTypes) return;

                     for (var i = 0, max = resultTypes.length; i < max; i++) {
                         ClearDashboardValue(resultTypes[i], 0);
                     }
                 }

                 function GetDashboardValue(resultType, itemId, dashboardType) {
                     var url = "/GetTreelineControl.aspx?controlName=/uc/dashboard/controls/Dashboard_BallValue.ascx&resultType=" + resultType + "&itemID=" + itemId;
                     if (dashboardType != null)
                         url += "&dashboardType=" + dashboardType;

                     if (itemId > 0) {
                         $("#value_" + resultType + "_" + itemId).load(url);
                     } else {
                         $("#value_" + resultType).load(url);
                     }
                 }

                 function GetResultValue(resultType, itemId) {
                     var url = "/GetTreelineControl.aspx?controlName=/uc/dashboard/controls/Dashboard_BallValue.ascx&resultType=" + resultType + "&itemID=" + itemId;

                     var elemSuffix = resultType;
                     if (itemId > 0) {
                         elemSuffix = resultType + "_" + itemId;
                     };
                     $("#value_" + elemSuffix).load(url, function () {
                         if (+$("#value_" + elemSuffix).html() !== 0) {
                             $("#valueHolder_" + elemSuffix).show();
                         }
                     });
                 }

                 function updateDashboardHeader(dashboardType) {
                     var values = {
                         dashboardType: dashboardType
                     }

                     $.getJSON("/GetJSONData.aspx?builder=GetResultTypeCounts", values, function (data) {
                         if (data.code === "SUCCESS") {
                             var counts = JSON.parse(data.data);
                             $.each(counts, function (key, value) {
                                 updateHeader(dashboardType, value.visible);
                                 updateHiddenHeader(dashboardType, value.hidden);
                             });
                         }
                     });
                 }
                 function GetDashboardValues(resultTypes, dashboardType) {
                     if (!resultTypes) return;

                     for (var i = 0, max = resultTypes.length; i < max; i++) {
                         GetDashboardValue(resultTypes[i], 0, dashboardType);
                     }
                 }

                 function SaveResultTypeTimeFrame(resultType, days, dashboardType) {
                     var selectedResultType = getListViewProperty("resultType");
                     if ($("#value_" + resultType).length > 0) {
                         $("#value_" + resultType).html("...");
                     }
                     adjustTimeBoxes(days)
                     $.getJSON("/getJSONData.aspx?builder=SaveUserPreference", { type: 'dashboard', name: 'days_' + resultType, value: days },
                         function () {
                             var timeframeString = $("#timeString_" + days).text();

                             $("#timeChange_" + resultType)
                                .attr("data-days", days)
                                .attr('title', timeframeString);

                             $("#timeString_" + resultType).html(timeframeString);
                             $("#timeframeString_" + selectedResultType).val(timeframeString);
                             $("#timeframeDays_" + selectedResultType).val(days);

                             if ($("#meVal_" + resultType).length > 0) {
                                 GetMyEdelweissValue(resultType);
                             }


                             window.GetDashboardValuePlusRefresh(resultType, dashboardType);
                             if ($("#source_typeOfList_" + dashboardType).val() === '0') {
                                     ///If time frame is switched from Dashboard Options
                                     if ($("#timeString_" + resultType).length && resultType == selectedResultType) {
                                         $("#resultName_" + dashboardType).html($("#displayText_" + resultType).val() + " " + $("#timeString_" + resultType).html());
                                         if (dashboardType == 3) {
                                             refreshDashboardCloud(resultType, window.loadingText);
                                         } else {
                                             if ($("#value_" + resultType).html() != 0) {
                                                 refreshThumbnails(resultType, dashboardType, $.trim($("#value_" + resultType).html()));
                                             } else {
                                                 $("#dashContent_" + dashboardType).html("");
                                             }
                                         }
                                     }
                             } else if (resultType == selectedResultType) {
                                 window.changeHomePageOption(getListViewProperty("resultType"), getListViewProperty("dashboardType"), null, true);
                             }  


                             if ($("#cSelected_shared").length > 0) {
                                 $("#cSelected_shared").html("-");
                                 $.url = "/GetTreelineControl.aspx?controlName=/uc/dashboard/controls/Dashboard_BallValue.ascx&resultType=77&targetOrgID=" + $("#cSelected_orgID").val() + "&targetUserID=" + $("#cSelected_userID").val();
                                 $("#cSelected_shared").load();
                             }
                             closeChildModal();
                         });
                     }

                     function GetDashboardValuePlusRefresh(resultType, dashboardType) {
                         var url = "/GetTreelineControl.aspx?controlName=/uc/dashboard/controls/Dashboard_BallValue.ascx&resultType=" + resultType;
                         if (dashboardType != null)
                             url += "&dashboardType=" + dashboardType;

                         $("#value_" + resultType).load(url, function() {
                             var val = $.trim($("#value_" + resultType).html());
                             var dashType;
                             if ($("#myCheck_" + resultType).length > 0) {
                                 dashType = $("#myCheck_" + resultType).attr("data-dashType");
                             } else {
                                 dashType = $("#value_" + resultType).attr("data-dashType");
                             }
                         });
                     }

                     function GetMyEdelweissValue(resultType) {
                         $.url = "/GetTreelineControl.aspx?controlName=/uc/dashboard/controls/Dashboard_BallValue.ascx&resultType=" + resultType;
                         $("#meVal_" + resultType).load($.url, function() {
                             var val = $.trim($("#meVal_" + resultType).html());
                             var dashType;
                             dashType = $("#value_" + resultType).attr("data-dashType");
                             if (dashType != 3) {
                                 if (val == 0) {
                                     $("#me_" + resultType).addClass("hidden");
                                     $("#me_" + resultType).removeClass("shown");
                                     $("#dashContent_" + dashType).html("");
                                 } else {
                                     $("#me_" + resultType).addClass("shown");
                                     $("#me_" + resultType).removeClass("hidden");
                                     $("#dash_" + dashType).show();
                                     $("#noVal_" + dashType).hide();
                                 }
                             }
                             if ($("#value_" + resultType).length == 0) {
                                 var dashType;
                                 if ($("#myCheck_" + resultType).length > 0) {
                                     dashType = $("#myCheck_" + resultType).attr("data-dashType");
                                 } else {
                                     dashType = $("#value_" + resultType).attr("data-dashType");
                                 }
                                 if ($("#selectedResult_" + dashType).length > 0) {
                                     if ($("#selectedResult_" + dashType).val() == resultType) {
                                         populateResultOptionsRefresh(resultType, dashType, val);
                                     }
                                 }
                             }
                         });
                     }

                     function saveResultType(resultType, dashType, value, displayName, itemCount) {
                         $(".dashSection" + dashType).removeClass("selectedResultType");
                         $("#dash_" + resultType).addClass("selectedResultType");
                         if (value == null) value = resultType;
                         if (displayName != null || $("#value_" + resultType).html() != "0") {
                             if (resultType == "204") {
                                 $("#resequenceWorklistIcon").show();
                             } else {
                                 $("#resequenceWorklistIcon").hide();
                             }
                             $.getJSON("/getJSONData.aspx?builder=SaveUserPreference", { type: 'dashboard', name: 'resultTypes_' + dashType, value: value },
                            function() {
                                $("#dash_" + dashType).show();
                                $("#noVal_" + dashType).hide();
                                if (dashType == window.dashType.tag) {
                                    if ($("#tempList1").length > 0) {
                                        $("#tempList1").html("");
                                        $("#tempList2").html("");
                                    }
                                    populateResultOptionsTags(resultType);
                                } else {
                                    populateResultOptionsFull(resultType, dashType, displayName, itemCount);
                                }
                                resizePublisherScroller();
                            });
                        }
                    }

    function populateResultOptionsFull(resultType, dashType, displayName,itemCount) {
        if (itemCount == null) itemCount = $("#value_" + resultType).html();
        itemCount = $.trim(itemCount);
        if (displayName == null) {
            displayName = $("#displayText_" + resultType).val()
        }
        if ($("#timeframeString_" + resultType).length) {
            var timeframeString = $("#timeframeString_" + resultType).val();
            displayName += " " + timeframeString;
        }
        $("#resultName_" + dashType).html(displayName);
        if ($("#headerCount_" + dashType).length > 0) {
            $("#headerCount_" + dashType).html(itemCount);
            $("#resultCount_" + dashType).val(itemCount);
        }
        if ($("#selectedResult_" + dashType).length > 0) {
            $("#selectedResult_" + dashType).val(resultType);
        } else {
            closeModal();
        }

        if ($("#source_typeOfList_" + dashType).val() === '0') {
                            var val = $.trim($("#value_" + resultType).html())
                            if (val != 0) {
                                refreshThumbnails(resultType, dashType, val);
                            } else {
                                $("#dashTitles_" + dashType).html("");
                            }
                        } else {
                            window.pageChange('#dashList=' + dashType + '&rT=' + resultType + '&start=0');
                            window.closePop();
                        }
                    }
                    function loadDash(dashType){
                        changePage('#dashList=' + dashType);
                    }
                    function populateResultOptionsRefresh(resultType, dashType, count) {
                        if ($("#headerCount_" + dashType).length > 0) {
                            $("#headerCount_" + dashType).html(count);
                            $("#resultCount_" + dashType).val($("#headerCount_" + dashType).html());
                        }
                        if ($("#source_typeOfList_" + dashType).val() === '0') {
                            var val = $.trim($("#value_" + resultType).html())
                            refreshThumbnails(resultType, dashType, val);
                        } else {
                            window.changePage('#dashList=' + dashType + '&rT=' + resultType + '&start=0');
                            window.closePop();
                        }
                    }
                    function callRestService(uri, _onSuccess, _onFailure) {
                        $.ajax({
                            type: 'GET',
                            url: uri,
                            async: true,
                            success: function (data) {
                                if (typeof _onSuccess == 'function') 
                                    _onSuccess(data);
                            },
                            error: function (xhr, ajaxOptions, thrownError) {
                                if (typeof _onFailure != 'function') 
                                    console.warn("There was an error loading " + uri) + " error:" + thrownError; 
                                else
                                    _onFailure();
                            },
                            datatype: 'json'
                        });
                    }
                    function refreshThumbnails(resultType, dashType, val) {
                        //$("#dash_" + dashType).css("height", $("#naturalHeight_" + dashType).val() + "px");
                        if (dashType == '2') {
                            if (window.catDisplay == 0) {
                                window.populateCatalogs(resultType, dashType, 0, $("#resultCount_" + dashType).val());
                            } else {
                                window.populateCatalogsList(resultType, dashType, 0, $("#resultCount_" + dashType).val());
                            }
                        }
                        if (dashType == '9' || dashType == '0' || dashType == '1') {
                            window.populateTitles(resultType, dashType, val, $("#naturalHeight_" + dashType).val(), $("#resultCount_" + dashType).val());
                        }
                        if (dashType == '6') {
                            window.populateOrders(resultType, dashType, $("#resultCount_" + dashType).val());
                        }
                        if (dashType == '5') {
                            window.populatePeople(resultType, dashType, $("#resultCount_" + dashType).val());
                        }
                        if (dashType == '12'){
                            window.populatePubilicityCampaigns(resultType, dashType, $("#resultCount_" + dashType).val());
                        }
                        if (dashType == '50'){
                            window.populateReviews(resultType, dashType, $("#resultCount_" + dashType).val());
                        }
                    }

                    function refreshMyPublishers(){
                        savingModalOverlay('Refreshing...', "dash_myPublisher");
                        var url = "/GetTreelineControl.aspx?controlName=/uc/dashboard/myPublisherScroller.ascx";
                        $("#dash_myPublisher").load(url)
                    }

                    (function ($) {
                        $.event.special.destroyed = {
                            remove: function (o) {
                                if (o.handler) {
                                    o.handler();
                                }
                            }
                        }
                    })(jQuery);

                    function RenameContactGroup(groupID){
                        var newName =  $("#cSelected_groupName").val()
                        if (newName != ''){
                            $.getJSON("/getJSONData.aspx?m=Contacts&builder=RenameGroups", { groupID:groupID,name:newName}, 
                                 function(data){
                                     var success = false;
                                     for (var i=0;i<data.length;i++){
                                         if (data[i].status == "SUCCESS"){
                                             var primaryId = $('#cSel_i').val();
                                             $('#c_groupName' + primaryId).html(newName);
                                             $('#groupNameSave').hide();
                                             success = true;
                                         }
                                         else if (data[i].status == "ERROR"){
                                             alert("There was a problem renaming the group.");
                                         }
                                     }
                                 });
                        }
                    }

                    function removeContactFromGroup(contactId, groupId) {
                        var groupName = $("#cSelected_groupName").val();
                        $.getJSON("/getJSONData.aspx?m=Contacts&builder=RemoveContactFromGroup", { contactID:contactId,groupID:groupId,tags:groupName}, 
                                 function(data) {
                                     if (data.code == "OK"){
                                         var primaryId = $('#cSel_i').val();
                                         $('#cG_' + contactId).remove();
                                         $('#c_groupCount' + primaryId).html($('#c_groupCount' + primaryId).html() * 1 - 1);
                                         success = true;
                                     }
                                     else if (data.code == "ERROR"){
                                         alert("There was a problem renaming the group.");
                                     }
                                 });
                    }

                    function addContactToGroupId(contactId, groupId) {
                        var groupName = $("#cSelected_groupName").val();
                        $.getJSON("/getJSONData.aspx?m=Contacts&builder=AddContactToGroupId", { contactID:contactId,groupID:groupId,groupName:groupName}, 
                                 function(data) {
                                     if (data.code == "OK"){
                                         var primaryId = $('#cSel_i').val();
                                         $('#cGQuick_' + contactId).remove();
                                         $('#c_groupCount' + primaryId).html($('#c_groupCount' + primaryId).html() * 1 + 1);
                                         $.url = "/GetTreelineControl.aspx?controlName=/uc/contacts/details/contactGroupDetail.ascx&GroupID=" + groupId + "&primaryId=" + primaryId;
                                         $("#contactDetails").load($.url);
                                         success = true;
                                     }
                                     else if (data.code == "ERROR"){
                                         alert("There was a problem renaming the group.");
                                     }
                                 });
                    }

                    function populateAnalyticsCharts(dashType) {
                        $("#chart_" + dashType + "_0").html("")
                        $.url = "/GetTreelineControl.aspx?controlName=/uc/analytics/dashContent/AnalyticsChart_" 
                            + dashType + ".ascx&source=mainDash";
                        $("#chart_" + dashType + "_0").load($.url);
                    }

                    function saveLocationPreference(locationId) {
                        $.getJSON("/getJSONData.aspx?builder=SaveUserPreference", { 
                            type: 'analytics', 
                        name: 'selectedStoreID', 
                        value: locationId 
                    }, function () {
                        $.get("/api/v2/analytics/lanes", function(lanes) {
                            for (var laneKey in lanes) {                                     
                                EdelweissAnalytics.addToLocationFilters(lanes[laneKey].dashType, locationId);
                                EdelweissAnalytics.filterOptions[lanes[laneKey].dashType].stockAnalysisClass = -1;
                                var dashType = lanes[laneKey].dashType;
                                if(EdelweissAnalytics.isVisibleLane[dashType])
                                {
                                    if (laneKey === EdelweissAnalytics.LaneKeys.WeedingAnalysis) {
                                        EdelweissAnalytics.selectedWeedingType = EdelweissAnalytics.weedingType.all; 
                                    }
                                    EdelweissAnalytics.startLaneUpdateProcess(laneKey);     
                                }
                            }
                        });

                        
                        if (EdelweissAnalytics.isAggregateStore(locationId)) {
                            $("#analyticsHeaderBar-lastUpdatedDateContainer").hide();
                        } else {
                            $.get("/api/analytics/store/" + locationId + "/lastUpdatedDate", function(lastUpdateDate) {
                                $("#analyticsHeaderBar-lastUpdatedDateContainer").show();
                                $("#analyticsHeaderBar-lastUpdatedDateValue").html(lastUpdateDate);
                            });
                        }
                        
                    });
                }

    function saveDashboardViewFilter(filterID, dashboardType,  _onSuccess, _onFailure){
                    $.getJSON("/getJSONData.aspx?builder=SaveUserPreference",{type:'dashboard',name:'selectedSavedFilterId.' + dashboardType, value:filterID},
                  function(data){
                      if (data.code == "OK"){
                          if (typeof _onSuccess == "function") {
                              _onSuccess(dashboardType, filterID, data);
                          }
                      } else {
                          if (typeof _onFailure == "function") {
                              _onFailure(dashboardType, filterID, data);
                          }
                      }
                  });
                }
                function saveDashboardViewFilterCatalog(filterID, dashboardType, _onSuccess, catalogID) {
                    saveDashboardViewFilter(filterID, dashboardType);

        _onSuccess(catalogID);
    }

    function getSolrDateRange(pubDateFilterDefinition) {
        if (pubDateFilterDefinition === "frontlist") {
            var solrDateRange = "[NOW-3MONTH/DAY TO *]";
        } else if (pubDateFilterDefinition === "backlist") {
            var solrDateRange = "[* TO NOW-3MONTH/DAY]";
        } else {
            // pubDateFilter is a custom date range.
            var solrDateRange = pubDateFilterDefinition.replace("|", "");
        }
        return solrDateRange;
    }

function saveFilterPreference(filterId) {
    $.get("/api/v2/analytics/lanes", function(lanes) {
        for (var laneKey in lanes) {
            EdelweissAnalytics.clearContentFilters(lanes[laneKey].dashType);
        }
        if (filterId > 0) {
            $.getJSON("/api/filters/" + filterId, {}, function(filterObj) {
                if (filterObj.hasOwnProperty("definition")) {
                    var filterDefinitionObj = JSON.parse(filterObj.definition);
                    if (filterDefinitionObj.hasOwnProperty("pubDate")) {
                        for (var laneKey in lanes) {  
                            var pubDateFilter = getSolrDateRange(filterDefinitionObj["pubDate"]);
                            if (typeof EdelweissAnalytics.addPubDateFilter === "function") {
                                EdelweissAnalytics.addPubDateFilter(lanes[laneKey].dashType, 
                                    pubDateFilter);
                            }
                        }
                    }
                    for (var property in filterDefinitionObj) {
                        if (filterDefinitionObj.hasOwnProperty(property) && property.indexOf("refine_") === 0) {
                            for (var laneKey in lanes) {
                                EdelweissAnalytics.addToAttributeFilters(lanes[laneKey].dashType, property, 
                                    filterDefinitionObj[property]);
                            }
                        }
                    }                                    
                }
                EdelweissAnalytics.Weeding.updateSelectedWeedingSettingsWithNewSavedFilter(filterId, filterObj.name);
            }); 
        } 

        for (var laneKey in lanes) {
            var dashType = lanes[laneKey].dashType;
            if(EdelweissAnalytics.isVisibleLane[dashType])
            {
                if ($(".analyticsDetailsGrid").attr("data-lanekey") === EdelweissAnalytics.LaneKeys.TrendsAnalysis) {
                    oTable.fnDestroy();
                    $("#titleGrid").empty();
                }
                if (laneKey === EdelweissAnalytics.LaneKeys.WeedingAnalysis) {
                    EdelweissAnalytics.selectedWeedingType = EdelweissAnalytics.weedingType.all; 
                }
                EdelweissAnalytics.startLaneUpdateProcess(laneKey);
            }
        }

        // always save the filterId, whether it's greater than 0 (filter selected) or not (no filter selected).
        $.getJSON("/getJSONData.aspx?builder=SaveUserPreference", { 
            type: 'dashboard', 
            name: 'selectedSavedFilterId.200', 
            value: filterId 
        });
    });
}

        function drawStandardPie(dashType, jsonData, colors, eventName, onEventHandler, laneKey, callback, chartIndex) {
            laneKey = typeof laneKey !== "undefined" ? laneKey : null;
            callback = typeof callback !== "undefined" ? callback : null;
            chartIndex = typeof chartIndex !== "undefined" ? chartIndex : 0;

                    var stockAnalysisClass = EdelweissAnalytics.filterOptions[dashType].stockAnalysisClass;
                    if (stockAnalysisClass == -1) {
                        stockAnalysisClass = 0
                    }

                    var defaultColors = ['#92D050', '#CCFF66', '#FFEA00', '#FC601F', '#598A18'];
                    var options = {
                        backgroundColor: 'transparent',
                        chartArea: { left: '5%', top: '5%', width: '90%', height: '90%' },
                        colors: (colors === undefined) ? defaultColors : colors,
                        height: 160,
                        width: 160,
                        is3D: false,
                        fontSize: 10,
                        tooltip: { ignoreBounds: true },
                        legend: {position: 'none'},
                        sliceVisibilityThreshold: 1 / 100000,
                        slices: { 0: {offset: 0.0},
                            1: {offset: 0.0},
                            2: {offset: 0.0},
                            3: {offset: 0.0},4: {offset: 0.0},5: {offset: 0.0}}
                    };
                    var data = new google.visualization.DataTable(jsonData);
                    var isOnAnalyticsHome = $("#dash_" + dashType).length;
                    if (isOnAnalyticsHome && !EdelweissAnalytics.filterOptions[dashType].includeTitlesFromAllStockAnalysisClasses) {
                        for(i = 0;i < data.getNumberOfRows();i++){
                            if (stockAnalysisClass == i) {
                                options.slices[i] = {offset: 0.1};
                            }
                        }
                    }

                    if (laneKey !== null) {
                        var chart_div = getChartDivByLaneKeyAndChartIndex(laneKey, chartIndex);
                    } else {
                        var chart_div = getStandardPieDiv(dashType);
                    }
                    var chart = new google.visualization.PieChart(chart_div);
                    if (typeof onEventHandler === "function") {
                        google.visualization.events.addListener(chart, eventName, function() { onEventHandler(chart); });
                    }

                if (callback != null) {
                    google.visualization.events.addListener(chart, 'ready', function() {
                        return callback(null, "Pie Chart Initialization Complete");
                    });
                    google.visualization.events.addListener(chart, 'error', function() {
                        return callback(new Error("Error initializing pie chart"));
                    });
                }
                chart.draw(data, options);
        }

                function getStandardPieDiv(dashType) {
                    return document.getElementById('chartFrame' + dashType);
                }
                function getChartDivByLaneKeyAndChartIndex(laneKey, chartIndex) {
                    return document.getElementById('chartFrame' + laneKey + '_' + chartIndex);
                }

                function initializeMarkupSelect() {
                    $('.markupOptionCheck').on("click", function () {
                        window.enableMultipleCheckbox($(this), "markupOptionCheck");
                        selectMarkup($(this).attr("markupId"));
                        toggleMarkupImport($(this))
                    });
                }

                function toggleMarkupImport($markup) {
                    if ($markup.data("readonly-markup")) {
                        $("#importMarkup").hide();
                    } else {
                        $("#importMarkup").show();
                    }
                }

                function loadSingleTitle(sku, toWhere, dashType) {
                    if ($('#detailList_' + dashType).length == 0) {
                        $(".Analytics").hide();
                        $("#dash_" + dashType).show();
                        $("#analytics_content").show();
                        $("#analytics_content").html("<div style='margin-top:20px;'>Loading Details</div>");
                        $.url = "/GetTreelineControl.aspx?controlName=/uc/analytics/dashDetails/AnalyticsDetail_" + dashType + ".ascx";
                        $("#analytics_content").load($.url, function() {
                            $.url = "/GetTreelineControl.aspx?controlName=/uc/listviews/ListView.ascx&start=0&itemID=" + sku + "&resultType=101&dashboardType=0&itemType=1&dataType=communityActivity&sku=" + sku;
                        $("#" + toWhere).load($.url, function() {
                            $("#mp_ShowList").show();
                        });
                    });
                } else {
                    $.url = "/GetTreelineControl.aspx?controlName=/uc/listviews/ListView.ascx&start=0&itemID=" + sku + "&resultType=101&dashboardType=0&itemType=1&dataType=communityActivity&sku=" + sku;
                    $("#" + toWhere).load($.url);
                    $("#mp_ShowList").show();
                }
            
            }
            function showSimpleAction(suffix){
                $("#hoverSimple_" + suffix).hide()
                $(".addSimple").hide();
                $("#addSimple_" + suffix).show();
            }
            function hideSimpleAction(suffix){
                $("#addSimple_" + suffix).hide()
            }
            function addSimpleAction(suffix) {
                if ($("#addSimple_" + suffix).css("display") == "none") {
                    $(".addSimple").hide();
                    showSimpleAction(suffix);
                } else {
                    hideSimpleAction(suffix);
                }
            }

            function clickDashAction(sku, resultType, iClass) {
                if ($("." + iClass + "_" + resultType + "_" + sku).css("display") == "none") {
                    $(".addSimple").hide();
                    $("." + iClass + "_" + resultType + "_" + sku).show();
                } else {
                    $("." + iClass + "_" + resultType + "_" + sku).hide()
                }
            }


            function hoverDashAction(sku, resultType, iClass) {
                $("." + iClass + "_" + resultType + "_" + sku).show();
            }

            function closeDashAction(sku, resultType, iClass) {
                $("." + iClass + "_" + resultType + "_" + sku).hide();
            }


            function hoverSimpleAction(sku, resultType) {
                $(".hoverSimple_" + resultType + "_" + sku).show();
            }

            function closeSimpleAction(sku, resultType) {
                $(".hoverSimple_" + resultType + "_" + sku).hide();
            }

            function showDrcHover(sku, resultType)
            {
                $(".drcHover_" + resultType + "_" + sku).show();
            }

            function hideDrcHover(sku, resultType)
            {
                $(".drcHover_" + resultType + "_" + sku).hide();
            }

            function showTitleHideHover(sku, resultType)
            {
                $(".hideTitleHover_" + resultType + "_" + sku).show();
            }

            function hideTitleHideHover(sku, resultType)
            {
                $(".hideTitleHover_" + resultType + "_" + sku).hide();
            }

            function hideCatalog(catalogId, dashboardType, resultType) {
                var url = "api/me/catalogs/exclusions/" + catalogId;

                $.ajax({
                    type: "PUT",
                    url: url
                }).done(function () {
                    if (dashboardType != null) {
                        $('#thumb_' + catalogId).parent().addClass("hidden_" + dashboardType).hide();
                    } else {
                        $('#lv_' + catalogId).addClass("hidden_" + dashboardType).hide();
                    }
                }).error(function () {
                    alert("An unexpected error occurred while performing this action. Please try again or contact Above The Treeline Support.");
        });
    }
    
    function setShowHiddenTitles(contextId, dashboardType, value) {
        $.getJSON("/getJSONData.aspx?builder=SaveUserPreference", { type: 'userContext', name: 'showHidden_' + contextId, value: value }, function () {
            if (_.startsWith(window.location.hash, "#dashList")){
                loadDash(dashboardType);
            } else {
                reloadCurrentPage();
            }
        });
    }

    function updateHeader(dashboardType, visibleItems){
        $('#headerCount_' + dashboardType).html(visibleItems);
    }

    function updateHiddenHeader(dashboardType, hiddenItems){
        if (hiddenItems > 0){
            $('#hiddenCount_' + dashboardType).text(hiddenItems);
            $('.hiddenWrapper_' + dashboardType).show();
        }
        else{
            $('.hiddenWrapper_' + dashboardType).hide();
        }
    }

    function updateHideToggle(itemId, isHidden) {
        var $itemToUpdate = $('.hide_' + itemId);
        var label = "";
        if (isHidden) {
            label = $itemToUpdate.data('type') === "catalog" ? "Show Collection" : "Unhide Title";
        } else {
            label = $itemToUpdate.data('type') === "catalog" ? "Hide Collection" : "Hide Title";
        }
        $itemToUpdate.attr("title", label).toggleClass("icon-remove-icon icon-add-icon");
    }

    function unhideItem(itemId, dashboardType, resultType, onDone) {
        var url = getHideItemApiUri(resultType, itemId);
            
        if (!url) return;
        $.ajax({
            type: "DELETE",
            url: url
        }).done(function () {
            $('.simpleTags_' + itemId + '.bgdColorHidden').hide();
            if (dashboardType != null){
                $('#thumb_' + dashboardType + '_' + itemId).parent().removeClass("excluded").show();
                $('#catThumb_' + dashboardType + '_' + itemId).parent().removeClass("excluded").show();
                updateDashboardHeader(dashboardType);
                closeSavingModalOverlay("visual_" + dashboardType + "_" + itemId);
                closeSavingModalOverlay("cat_" + resultType + "_" + itemId);
            }
            else {
                $('#as_' + itemId).parent().removeClass("excluded").show();
                updateHideToggle(itemId, false);
            }
            if ($.isFunction(onDone)) {
                onDone();
            }
        }).error(function () {
            alert("An unexpected error occurred while performing this action. Please try again or contact Above The Treeline Support.");
        });
    }

    function hideItem(itemId, dashboardType, resultType, doShowHidden, onDone) {
        var url = getHideItemApiUri(resultType, itemId);
        if (!url) return;

        if (dashboardType === null) {
            var $hideTarget = $('#as_' + itemId).parent();
            if (doShowHidden == null || !doShowHidden) {
                $hideTarget.slideUp();
            }

            $hideTarget.addClass("excluded");
            updateHideToggle(itemId, true);
        }

        $.ajax({
            type: "PUT",
            url: url
        }).done(function () {
            $('.simpleTags_' + itemId + '.bgdColorHidden').show();
            if (dashboardType != null){
                $('#thumb_' + dashboardType + '_' + itemId).parent().addClass("excluded");
                $('#catThumb_' + dashboardType + '_' + itemId).parent().addClass("excluded");
                var toggle = !!dashboardExclusionFilters[dashboardType];
                toggleDashboardExclusionFilter(dashboardType, toggle);
                updateDashboardHeader(dashboardType);
                closeSavingModalOverlay("visual_" + dashboardType + "_" + itemId);
                closeSavingModalOverlay("cat_" + resultType + "_" + itemId);
            }
            
            if (_.isFunction(onDone)) {
                onDone();
            }
        }).error(function () {
            alert("An unexpected error occurred while performing this action. Please try again or contact Above The Treeline Support.");
        });
    }

    function toggleHidden(itemId, dashboardType, resultType, doShowHidden) {
        if ($("#thumb_" + dashboardType + "_" + itemId).length > 0) {
            savingModalOverlay('', "visual_" + dashboardType + "_" + itemId);
        } else if ($("#catThumb_" + dashboardType + "_" + itemId).length > 0) {
            savingModalOverlay('', "cat_" + resultType + "_" + itemId);
        }

        function reinitializeAutoComplete() {
            if (_.isFunction(window.initializeAutoComplete)) {
                window.initializeAutoComplete();
            }
        }

        var isCurrentlyHidden = false;
        if ($('#as_' + itemId).parent().hasClass("excluded") || $('#thumb_' + dashboardType + '_' + itemId).parent().hasClass("excluded") ||
            $('#catThumb_' + dashboardType + '_' + itemId).parent().hasClass("excluded")) {
            unhideItem(itemId, dashboardType, resultType, reinitializeAutoComplete);
            isCurrentlyHidden = true;
        } else {
            hideItem(itemId, dashboardType, resultType, doShowHidden, reinitializeAutoComplete);
        }
        if (!doShowHidden && !_.isNil($("#hiddenItems").html())) {
            updateHiddenCount(itemId, isCurrentlyHidden);
            removeListViewItem(itemId);
            updateRefineFilterCounts();
        }

        hideSimpleAction(resultType + '_' + itemId);
    }
    
    function updateHiddenCount(itemId, isCurrentlyHidden) {
        var currentCount = $("#hiddenItems").html().match(/[0-9]+/gi);
        var totalCount = _.parseInt($("#totalResults").html(), 10);
        var currentCountInt = 0;
        if (_.isArray(currentCount) && !_.isNaN(_.parseInt(currentCount[0], 10))) {
            currentCountInt = _.parseInt(currentCount[0], 10);
        }
        if (isCurrentlyHidden) {
            currentCountInt--;
            totalCount++;
        } else {
            currentCountInt++;
            totalCount--;
        }

        if (currentCountInt > 0) {
            $("#hiddenItems").html(templateCache.hiddenCount({ hiddenCount: currentCountInt })).show();
        } else {
            $("#hiddenItems").html("").hide();
        }
        if (!_.isNaN(totalCount)) {
            $("#totalResults").html(totalCount);
        }
    }

    function getHideItemApiUri(resultType, itemId) {
        switch(parseInt(resultType)) {
            case 22:
            case 20:
            case 21:
            case 260:
                return "api/me/galleys/availability/exclusions/" + itemId;
            case 106:
            case 108:
            case 107:
                return "api/me/buzz/exclusions/" + itemId;
            case 2001:
            case 2002:
            case 2003:
            case 2006:
                return "api/me/reviews/exclusions/" + itemId;
            case 73:
            case -1:
            case 208:
            case 207:
            case 215:
                return "api/me/catalogs/exclusions/" + itemId;
            default:
                return "";
        }
    }

        function getEPlusContextResultTypes(contextId) {
            if (!window.ePlusContextResultTypesMap || !window.ePlusContextResultTypesMap[contextId]) return null;
            return window.ePlusContextResultTypesMap[contextId];
        }

        function toggleDashboardExclusionFilter(dashboardType, doShowHidden) {
            dashboardExclusionFilters = dashboardExclusionFilters || {};
            dashboardExclusionFilters[dashboardType] = doShowHidden;

            if (doShowHidden) {
                $(".dashboardFrame" + dashboardType).slick("slickUnfilter");
            } else {
                $(".dashboardFrame" + dashboardType).slick("slickFilter", ":not(.excluded)");
            }
        }

        function changeHomePageOption(resultType, dashType, controlID, isRefresh) {
            // Exit if this option is already selected.
            if (resultType === getListViewProperty("resultType") && !isRefresh) {
                return;
            }
            window.stopLoading = getListViewProperty("resultType");

            clearFilterUi();
            window.scrollTo(0,0);
            $("#rightNavContent").fadeOut();
            $(".refineOptions").html("").slideUp();

            setListViewProperty("resultType", resultType);
            setListViewProperty("dashboardType", dashType);

            $(".homeOptionRow", $("#leftNavOptions")).removeClass("accFont").removeClass("selectedOptionRow");
            cacheResultOptionCounts();

            if (controlID != null) {
                window.stopLoading = null;
                var prefValue = $("#" + controlID).attr("data-value");
                var prefType = $("#" + controlID).attr("data-type");
                window.listView[prefType] = encodeURIComponent(prefValue);
                $("#displayText_" + resultType).val(prefValue);
            }
            
            if (resultType == 100) {
                $("#selectedOptionTimeFrame").fadeOut();
                adjustDisplayAndSavePreference($("#" + controlID).attr("data-value"));
            } else {
                if (resultType == 74 || resultType == 75 || dashType == 3) {
                    $(".listTagRow", $("#leftNavOptions")).removeClass("selectedOptionRow");
                    $("#" + controlID).addClass("selectedOptionRow");
                } else {
                    $("#homeOptionRow_" + getListViewProperty("resultType")).addClass("selectedOptionRow");
                }
                $.getJSON("/getJSONData.aspx?builder=SaveUserPreference", 
                    { type: 'dashboard', name: 'resultTypes_' + dashType, value: resultType }, 
                    function () {
                        location.hash = updateUriHashParameter(location.hash, "page", 1);

                        if (controlID != null) {
                            $("#selectedOptionTimeFrame").fadeOut();
                            reloadList(getListViewProperty("resultType"), null, true);
                        } else {
                            reloadCurrentPage();
                        }
                    }
                );
            }
    }

     function adjustDisplayAndSavePreference(viewID) {
        $(".optRadio").removeClass("radio_checked").addClass("radio_unchecked");
        $(".listOptionSection").removeClass("accFont").removeClass("selectedDashOption");
        $("#optRadio_" + viewID).addClass("radio_checked").removeClass("radio_unchecked");
        $("#selectedOptionText").html('Saved Filter:&nbsp;' + $("#filtName_" + viewID).html());
        $.getJSON("/getJSONData.aspx?builder=SaveUserPreference", { type: 'dashboard', name: 'selectedSavedFilterId.' + window.dashType.filters, value: viewID },
            function (data) {
                if (data.code == "OK") {
                    reloadList();
                }
            });
    }

    function cacheResultOptionCounts() {
        window.cachedResultOptionCounts = {};
        $(".listOptionSection").each(function (i, obj) {
            var resultType = $(this).attr("data-resultType");
            var count = $("#value_" + resultType).html();
            window.cachedResultOptionCounts[resultType] = count;
        });
    }

    function getDashValues_DRC() {
        window.GetDashboardValue(20, 0, 0);
        
    }

    function getDashValues_Buzz() {
        window.GetDashboardValue(106, 0);
        window.GetDashboardValue(107, 0);
        window.GetDashboardValue(108, 0);
        window.GetDashboardValue(110, 0);
    }

    function convertSortTypesToNames(sortClass) {
        switch(sortClass) {
            case 0:
                return "originalOrder";
            case 4:
                return "Isbn";
            case 8:
                return "Author";
            case 9:
                return "PubDateSort";
            case 16:
                return "Publisher";
            case 6:
                return "Format";
            case 18:
                return "Category";
            case 5:
                return "Title";
            case 80:
                return "PeerReviews";
            case 82:
                return "CurrentBuzz";
            case 81:
                return "PeerShelves";
            case 1:
                return "originalOrder";
            case 14:
                return "originalOrder";
            case 100:
                return "AppointmentDateSort";
            case 105:
                return "UpdatedDateSort";
            case 90:
                return "LastViewedSort";
            case 26:
                return "Name";
            case 220:
                return "RecentActivity";
            case 20:
                return "DateAddedSort";
            case 94:
                return "DrcDateCreatedSort";
            case 7:
                return "Price";
            case 18:
                return "Category";
            case 92:
                return "DueDateSort";
            case 251:
                return "publisherSubmissionDateSort"
            case 300:
                return "ProcessedDateSort"
            case 301:
                return "MostRecentRequestDateSort"
            case 302:
                return "EarlierRequestDateSort"
            case 15:
                return "OrderQuantity";
            case 208:
                return "StoresOrderedPercent";
            case 211:
                return "StoresOnHandPercent";
            case 213:
                return "StoresSoldPercent";
            case 401:
                return 'accountSort';
            case 400:
                return 'lastFirstNameSort';
            case 403:
                return 'stateSort';
            case 402:
                return 'citySort';
        }
    }

    function initCompSorting(mailingID, catalogID, orgID) {
        $(".sortable-comps").sortable({
            forcePlaceholderSize: true,
            handle: ".icon-move-vertical",
            items: ".comp-sort-row",
            update: function (event, ui) {
                var sku = $(this).attr("data-sku");
                var newIndex = ui.item.index();
                var compList = new Array();
                var items = $(this).children().has("[class*='moveVertical']");
    
                items.each(function () {
                    compList.push($(this).attr("data-sku"));
                });

                var values = {
                    sku:sku,
                    compSku:compList.join(","),
                    newIndex:newIndex,
                    org: orgID,
                    mailingID:mailingID,
                    catalogID:catalogID,
                    cms:''
                }

                $.post("/getJSONData.aspx?m=CompProduct&builder=ResequenceCompTitles", values, 
                    function(data){                              
                        if (data.code != "SUCCESS"){
                            alert(data.text);
                        }
                    }, "json");
            }
        });
    }
   
    function makeCompsSortable(sku, mailingID, catalogID, orgID) {
        $("#comps" + sku).sortable({
            forcePlaceholderSize: true,
            handle: ".icon-move-vertical",
            items: "#sortableRow" + sku,
            update: function (event, ui) {
                var newIndex = ui.item.index();
                var compList = new Array();
                var items = $(this).children().has("[class*='moveVertical']");
    
                items.each(function () {
                    compList.push($(this).attr("data-sku"));
                });

                var values = {
                    sku:sku,
                    compSku:compList.join(","),
                    newIndex:newIndex,
                    org: orgID,
                    mailingID:mailingID,
                    catalogID:catalogID,
                    cms:''
                }

                $.post("/getJSONData.aspx?m=CompProduct&builder=ResequenceCompTitles", values, 
                    function(data){                              
                        if (data.code != "SUCCESS"){
                            alert(data.text);
                        }
                    }, "json");
            }
        });
    }

    function goToSavedFilters(viewID) {
        viewID = viewID.replace('100_', '');
        savePreference('dashboard', 'selectedSavedFilterId.' + window.dashType.filters, viewID, function () {
            pageChange('savedFilters');
            closeModal();
        });
    }

    function goToTag(tagValue, resultType, viewID, daysBack) {
        saveTimePreference(resultType, daysBack, function () {
            if (viewID == 0) {
                viewID = '';
            } 
            savePreference('dashboard', 'selectedSavedFilterId.3', viewID, function () {
                saveTagAndGo(tagValue, resultType);
            });
        });
    }

    function saveTagAndGo(tagValue, resultType) {
        savePreference('tag', 'selectedTag', tagValue, function () {
            savePreference('tag', 'selectedTagType', resultType, function () {
                goToListFromDashboard(3);
            });
        });
    }

    function goToFolder(folderValue, resultType) {
        savePreference('folder', 'selectedFolder', folderValue, function () {
            savePreference('folder', 'selectedFolderType', resultType, function () {
                window.changePage('#dashList=2&rT=' + resultType + '&start=0');
            });
        });
    }

    function deleteIndividualOrganizationContact(orgId) {
        if (confirm("Removing selected organization(s) will remove individual contacts belonging to the organization")) {
            var orgIds = [orgId];
            deleteOrganizationContacts(orgIds);
        }
    }

    function deleteSelectedOrganizationContacts() {
        var orgIds = window.getSelectedItems();

        if (!orgIds.length) {
            modalAlert('You must select one or more account.');
            return;
        }
        
        if (confirm("Removing selected organization(s) will remove individual contacts belonging to the organization")) {
            deleteOrganizationContacts(orgIds);
        }
    }

    function openShareMarkupsWithAccount(initAuto) {
        var type = "markup";
        var buttons = [{
            text: 'Continue',
            onClick: function () {
                if (!catalogSelected) {
                    alert('Please select a catalog')
                }
                else if (catalogSelected && !markupSelected) {
                    alert('Please select a markup')
                }
                else if (catalogSelected && markupSelected) {
                    shareMarkupsWithSelectedAndEmail();
                }
            }
        }];

        var title = "Share Markup";

        openShareItemsWithAccountModal(initAuto, type, buttons, title);
    }

    function openShareDrcWithAccount(initAuto) {
        var type = "darc";
        var buttons = [{
            text: 'Share',
            onClick: function () {
                ShareDARC();
                closeDialogs();
            }
        }];

        var title = "Share Digital Review Copy";

        openShareItemsWithAccountModal(initAuto, type, buttons, title);
    }

    function openShareItemsWithAccountModal(initAuto, type, buttons, title) {
        var contacts = window.getSelectedItems();

        if (!contacts.length) {
            modalAlert('You must select one or more account.');
            return;
        }

        if (!_.isNil(contacts)) {
            var contactList = contacts.join();
            var url = "/GetTreelineControl.aspx?controlName=/uc/contacts/shares/ShareItemWithContact.ascx&type=" + type + "&initAuto=" + initAuto + "&contactList=" + contactList;

            openDialog({
                id: "accountItemShare",
                url: url,
                isModal: false,
                title: title,
                buttons: buttons,
                width: "800px",
                height: "500px",
                onClose: function () {
                    $('.ac_results').remove();
                }
            });
        }
    }

    function populateDashLane(resultType, laneID, widgetID, more) {
        var $dashContent = $('#dashContent_' + laneID),
            userId = null,
            $popover = null;

        $("#viewAll_" + laneID).unbind();

        var widgetUrl = getWidgetUrl(resultType, laneID, widgetID);
        if (!widgetUrl) {
            $.url = "/GetTreelineControl.aspx?controlName=/uc/dashboard_v2/DashItems.ascx&resultType=" + resultType + "&laneID=" + laneID + "&widgetID=" + widgetID
        } else {
            $.url = widgetUrl;
        }

        if (!widgetID) {
            var popoverId = $dashContent.data('popoverid');

            userId = $dashContent.data('userid');
            $popover = $('#' + popoverId);
        
            $.url += "&userId=" + userId;
            $.url += "&popoverId=" + popoverId;
        }

        $("#dashLaneMain_" + laneID).addClass("progressBackground");
        if ($("#dashLane_" + laneID).hasClass("showMore")) {
            $.url += "&more=1";
        }

        if ($popover) {
            WebuiPopovers.updateContentAsync($popover, $.url);
        } else {
            $("#dashContent_" + laneID).load($.url, function () {
                $("#dashLaneMain_" + laneID).removeClass("progressBackground");
            });
        }
    }

    function moreOrLessWidget(resultType, laneId, widgetId, more) {
        var savedPrefValue = 1;
        if (more != 1) {
            savedPrefValue = "";
        }
        savePreference('dashboard', 'WidgetMore.' + resultType + '.' + widgetId, savedPrefValue);
        $("#dashLane_" + laneId).toggleClass("showMore", more == 1);
        populateDashLane(resultType, laneId, widgetId, more);
    }

    //# sourceURL=HomePage.aspx
</script>
</html>