<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Stuart Caie">
  <meta name="description" content="Support site for Stuart Caie's work">
  <title>cabextract</title>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/site.css" rel="stylesheet">
 </head>
 <body>
  <div id="wrapper">
   <!-- sidebar -->
   <nav id="sidebar-wrapper">
    <ul class="sidebar-nav">
     <li class="sidebar-brand"><a href="https://www.kyzer.me.uk/"><img src="/css/logo.png" alt="Home" title="Home" width="162" height="49"/></a></li>
     <li><a href="https://www.kyzer.me.uk/personal/">About me</a>
     <li><a href="https://www.kyzer.me.uk/pack/">Data compression</a>
      <ul>
       <li><a href="https://www.cabextract.org.uk">cabextract</a></li>
       <li><a href="https://www.cabextract.org.uk/libmspack/">libmspack</a></li>
       <li><a href="https://www.cabextract.org.uk/wince_cab_format/">WinCE CAB format</a></li>
       <li><a href="https://www.kyzer.me.uk/pack/convlit/">Convert .LIT files</a></li>
       <li><a href="https://www.kyzer.me.uk/essays/giflzw/">The LZW controversy</a></li>
      </ul>
      <li><a href="https://www.kyzer.me.uk/code/">Amiga software</a>
       <ul>
        <li><a href="https://www.kyzer.me.uk/code/shellscr/">ShellScr</a></li>
        <li><a href="https://www.kyzer.me.uk/code/ksc/">KSC utilities</a></li>
        <li><a href="https://www.kyzer.me.uk/code/installers/">HD installers</a></li>
        <li><a href="https://www.kyzer.me.uk/code/diskreader/">DiskReader</a></li>
        <li><a href="https://www.kyzer.me.uk/code/e/">Amiga E code</a></li>
      </ul>
      <li><a href="#">Misc</a>
       <ul>
        <li><a href="https://www.kyzer.me.uk/ahx/">My AHX music</a></li>
        <li><a href="https://www.kyzer.me.uk/ripping/">Music ripping</a></li>
        <li><a href="https://www.kyzer.me.uk/code/java/">Java demos</a></li>
        <li><a href="https://www.kyzer.me.uk/turr2maps/">Turrican 2 maps</a></li>
       </ul>
      </li>
    </ul>
   </nav>
   <!-- page content -->
   <div id="page-content-wrapper">
    <button id="menu-toggle" class="btn btn-default" aria-label="Menu">
     <span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"></span> Menu
    </button>
    <h1 class="page-header text-center">cabextract<br/><small>Free Software for extracting Microsoft cabinet files</small></h1>
    <div id="main">
<nav id="toc" class="list-group">
 <a class="list-group-item tochead" href="#">Quick links</a>
 <a class="list-group-item" href="#download">Download</a>
 <a class="list-group-item" href="#install">Installation</a>
 <a class="list-group-item" href="#usage">Usage</a>
 <a class="list-group-item" href="#develop">Development</a>
 <a class="list-group-item" href="https://github.com/kyz/libmspack/">Github repository</a>
 <a class="list-group-item" href="#changes">Changes</a>
 <a class="list-group-item" href="#vulns">Security</a>
 <a class="list-group-item" href="#faqs">FAQs</a>
 <a class="list-group-item" href="#credits">Credits</a>
</nav>

<p><b>cabextract</b> is Free Software for extracting <b>Microsoft cabinet files</b>, also called <b><samp>.CAB</samp> files</b>. It is distributed under the GNU GPL license and is based on the portable LGPL <a href="/libmspack/"><b>libmspack</b></a> library.

<p>cabextract supports all features and formats of Microsoft cabinet files and <a href="wince_cab_format/">Windows CE installation files</a>. It can also look inside other files for embedded cabinets.</p>

<h2 id="download">Latest version</h2>

<p>cabextract version 1.6 was released 23 March 2015. It is a minor release which fixes bugs in cabextract. <a href="#changes">See the full list of changes.</a></p>

<p><a class="btn btn-success btn-lg" href="cabextract-1.6.tar.gz">Download cabextract 1.6 source</a></p>

<p>cabextract is also available pre-built for several platforms:</p>

<h4>Linux packages</h4>
<ul>
 <li><a href="cabextract-1.6-1.i386.rpm">Download cabextract 1.6 i386 RPM</a></li>
 <li><a href="cabextract-1.6-1.src.rpm">Download cabextract 1.6 source RPM</a></li>
 <li><a href="https://www.rpmfind.net/linux/rpm2html/search.php?query=cabextract">cabextract on rpmfind.net</a></li>
 <li><a href="https://packages.debian.org/cabextract">cabextract for Debian</a></li>
 <li><a href="http://packages.ubuntu.com/cabextract">cabextract for Ubuntu</a></li>
 <li><a href="https://packages.gentoo.org/package/app-arch/cabextract">cabextract for Gentoo</a></li>
 <li><a href="https://slackbuilds.org/result/?search=cabextract&amp;sv=">cabextract for Slackware</a></li>
 <li><a href="https://t2-project.org/packages/cabextract.html">cabextract for T2 SDE</a></li>
</ul>

<h4>BSD packages</h4>
<ul>
 <li><a href="https://www.freebsd.org/cgi/ports.cgi?query=cabextract&amp;stype=all">cabextract for FreeBSD</a></li>
 <li><a href="http://pkgsrc.se/archivers/cabextract">cabextract for NetBSD</a></li>
 <li><a href="http://cvsweb.openbsd.org/cgi-bin/cvsweb/ports/archivers/cabextract/">cabextract for OpenBSD</a></li>
 <li><a href="https://www.opencsw.org/packages/CSWcabextract/">cabextract for Solaris 10 and 11</a></li>
</ul>

<h4>Mac OS X packages</h4>
<ul>
 <li><a href="https://code.google.com/p/rudix/wiki/cabextract">Standalone disk image</a> <span class="text-danger">[outdated version]</span></li>
 <li><a href="http://pdb.finkproject.org/pdb/package.php/cabextract">cabextract for Fink</a></li>
 <li><a href="https://www.macports.org/ports.php?by=name&amp;substr=cabextract">cabextract for Macports</a></li>
</ul>

<h4>Microsoft Windows&trade; packages</h4>
<ul>
 <li><a href="https://www.cygwin.com/packages/x86/cabextract/">cabextract for Cygwin x86</a></li>
 <li><a href="https://www.cygwin.com/packages/x86_64/cabextract/">cabextract for Cygwin x86_64</a></li>
</ul>

<h4>Other platforms</h4>
<ul>
 <li><a href="http://aminet.net/package/util/arc/cabextract">cabextract for AmigaOS</a></li>
 <li><a href="http://aminet.net/package/util/arc/cabextract_OS4">cabextract for AmigaOS4</a></li>
 <li><a href="http://www.bttr-software.de/ports/">cabextract for DOS / FreeDOS</a> <span class="text-danger">[outdated version]</span></li>
</ul>

<p><a href="old/">Old versions of cabextract</a> are still available.</p>

<h2 id="install">Installing cabextract</h2>
 
<p>To install a packaged version of cabextract (e.g. for Debian, Ubuntu, the BSDs, Fink, Macports, Cygwin), follow that system's instructions.</p>
<p>To install the RPM, use the command <code>rpm -i cabextract-1.6-1.i386.rpm</code></p>
<p>To install from the source code tarball:</p>
<pre>
$ tar zxf cabextract-1.6.tar.gz
$ cd cabextract-1.6
$ ./configure
$ make
# make install
</pre>

<p>More detailed instructions are included in the <samp>INSTALL</samp> file found in the <samp>cabextract-1.6</samp> directory.</p>

<h2 id="usage">Using cabextract</h2>

<p>Enter <code>man cabextract</code> to read the cabextract manual page. Also, running the cabextract command with the <samp>--help</samp> option gives a brief summary of usage.</p>
<p>In regular usage, just enter <code>cabextract</code> and the name of the cabinet or executable file you want to extract. cabextract will extract all files in all cabinets to the current directory, preserving any internal directory structure, file permissions and file dates. To list files rather than extract them, use the <code>--list</code> option. To test the archive integrity (doing the work of extracting the files, but not saving the results anywhere), use the <code>--test</code> option. This also prints the MD5 checksum of each file in the archive.</p>
<p>cabextract automatically searches files for embedded cabinets, and extracts all of them.  If any multi-part cabinets are present, cabextract automatically searches for those parts and links them in. To suppress this behaviour, use the <code>--single</code> option.</p>
<p>cabextract can repair some kinds of corrupt cabinet files. Perhaps a better word for this is "salvage", as the corrupted data is lost forever. Using the <code> --fix</code> option, lost data will be replaced with zeroes, and cabextract will attempt to continue to later data blocks, which are hopefully not corrupt.</p>
<p>You can make cabextract extract files into a specific directory with the <code>--directory</code> option, and you can force extracted filenames to lowercase with the <code>--lowercase</code> option. You can control which files are extracted using the <code>--filter</code> option. For example, <code>cabextract --filter '*.wav' music.cab</code> will extract only '.wav' files from <samp>music.cab</samp>.</p>

<h2 id="develop">Developing cabextract</h2>
<p>You can get the current development version of cabextract from <a href="https://github.com/kyz/libmspack/">the libmspack github repository</a>. Use the included script <samp>rebuild.sh</samp> to build the project.

<h2 id="changes">Changes in cabextract 1.6</h2>
<ul>
 <li>It was possible for cabinet files to extract to absolute file locations, and it was possible on Cygwin to get around cabextract's absolute and relative path protections by using backslashes. These issues have been fixed.</li>
</ul>

<h2>Changes in cabextract 1.5</h2>
<ul>
 <li>Several crashes and hangs were found using the <a href="http://lcamtuf.coredump.cx/afl/">afl</a> tool to generate corrupt cabinet files. These crashes and hangs have been fixed.</li>
 <li>cabextract now replaces bad Unicode characters in filenames with the standard Unicode replacement character</li>
 <li><samp>wince_rename</samp> now puts files under the correct installation path</li>
</ul>

<h2 id="vulns">Security vulnerabilities in cabextract</h2>
<p>This is a list of security vulnerabilities reported in cabextract, and the version(s) of cabextract they affect. You should upgrade to the latest version where possible. If you discover a security vulnerability in cabextract, please <a href="mailto:kyzer@cabextract.org.uk">contact me</a> immediately.

<table class="table table-bordered table-striped table-condensed">
 <tr>
  <th>Vulnerability</th>
  <th>Affected</th>
 </tr>
 <tr>
  <td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2060">CVE-2015-2060</a>: A CAB file with overlong UTF-8 encodings for "/" can get its files extracted to an absolute path instead of the current directory. On Cygwin, a CAB file using both "/" and "\" can evade checks for absolute files and "../" directory traversals and can get its files extracted to any path</td>
  <td>&lt; 1.6</td>
 </tr>
 <tr>
  <td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4471">CVE-2015-4471</a>: A CAB file with LZX-compressed data ending early during an odd-sized uncompressed block can cause a 1 byte under-read, but no crash</td>
  <td>&lt; 1.5</td>
 </tr>
 <tr>
  <td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4470">CVE-2015-4470</a>: A CAB file with MSZIP-compressed data and a distance code of 30 causes a 1 byte over-read, but no crash</td>
  <td>&lt; 1.5</td>
 </tr>
 <tr>
  <td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9732">CVE-2014-9732</a>: A CAB file with two folders, the second folder invalid, and a file decompression order of folder 1, 2, 1, causes execution to jump to NULL</td>
  <td>&lt; 1.5</td>
 </tr>
 <tr>
  <td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9556">CVE-2014-9556</a>: On 32-bit architectures, a CAB file with invalid file offset or length (where offset + length == 2^32) causes an infinite loop in the Quantum decoder</td>
  <td>&lt; 1.5</td>
 </tr>
 <tr>
  <td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2801">CVE-2010-2801</a>: A CAB file can cause the Quantum decoder to write a small negative length for output. cabextract's <samp>--test</samp> mode interprets this as a large unsigned integer and reads most of the address space, causing a segfault</td>
  <td>1.2</td>
 </tr>
 <tr>
  <td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2800">CVE-2010-2800</a>: A CAB file that ends during an MS-ZIP uncompressed block causes an infinite loop in the MS-ZIP decoder</td>
  <td>&lt; 1.3</td>
 </tr>
 <tr>
  <td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0916">CVE-2004-0916</a>: A CAB file can use "../" in filenames to traverse directories</td>
  <td>&lt; 1.1</td>
 </tr>
</table>

<h2 id="faqs">Frequently Asked Questions</h2>

<dl>
 <dt id="unshield">How can I extract this <samp>DATA1.CAB</samp> file?</dt>
 <dd>There are two different "cabinet" file formats in popular use. Some are Microsoft cabinets, which can be unpacked with cabextract. Others are InstallShield cabinets, which come as files <samp>data1.hdr</samp>, <samp>data1.cab</samp>... Unpacking an InstallShield cabinet with cabextract gives the message <code>WARNING; found InstallShield header. This is probably an InstallShield file</code>. InstallShield cabinet files can be unpacked with <a href="https://github.com/twogood/unshield"><b>unshield</b></a></dd>
</dl>
<dl>
 <dt>How can I extract this <samp>.MSI</samp> file?</dt>
 <dd><a href="https://en.wikipedia.org/wiki/Windows_Installer">Windows Installer</a> (MSI) files use a combination of file formats, including cabinet files. cabextract can see cabinet file headers embedded in the MSI file, so it appears you can extract it, but the embedded cabinet is not stored in sequential order, so you cannot. To unpack MSI files, I recommend <a href="http://lessmsi.activescott.com/"><b>lessmsi</b></a></dd>
</dl>
<dl>
 <dt>Can I license cabextract for use in my non-GPL software?</dt>
 <dd>Yes, you can. <a href="mailto:kyzer@cabextract.org.uk">Contact me</a> for further details. However, you may prefer to use <a href="/libmspack/">libmspack</a>, as it has been explicitly designed for reuse</dd>
</dl>
<dl>
 <dt>Where can I get software to create Microsoft cabinet files?</dt>
 <dd>You can use Microsoft's own <samp>CABARC.EXE</samp> or Rien Croonenborghs' <a href="http://ohnobinki.u.ohnopublishing.net/~ohnobinki/lcab/">LCAB</a>. Future releases of <a href="/libmspack/">libmspack</a> will include a cabinet file creator. It is currently being designed</dd>
</dl>

<h2 id="credits">Credits</h2>

<p>cabextract is written primarily by <a href="http://www.kyzer.me.uk/">Stuart Caie</a>. The Quantum decompressor was researched and implemented by <a href="http://www.russotto.net/">Matthew Russotto</a>. The fast Huffman table generator is taken from <a href="http://aminet.net/package/misc/unix/unlzx.c"><samp>unlzx</samp></a> by Dave Tritscher.</p>
<p>Thanks to <a href="http://www.dstoecker.eu/">Dirk Stoecker</a> for his great support, testing, and cabinet files when cabextract was first being developed.</p>
<p>Thanks to Eric Sharkey for Debian packaging and the original manual page.</p>
<p>Thanks to Katsumi Saito for the Japanese manual page.</p>
<p>Thanks to Apostolos Syropoulos, Ben Collver, Dagobert Michelsen, Marc Dequènes, Maxim Sovolev, Pawel Chwalowski, Robert Riebisch, <a href="http://rudix.org/">Rudá Moura</a>, Ryan Schmidt, Siarzhuk Zharski, Soos Peter, Stefan Dirsch, Thomas Klausner and Yaakov Selkowitz for packaging cabextract and libmspack for other operating systems.</p>
<p>Thanks to Alfonso Acosta, Alexander Cherepanov, Antoine Amanieux, Claus Rasmussen, Daniel Resare, David Banz, David Leonard, Denis Kroshin, Drew D'Addesio, Edward Sheldrake, Fernando Trias, Hanno Böck, Igor Glucksmann, Jae Jung, Jakub Wilk, James Henstridge, Jorge Lodos, Kevin O'Rourke, Larry Frieson, Michael Vidrevich, Michal Cihar, Mike Mohr, Moritz Barsnick, Nigel Horne, Patrice Dumas, Pavel Turbin, Sergei Trofimovich, Stefan Riegler, Tomasz Kojm and Ville Skyttä for their bug discoveries, fixes and enhancements to cabextract.</p>
<p>Thanks to Dominique Gallot, Marco Schindler, Paul Sokolovsky and Shaun Jackman for helping identify WinCE header components.</p>
<p>Thanks to Jonathan Forbes for creating LZX and other Amiga compression tools.</p>
<p>Finally, thanks to the many other people who have sent in email, suggestions and code.</p>

    </div> <!-- main -->
    <div class="page-footer">
     <p>&copy; 2000-2017 Stuart Caie. Email <a href="mailto:kyzer@kyzer.me.uk">kyzer@kyzer.me.uk</a></p>
     <p class="lastupdate">Last updated: Sunday, 01 January 2017</p>
    </div>
   </div> <!-- page-content-wrapper -->
  </div> <!-- wrapper -->
  <script src="/js/jquery.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script>$("#menu-toggle").click(function(e) {e.preventDefault();$("#wrapper").toggleClass("toggled");});</script>
 </body>
</html>