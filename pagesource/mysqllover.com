<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">	    
        <title>Simple Life &#8211; Ooooo</title>
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Simple Life &raquo; Feed" href="http://mysqllover.com/?feed=rss2" />
<link rel="alternate" type="application/rss+xml" title="Simple Life &raquo; Comments Feed" href="http://mysqllover.com/?feed=comments-rss2" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/mysqllover.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.10"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='cntctfrmStylesheet-css'  href='http://mysqllover.com/wp-content/plugins/contact-form-plugin/css/style.css?ver=4.6.10' type='text/css' media='all' />
<link rel='stylesheet' id='mymagazine_google_fonts-css'  href='//fonts.googleapis.com/css?family=Source+Sans+Pro%3A300%2C700%2C300italic&#038;ver=4.6.10' type='text/css' media='all' />
<link rel='stylesheet' id='mymagazine_foundation-css'  href='http://mysqllover.com/wp-content/themes/mymagazine/css/foundation.min.css?ver=4.6.10' type='text/css' media='all' />
<link rel='stylesheet' id='mymagazine_main_css-css'  href='http://mysqllover.com/wp-content/themes/mymagazine/style.css?ver=4.6.10' type='text/css' media='all' />
<link rel='stylesheet' id='page-list-style-css'  href='http://mysqllover.com/wp-content/plugins/sitemap/css/page-list.css?ver=4.2' type='text/css' media='all' />
<script type='text/javascript' src='http://mysqllover.com/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='http://mysqllover.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript' src='http://mysqllover.com/wp-content/plugins/anti-spam/js/anti-spam.js?ver=1.9'></script>
<link rel='https://api.w.org/' href='http://mysqllover.com/?rest_route=/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://mysqllover.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://mysqllover.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.6.10" />
<link rel='shortlink' href='http://wp.me/' />
<script>
jQuery(document).ready(function(){
jQuery("html").attr("xmlns:og","http://opengraphprotocol.org/schema/");
});
</script>
			<meta property="og:type" content="blog" />
		<meta property="og:site_name" content="Simple Life" />
		<meta property='og:url' content="http://mysqllover.com" />
				<link href="http://mysqllover.com/wp-content/plugins/google-syntax-highlighter/Styles/SyntaxHighlighter.css" type="text/css" rel="stylesheet" />
	<link rel="stylesheet" type="text/css" media="all" href="http://mysqllover.com/wp-content/plugins/sina-weibo-plugin-for-wordpress/weibo.css" />
    </head>
    <body class="home blog">
        <div class="wrapper">
            <a class="skip-link screen-reader-text" href="#content">Skip to content</a>
            			<header id="masthead" class="site-header">
                <div class="pre-header">
                    <div class="row">
                        <div class="small-12 columns">
                            <ul class="mobile-icons">
                                <li class="li-social">
                                                                </li>
                                <li><span class="genericon genericon-search"><span class="screen-reader-text">Search</span></span></li>
                                <li><span class="genericon genericon-user"><span class="screen-reader-text">Login</span></span></li>
                            </ul>
                                                        <form role="search" method="get" class="search-form" action="http://mysqllover.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form>                            <a class="log" href="http://mysqllover.com/wp-login.php?redirect_to=http%3A%2F%2Fmysqllover.com" title="Login">Login</a>
                            <a class="log" href="http://mysqllover.com/wp-login.php?action=register" title="Register">Register</a>
                        </div>
                    </div><!-- end .row -->
                </div><!-- end .pre-header -->
                <div class="main-header">
                    <div class="row">
                        <div class="small-11 columns logo">
                                                        <h1 class="site-title"><a href="http://mysqllover.com/" rel="home">Simple Life</a></h1>
                                                        <p class="site-description">Ooooo</p>  
                        </div><!-- .logo -->
                    </div><!-- end .row -->
                    <nav class="site-navigation main-nav">       
                    <div class="row">
                        <div class="nav-columns small-12 columns">
                            <h2 class="screen-reader-text">menu</h2>
                            <div class="screen-reader-text skip-link">
                                <a href="#content" title="Skip">Skip to content</a>
                            </div>
                            <div class="header-menu">
                                <span class="screen-reader-text">menu</span>
                                <span class="menu-button">
                                    <span class="menu-bar"></span>
                                    <span class="menu-bar"></span>
                                    <span class="menu-bar"></span>
                                </span>
                            </div>
                        <div id="menu-primary" class="menu"><ul><li class="page_item page-item-2"><a href="http://mysqllover.com/?page_id=2">About Me</a></li></ul></div>
            
                      </div><!-- end .small-2 .medium-12 .columns -->
                    </div><!-- end .row -->
                  </nav><!-- .site-navigation .main-navigation -->
                </div><!-- row -->
            </header><!-- .site-header -->
            <div class="start row"><!-- Main Column -->        <div id="content" class="medium-8 columns" role="main">
                    
            <!-- the loop -->
                        <article>
                <header class="article-intro sticky">
                                    <div class="row">
            <div class="article-title no-thumbnail large-12 columns">
                  <h2><a href="http://mysqllover.com/?p=1537">博客全面迁移到云栖社区</a> </h2>
            </div>
        </div><!-- end .row -->
                <div class="row">
                    </div><!-- end .row -->    
                    </header><!-- end .article-intro -->
            </article>
            <!-- end of the loop -->

            <div class="row">
                <div class="article-container large-12 columns">
                    <div class="row">
                                    
                        <!-- the loop -->
                                <div class="articles-home small-12 columns no-thumbnail no-tag ">
        <span class="article-introduction"></span>
        <span class="article-label"><a href="http://mysqllover.com/?cat=1" title="View all posts in 未分类" >未分类</a> </span>
        <a href="http://mysqllover.com/?p=1537"></a>
        <h3 class="article-title-home"><a href="http://mysqllover.com/?p=1537">博客全面迁移到云栖社区</a></h3>
        <p class="article-summary-home">
                <p>RT，wordpress写markdown太蛋疼了，以后博客都发到云栖了. 地址： https://yq.aliyun.com/u/zhaiwx1987 原创文章，转载请注明： 转载自Simple Life 本文链接地址: 博客全面迁移到云栖社区 Post Footer automatically generated by wp-posturl plugin for wordpress.</p>
<br/><iframe src="http://www.facebook.com/plugins/like.php?locale=en_US&href=http%3A%2F%2Fmysqllover.com%2F%3Fp%3D1537&amp;layout=standard&amp;show-faces=false&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:130px"></iframe>                </p>
    </div>
            <div class="articles-home small-12 columns no-thumbnail no-tag ">
        <span class="article-introduction"></span>
        <span class="article-label"><a href="http://mysqllover.com/?cat=1" title="View all posts in 未分类" >未分类</a> </span>
        <a href="http://mysqllover.com/?p=1516"></a>
        <h3 class="article-title-home"><a href="http://mysqllover.com/?p=1516">procedure analyse() 随手记</a></h3>
        <p class="article-summary-home">
                <p>Procedure Analyze: http://dev.mysql.com/doc/refman/5.6/en/procedure-analyse.html Procedure Analyze是MySQL提供的一个分析结果集的接口，以帮助提供数据类型优化建议。其语法格式如下： SELECT &#8230; FROM &#8230; WHERE &#8230; PROCEDURE ANALYSE([max_elements,[max_memory]]) max_elements(默认256)表示最多使用这么多个不同的列值来进行分析，是否可以使用ENUM类型，如果有超过这么多个不同的值，enum就不会纳入到考虑中。 max_memory（默认8192），是Analyze()为每个列分配的最大内存，用于尝试找到所有不同的列值。 例如，我们在一个普通的表上执行： mysql&gt; select k from sbtest99 procedure analyse()\G *************************** 1. row *************************** Field_name: sb1.sbtest99.k Min_value: 12992 Max_value: 85008 Min_length: 5 Max_length: 5 Empties_or_zeros: 0 Nulls: 0 Avg_value_or_avg_length: 49996.6047 Std: 43159.4545 Optimal_fieldtype: MEDIUMINT(5) UNSIGNED NOT NULL 1 row in set (0.03 sec) [&hellip;]</p>
<br/><iframe src="http://www.facebook.com/plugins/like.php?locale=en_US&href=http%3A%2F%2Fmysqllover.com%2F%3Fp%3D1516&amp;layout=standard&amp;show-faces=false&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:130px"></iframe>                </p>
    </div>
            <div class="articles-home small-12 columns no-thumbnail no-tag ">
        <span class="article-introduction"></span>
        <span class="article-label"><a href="http://mysqllover.com/?cat=13" title="View all posts in MySQL 5.6" >MySQL 5.6</a> </span>
        <a href="http://mysqllover.com/?p=1508"></a>
        <h3 class="article-title-home"><a href="http://mysqllover.com/?p=1508">InnoDB 存储引擎系列文章</a></h3>
        <p class="article-summary-home">
                <p>以下是我发布在我们团队的(Aliyun RDS MySQL 开发组)每月内核月报上关于InnoDB的几篇文章，不断更新中&#8230;.. 如下是传送门： MySQL · 引擎特性 · InnoDB undo log 漫游 MySQL · 引擎特性 · InnoDB redo log漫游 MySQL · 引擎特性 · InnoDB 崩溃恢复过程 MySQL · 引擎特性 · Innodb change buffer介绍 MySQL · 引擎特性 · InnoDB Adaptive hash index介绍 MySQL · 引擎特性 · InnoDB 全文索引简介 MySQL · 引擎特性 · InnoDB 事务子系统介绍 MySQL · [&hellip;]</p>
<br/><iframe src="http://www.facebook.com/plugins/like.php?locale=en_US&href=http%3A%2F%2Fmysqllover.com%2F%3Fp%3D1508&amp;layout=standard&amp;show-faces=false&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:130px"></iframe>                </p>
    </div>
            <div class="articles-home small-12 columns no-thumbnail no-tag ">
        <span class="article-introduction"></span>
        <span class="article-label"><a href="http://mysqllover.com/?cat=13" title="View all posts in MySQL 5.6" >MySQL 5.6</a> </span>
        <a href="http://mysqllover.com/?p=1504"></a>
        <h3 class="article-title-home"><a href="http://mysqllover.com/?p=1504">MySQL5.6.27 Release Note解读（innodb及复制模块）</a></h3>
        <p class="article-summary-home">
                <p>新功能 问题描述(Bug #18871046, Bug #72811)： 主要为了解决一个比较“古老”的MySQL在NUMA架构下的“swap insanity”问题，其表现为尽管为InnoDB buffer pool分配了足够多的内存，但依然会产生swap。而swap对数据库系统性能而言是比较致命的。 当我们配置的buffer pool超过单个node的内存时，例如总共64GB内存，每个节点32GB，分配buffer pool为40GB，默认情况下，会先用满node 0，再在node1上分配8GB内存。如果绑定到node 0上的线程需要申请新的内存时，不是从node1上申请（还有24GB空余），而是swap node0的内存，再做申请。 这个问题在社区讨论了很久，大神Jeremy Cole 对该问题有写博客做过详细的介绍（http://blog.jcole.us/2010/09/28/mysql-swap-insanity-and-the-numa-architecture/） 解决： 增加了一个只读的新参数innodb_numa_interleave选项，当开启该选项，可以允许在NUMA架构下采取交叉分配内存的方式。 在启动MySQL时，采用MPOL_INTERLEAVE方式分配内存，如上例，在启动时每个node上分配20GB内存，保证每个node依然有空闲内存可用；在完成InnoDB buffer pool内存分配后，再将内存分配策略设置为MPOL_DEFAULT，之后的线程申请内存，都在各自的节点完成。 补丁： https://github.com/mysql/mysql-server/commit/242fa2c92de304637e794e531df1f1b86b8d1dee https://github.com/mysql/mysql-server/commit/d2578b57ba7d90a00281ae124a1cd6c83193f62a InnoDB bugfix 问题描述： 当一个表被驱逐并重新导入时，如果表的内容是空的（例如先插入大量数据，再一次全删除时，auto_increment不为0），就会导致AUTO_INCREMENT的值被重置。(Bug #21454472, Bug #77743) 这是因为每次打开表时，总是通过计算表上记录最大自增列值的方式来重新设置，当表被打开时，如果没有数据，AUTO_INCREMENT就会被重置成最小值。 解决： 在驱逐表时，将这个表的AUTO_INCREMENT值存储在内存中(dict_sys-&gt;autoinc_map)，当表重新读入时，再恢复其AUTO_INCREMENT值。 这个Fix并不算一个完整的修复，当实例重启时，AUTO_INCREMENT依然会被重置(参阅bug#199)， RDS MYSQ已经Fix了这个bug，能够持久化自增列到物理文件中，在重启后不会丢失。 补丁： https://github.com/mysql/mysql-server/commit/d404923aad4693dc152d02461f858d7ef218c336 问题描述： Memcached的一段开启事务的代码在assert中调用，而根据assert的文档定义( http://man7.org/linux/man-pages/man3/assert.3.html )，他的行为是未知的，受NDEBUG控制，可能assert会被定义成空函数，导致assert中的函数调用被忽略掉。这个bug在某些平台下可能极易触发。使用memcached的同学需要注意下。 (Bug #21239299, Bug #75199) 解决： 将函数调用从assert中移出来，只assert函数返回值。 补丁： https://github.com/mysql/mysql-server/commit/db5dc6fd3abe855685a554bc3c555b1b63914b60 问题描述： 在ARM64平台上, GCC的内建的TAS操作函数__sync_lock_test_and_set 可能不准确，这和平台内存模型有关，锁的行为错误，导致进一步的数据损坏。(Bug [&hellip;]</p>
<br/><iframe src="http://www.facebook.com/plugins/like.php?locale=en_US&href=http%3A%2F%2Fmysqllover.com%2F%3Fp%3D1504&amp;layout=standard&amp;show-faces=false&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:130px"></iframe>                </p>
    </div>
            <div class="articles-home small-12 columns no-thumbnail no-tag ">
        <span class="article-introduction"></span>
        <span class="article-label"><a href="http://mysqllover.com/?cat=13" title="View all posts in MySQL 5.6" >MySQL 5.6</a> </span>
        <a href="http://mysqllover.com/?p=1492"></a>
        <h3 class="article-title-home"><a href="http://mysqllover.com/?p=1492">MySQL 5.6.26　Release Note解读</a></h3>
        <p class="article-summary-home">
                <p>最近上游发布了MySQL 5.6.26版本，从release note来看，MySQL5.6版本已经相当成熟，fix的bug数越来越少了。本文主要分析releae note上fix的相关bug，去除performance scheama、mac及windows平台、企业版、package相关内容。 InnoDB storage engine 问题描述： 在类unix平台上，当innodb_flush_method设置为O_DIRECT时，函数os_file_create_simple_no_error_handling_func没有使用O_DIRECT方式打开数据文件。例如在函数fil_node_open_file中，可能先以函数os_file_create_simple_no_error_handling_func打开文件，确定文件的大小，然后关闭文件；再以os_file_create打开数据文件，前者使用Buffered IO，后者使用DIRECT IO。这种混合使用可能引发性能问题。 根据man手册建议： Applications should avoid mixing O_DIRECT and normal I/O to the same file, and especially to overlapping byte regions in handles the coherency issues in this situation, overall I/O the same file. Even when the filesystem correctly throughput is likely to be slower [&hellip;]</p>
<br/><iframe src="http://www.facebook.com/plugins/like.php?locale=en_US&href=http%3A%2F%2Fmysqllover.com%2F%3Fp%3D1492&amp;layout=standard&amp;show-faces=false&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:130px"></iframe>                </p>
    </div>
            <div class="articles-home small-12 columns no-thumbnail no-tag ">
        <span class="article-introduction"></span>
        <span class="article-label"><a href="http://mysqllover.com/?cat=13" title="View all posts in MySQL 5.6" >MySQL 5.6</a> </span>
        <a href="http://mysqllover.com/?p=1477"></a>
        <h3 class="article-title-home"><a href="http://mysqllover.com/?p=1477">[MySQL bug] unique key corruption again&#8230;..</a></h3>
        <p class="article-summary-home">
                <p>最近Percona的研发人员report了一个uk corruption的bug，这个Bug不同于之前发现的bug（见我的另外一篇博客http://mysqllover.com/?p=1041），而是影响从5.1 到5.8全系列MySQL版本，应该算是设计上的缺陷吧。 原创文章，转载请注明： 转载自Simple Life 本文链接地址: [MySQL bug] unique key corruption again&#8230;.. Post Footer automatically generated by wp-posturl plugin for wordpress.</p>
<br/><iframe src="http://www.facebook.com/plugins/like.php?locale=en_US&href=http%3A%2F%2Fmysqllover.com%2F%3Fp%3D1477&amp;layout=standard&amp;show-faces=false&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:130px"></iframe>                </p>
    </div>
            <div class="articles-home small-12 columns no-thumbnail no-tag ">
        <span class="article-introduction"></span>
        <span class="article-label"><a href="http://mysqllover.com/?cat=13" title="View all posts in MySQL 5.6" >MySQL 5.6</a> </span>
        <a href="http://mysqllover.com/?p=1455"></a>
        <h3 class="article-title-home"><a href="http://mysqllover.com/?p=1455">InnoDB foreign key 实现</a></h3>
        <p class="article-summary-home">
                <p>本文是对Innodb外键实现代码路径的简单记录，对外键实现逻辑熟悉的同学直接忽略吧。。。。。 前言 外键代表两张表之间的引用约束关系：在子表上出现的列记录，必须在父表上已经存在。通过外键，我们可以确保业务上的逻辑一致性，同时还能实现一些级联操作；MySQL目前只有InnoDB引擎支持外键，类似MyISAM、Tokudb等引擎都不支持外键。 InnoDB支持建立多个列的外键，但被外键约束的父表上必须对这些列建立索引，并且子表上的外键列 和父表上索引上的顺序是一致的。默认情况下，当删除父表中被外键约束的记录时，会产生报错，但我们也可以通过在建外键索引时加上ON DELETE CASCADE 来级联的更新子表，更新同理。其他行为包括RESTRICT(限制父表的外键改动，默认值)、CASCADE（跟随父表的改动）、SET NULL(子表对应列设置为NULL)、SET DEFAULT（设置为默认值，InnoDB不支持，但Server层支持）、NO ACTION（无动作）。 原创文章，转载请注明： 转载自Simple Life 本文链接地址: InnoDB foreign key 实现 Post Footer automatically generated by wp-posturl plugin for wordpress.</p>
<br/><iframe src="http://www.facebook.com/plugins/like.php?locale=en_US&href=http%3A%2F%2Fmysqllover.com%2F%3Fp%3D1455&amp;layout=standard&amp;show-faces=false&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:130px"></iframe>                </p>
    </div>
            <div class="articles-home small-12 columns no-thumbnail no-tag ">
        <span class="article-introduction"></span>
        <span class="article-label"><a href="http://mysqllover.com/?cat=13" title="View all posts in MySQL 5.6" >MySQL 5.6</a> </span>
        <a href="http://mysqllover.com/?p=1444"></a>
        <h3 class="article-title-home"><a href="http://mysqllover.com/?p=1444">InnoDB IO子系统介绍</a></h3>
        <p class="article-summary-home">
                <p>本文我们来简单过一下InnoDB的IO子系统相关模块的代码逻辑。主要包括IO读写线程、预读逻辑、InnoDB读写Page以及社区的一些改进。 前言 InnoDB对page的磁盘操作分为读操作和写操作。 &nbsp; 对于读操作，在将数据读入磁盘前，总是为其先预先分配好一个block，然后再去磁盘读取一个新的page，在使用这个page之前，还需要检查是否有change buffer项，并根据change buffer，进行数据变更。 &nbsp; 读操作分为两种场景：普通的读page及预读操作，前者为同步读，后者为异步读 &nbsp; Page写操作也分为两种，一种是batch write，一种是single page write。写page默认受double write buffer保护，因此对double write buffer的写磁盘为同步写，而对数据文件的写入为异步写。 &nbsp; 同步读写操作通常由用户线程来完成，而异步读写操作则需要后台线程的协同。 原创文章，转载请注明： 转载自Simple Life 本文链接地址: InnoDB IO子系统介绍 Post Footer automatically generated by wp-posturl plugin for wordpress.</p>
<br/><iframe src="http://www.facebook.com/plugins/like.php?locale=en_US&href=http%3A%2F%2Fmysqllover.com%2F%3Fp%3D1444&amp;layout=standard&amp;show-faces=false&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:130px"></iframe>                </p>
    </div>
            <div class="articles-home small-12 columns no-thumbnail no-tag ">
        <span class="article-introduction"></span>
        <span class="article-label"><a href="http://mysqllover.com/?cat=14" title="View all posts in MySQL 5.7" >MySQL 5.7</a> </span>
        <a href="http://mysqllover.com/?p=1437"></a>
        <h3 class="article-title-home"><a href="http://mysqllover.com/?p=1437">MySQL 5.7 BUGFIX BUG#12161</a></h3>
        <p class="article-summary-home">
                <p>(本文已发布到我们的内核月报中，请点击链接访问更多精彩:http://mysql.taobao.org/monthly/2015/04/这里只是在本博客里做个备份 ) 在MySQL 5.7版本里，大量遗留很多年的bug都被fix掉了，bug#12161就是其中一个，该bug在2005年第一次report到Bug list上，十年之后终于在MySQL 5.7.7 第一个RC版本被fix了。 Bug描述 当我们显式开启一个XA事务，执行操作，并完成XA PREPARE后，如果Kill session或者主动断开，再重连执行XA RECOVER，之前的这个XA事务是丢失了的。 原创文章，转载请注明： 转载自Simple Life 本文链接地址: MySQL 5.7 BUGFIX BUG#12161 Post Footer automatically generated by wp-posturl plugin for wordpress.</p>
<br/><iframe src="http://www.facebook.com/plugins/like.php?locale=en_US&href=http%3A%2F%2Fmysqllover.com%2F%3Fp%3D1437&amp;layout=standard&amp;show-faces=false&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:130px"></iframe>                </p>
    </div>
            <div class="articles-home small-12 columns no-thumbnail no-tag ">
        <span class="article-introduction"></span>
        <span class="article-label"><a href="http://mysqllover.com/?cat=14" title="View all posts in MySQL 5.7" >MySQL 5.7</a> </span>
        <a href="http://mysqllover.com/?p=1429"></a>
        <h3 class="article-title-home"><a href="http://mysqllover.com/?p=1429">[MySQL 5.7.7] 拆分LOCK_grant读写锁</a></h3>
        <p class="article-summary-home">
                <p>Worklog: https://dev.mysql.com/worklog/task/?id=8355 问题： Lock_grant锁实际上是一个读写锁，每执行一条sql都要读取执行check_grant来检查权限是否匹配，这时候加的是读锁，而读锁是可以并发的。大多数情况下加锁开销是很不明显的，但是在MySQL将大多数只读场景下的锁都消除掉后，LOCK_grant开始变的比较突出了。 5.7里主要消除掉了几种会影响到只读性能的锁： #为InnoDB表消除THR_LOCK #MDL LOCK维护改成LOCK FREE的算法 #为AUTO-COMMIT的SELECT缓存Read View来减少trx_sys-&gt;mutex冲突 Stewart Smith report了一个Bug#72829 来描述LOCK_grant在power机型的影响，在他的测试中，LOCK_grant去除掉后，居然有50的性能提升。我相信这是和平台相关的。。。因为我的机器上很难达到这样的提升。。。。 原创文章，转载请注明： 转载自Simple Life 本文链接地址: [MySQL 5.7.7] 拆分LOCK_grant读写锁 Post Footer automatically generated by wp-posturl plugin for wordpress.</p>
<br/><iframe src="http://www.facebook.com/plugins/like.php?locale=en_US&href=http%3A%2F%2Fmysqllover.com%2F%3Fp%3D1429&amp;layout=standard&amp;show-faces=false&amp;width=450&amp;action=like&amp;colorscheme=light" scrolling="no" frameborder="0" allowTransparency="true" style="border:none; overflow:hidden; width:450px; height:130px"></iframe>                </p>
    </div>
                            <div class="clear"></div>
                                                    <div class="pagination">
                                                                <a href="http://mysqllover.com/?paged=2" ><span class="next">Next</span></a>                            </div>
                                                <!-- end of the loop -->
                    </div><!-- end .row -->
                </div><!-- end .article-container -->
            </div><!-- end .row -->
          </div>
          <!-- End Main Column -->
    
          <!-- Sidebar -->  
          <div id="secondary" class="sidebar widget-area medium-4 columns" role="complementary">
	<aside id="meta-2" class="widget widget_meta"><div class="widget-container"><div class="widget-title"><h3>管理</h3></div>			<ul>
						<li><a href="http://mysqllover.com/wp-login.php">Log in</a></li>
			<li><a href="http://mysqllover.com/?feed=rss2">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://mysqllover.com/?feed=comments-rss2">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
			</div></aside><aside id="search-2" class="widget widget_search"><div class="widget-container"><div class="widget-title"><h3>Search</h3></div><form role="search" method="get" class="search-form" action="http://mysqllover.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></div></aside>		<aside id="recent-posts-2" class="widget widget_recent_entries"><div class="widget-container">		<div class="widget-title"><h3>近期文章</h3></div>		<ul>
					<li>
				<a href="http://mysqllover.com/?p=1537">博客全面迁移到云栖社区</a>
						</li>
					<li>
				<a href="http://mysqllover.com/?p=1516">procedure analyse() 随手记</a>
						</li>
					<li>
				<a href="http://mysqllover.com/?p=1508">InnoDB 存储引擎系列文章</a>
						</li>
					<li>
				<a href="http://mysqllover.com/?p=1504">MySQL5.6.27 Release Note解读（innodb及复制模块）</a>
						</li>
					<li>
				<a href="http://mysqllover.com/?p=1492">MySQL 5.6.26　Release Note解读</a>
						</li>
					<li>
				<a href="http://mysqllover.com/?p=1477">[MySQL bug] unique key corruption again&#8230;..</a>
						</li>
					<li>
				<a href="http://mysqllover.com/?p=1455">InnoDB foreign key 实现</a>
						</li>
					<li>
				<a href="http://mysqllover.com/?p=1444">InnoDB IO子系统介绍</a>
						</li>
				</ul>
		</div></aside>		<aside id="calendar-2" class="widget widget_calendar"><div class="widget-container"><div class="widget-title"><h3>日历</h3></div><div id="calendar_wrap" class="calendar_wrap"><table id="wp-calendar">
	<caption>March 2018</caption>
	<thead>
	<tr>
		<th scope="col" title="Monday">M</th>
		<th scope="col" title="Tuesday">T</th>
		<th scope="col" title="Wednesday">W</th>
		<th scope="col" title="Thursday">T</th>
		<th scope="col" title="Friday">F</th>
		<th scope="col" title="Saturday">S</th>
		<th scope="col" title="Sunday">S</th>
	</tr>
	</thead>

	<tfoot>
	<tr>
		<td colspan="3" id="prev"><a href="http://mysqllover.com/?m=201605">&laquo; May</a></td>
		<td class="pad">&nbsp;</td>
		<td colspan="3" id="next" class="pad">&nbsp;</td>
	</tr>
	</tfoot>

	<tbody>
	<tr>
		<td colspan="3" class="pad">&nbsp;</td><td>1</td><td>2</td><td>3</td><td>4</td>
	</tr>
	<tr>
		<td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td><td>11</td>
	</tr>
	<tr>
		<td>12</td><td>13</td><td>14</td><td>15</td><td>16</td><td>17</td><td>18</td>
	</tr>
	<tr>
		<td>19</td><td>20</td><td>21</td><td>22</td><td>23</td><td id="today">24</td><td>25</td>
	</tr>
	<tr>
		<td>26</td><td>27</td><td>28</td><td>29</td><td>30</td><td>31</td>
		<td class="pad" colspan="1">&nbsp;</td>
	</tr>
	</tbody>
	</table></div></div></aside><aside id="archives-2" class="widget widget_archive"><div class="widget-container"><div class="widget-title"><h3>文章归档</h3></div>		<ul>
			<li><a href='http://mysqllover.com/?m=201605'>May 2016</a>&nbsp;(1)</li>
	<li><a href='http://mysqllover.com/?m=201511'>November 2015</a>&nbsp;(3)</li>
	<li><a href='http://mysqllover.com/?m=201508'>August 2015</a>&nbsp;(1)</li>
	<li><a href='http://mysqllover.com/?m=201506'>June 2015</a>&nbsp;(1)</li>
	<li><a href='http://mysqllover.com/?m=201505'>May 2015</a>&nbsp;(2)</li>
	<li><a href='http://mysqllover.com/?m=201504'>April 2015</a>&nbsp;(2)</li>
	<li><a href='http://mysqllover.com/?m=201503'>March 2015</a>&nbsp;(14)</li>
	<li><a href='http://mysqllover.com/?m=201502'>February 2015</a>&nbsp;(2)</li>
	<li><a href='http://mysqllover.com/?m=201501'>January 2015</a>&nbsp;(3)</li>
	<li><a href='http://mysqllover.com/?m=201412'>December 2014</a>&nbsp;(5)</li>
	<li><a href='http://mysqllover.com/?m=201411'>November 2014</a>&nbsp;(11)</li>
	<li><a href='http://mysqllover.com/?m=201410'>October 2014</a>&nbsp;(5)</li>
	<li><a href='http://mysqllover.com/?m=201409'>September 2014</a>&nbsp;(4)</li>
	<li><a href='http://mysqllover.com/?m=201408'>August 2014</a>&nbsp;(1)</li>
	<li><a href='http://mysqllover.com/?m=201407'>July 2014</a>&nbsp;(2)</li>
	<li><a href='http://mysqllover.com/?m=201406'>June 2014</a>&nbsp;(1)</li>
	<li><a href='http://mysqllover.com/?m=201405'>May 2014</a>&nbsp;(3)</li>
	<li><a href='http://mysqllover.com/?m=201403'>March 2014</a>&nbsp;(5)</li>
	<li><a href='http://mysqllover.com/?m=201402'>February 2014</a>&nbsp;(1)</li>
	<li><a href='http://mysqllover.com/?m=201401'>January 2014</a>&nbsp;(4)</li>
	<li><a href='http://mysqllover.com/?m=201312'>December 2013</a>&nbsp;(3)</li>
	<li><a href='http://mysqllover.com/?m=201310'>October 2013</a>&nbsp;(2)</li>
	<li><a href='http://mysqllover.com/?m=201309'>September 2013</a>&nbsp;(2)</li>
	<li><a href='http://mysqllover.com/?m=201308'>August 2013</a>&nbsp;(2)</li>
	<li><a href='http://mysqllover.com/?m=201307'>July 2013</a>&nbsp;(1)</li>
	<li><a href='http://mysqllover.com/?m=201306'>June 2013</a>&nbsp;(8)</li>
	<li><a href='http://mysqllover.com/?m=201305'>May 2013</a>&nbsp;(6)</li>
	<li><a href='http://mysqllover.com/?m=201304'>April 2013</a>&nbsp;(5)</li>
	<li><a href='http://mysqllover.com/?m=201303'>March 2013</a>&nbsp;(9)</li>
	<li><a href='http://mysqllover.com/?m=201302'>February 2013</a>&nbsp;(1)</li>
	<li><a href='http://mysqllover.com/?m=201301'>January 2013</a>&nbsp;(6)</li>
	<li><a href='http://mysqllover.com/?m=201212'>December 2012</a>&nbsp;(5)</li>
	<li><a href='http://mysqllover.com/?m=201211'>November 2012</a>&nbsp;(7)</li>
	<li><a href='http://mysqllover.com/?m=201210'>October 2012</a>&nbsp;(14)</li>
	<li><a href='http://mysqllover.com/?m=201209'>September 2012</a>&nbsp;(6)</li>
	<li><a href='http://mysqllover.com/?m=201208'>August 2012</a>&nbsp;(9)</li>
	<li><a href='http://mysqllover.com/?m=201207'>July 2012</a>&nbsp;(11)</li>
		</ul>
		</div></aside><aside id="views-2" class="widget widget_views"><div class="widget-container"><div class="widget-title"><h3>Views</h3></div><ul>
<li><a href="http://mysqllover.com/?p=689"  title="MySQL 5.6.12的Innodb性能改进">MySQL 5.6.12的Innodb性能改进</a> - 573,087 views</li><li><a href="http://mysqllover.com/?p=547"  title="[MySQL 5.6] MySQL 5.6 online ddl 使用、测试及关键函数栈">[MySQL 5.6] MySQL 5.6 online ddl 使用、测试及关键函数栈</a> - 218,887 views</li><li><a href="http://mysqllover.com/?p=213"  title="[MySQL 调试] 初试breakpad">[MySQL 调试] 初试breakpad</a> - 207,218 views</li><li><a href="http://mysqllover.com/?p=437"  title="一个线上死锁问题分析">一个线上死锁问题分析</a> - 203,334 views</li><li><a href="http://mysqllover.com/?p=489"  title="[MySQL 5.6]  innodb_flush_method新值O_DIRECT_NO_FSYNC  及bug#68555">[MySQL 5.6]  innodb_flush_method新值O_DIRECT_NO_FSYNC  及bug#68555</a> - 175,763 views</li><li><a href="http://mysqllover.com/?p=581"  title="[MySQL 5.6] MySQL 5.6 group commit 性能测试及内部实现流程">[MySQL 5.6] MySQL 5.6 group commit 性能测试及内部实现流程</a> - 174,490 views</li><li><a href="http://mysqllover.com/?p=186"  title="[MySQL Bug]Bug#13986705 CRASH IN GET_INTERVAL_VALUE() WITH DATE CALCULATION WITH UTF32 INTERVALS">[MySQL Bug]Bug#13986705 CRASH IN GET_INTERVAL_VALUE() WITH DATE CALCULATION WITH UTF32 INTERVALS</a> - 133,021 views</li><li><a href="http://mysqllover.com/?p=206"  title="[MySQL学习] MySQL压缩表">[MySQL学习] MySQL压缩表</a> - 39,953 views</li><li><a href="http://mysqllover.com/?p=431"  title="[MySQL学习] Innodb锁系统(4) Insert/Delete 锁处理及死锁示例分析">[MySQL学习] Innodb锁系统(4) Insert/Delete 锁处理及死锁示例分析</a> - 22,702 views</li><li><a href="http://mysqllover.com/?p=470"  title="[MySQL学习]  MySQL 5.6 improvement for troubleshooting">[MySQL学习]  MySQL 5.6 improvement for troubleshooting</a> - 14,806 views</li></ul>
</div></aside></div><!-- #secondary -->
          <!-- end Sidebar -->
          <!-- Footer -->
                  </div>
        <!-- end .start .row -->
        
                </div><!-- End Wrapper -->
        <img src="http://mysqllover.com/wp-content/plugins/cookies-for-comments/css.php?k=75ddfcf8df62792f1f3af6ef61f2e7a2&amp;o=i&amp;t=537188178" width='1' height='1' /><script class="javascript" src="http://mysqllover.com/wp-content/plugins/google-syntax-highlighter/Scripts/shCore.js"></script>
<script class="javascript" src="http://mysqllover.com/wp-content/plugins/google-syntax-highlighter/Scripts/shBrushCSharp.js"></script>
<script class="javascript" src="http://mysqllover.com/wp-content/plugins/google-syntax-highlighter/Scripts/shBrushPhp.js"></script>
<script class="javascript" src="http://mysqllover.com/wp-content/plugins/google-syntax-highlighter/Scripts/shBrushJScript.js"></script>
<script class="javascript" src="http://mysqllover.com/wp-content/plugins/google-syntax-highlighter/Scripts/shBrushJava.js"></script>
<script class="javascript" src="http://mysqllover.com/wp-content/plugins/google-syntax-highlighter/Scripts/shBrushVb.js"></script>
<script class="javascript" src="http://mysqllover.com/wp-content/plugins/google-syntax-highlighter/Scripts/shBrushSql.js"></script>
<script class="javascript" src="http://mysqllover.com/wp-content/plugins/google-syntax-highlighter/Scripts/shBrushXml.js"></script>
<script class="javascript" src="http://mysqllover.com/wp-content/plugins/google-syntax-highlighter/Scripts/shBrushDelphi.js"></script>
<script class="javascript" src="http://mysqllover.com/wp-content/plugins/google-syntax-highlighter/Scripts/shBrushPython.js"></script>
<script class="javascript" src="http://mysqllover.com/wp-content/plugins/google-syntax-highlighter/Scripts/shBrushRuby.js"></script>
<script class="javascript" src="http://mysqllover.com/wp-content/plugins/google-syntax-highlighter/Scripts/shBrushCss.js"></script>
<script class="javascript" src="http://mysqllover.com/wp-content/plugins/google-syntax-highlighter/Scripts/shBrushCpp.js"></script>
<script class="javascript">
dp.SyntaxHighlighter.ClipboardSwf = 'http://mysqllover.com/wp-content/plugins/google-syntax-highlighter/Scripts/clipboard.swf';
dp.SyntaxHighlighter.HighlightAll('code');
</script>
<script type='text/javascript' src='http://mysqllover.com/wp-content/themes/mymagazine/js/responsiveslides.min.js?ver=4.6.10'></script>
<script type='text/javascript' src='http://mysqllover.com/wp-content/themes/mymagazine/js/mymagazine-scripts.js?ver=4.6.10'></script>
<script type='text/javascript' src='http://mysqllover.com/wp-includes/js/wp-embed.min.js?ver=4.6.10'></script>
<!--stats_footer_test-->    </body>
</html>          <!-- end Footer -->