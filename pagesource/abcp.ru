<!DOCTYPE html>
<html lang="ru">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" lang="ru" content="разработка, интернет-магазины, автозапчасти, веб-проценка, запчасти, платформа abcp, создать, открыть, каталог,  открыть магазин автозапчастей, открыть магазин запчастей, открыть интернет магазин автозапчастей, программа для автобизнеса, открыть интернет магазин запчастей, купить магазин запчастей, программа учета запчастей, программы автобизнеса, рограмма продажи запчастей" />
	<meta name="description" content="Вашему вниманию предлагается программное обеспечение «Профессиональный интернет-магазин автозапчастей», позволяющее увеличить продажи, предоставить высочайший уровень сервиса для ваших клиентов и автоматизировать рутинные операции. Вы можете купить готовый интернет-магазин запчастей и начать продавать запчасти за 1 рабочий день. Для данного решения предусмотрены готовые дизайны (более 20 вариантов), готовые ролики обучения и готовый функционал профессионального участника рынка автозапчастей. Обратитесь к нашим консультантам и они помогут Вам быстро купить интернет-магазин автозапчастей и запустить его на Вашем домене." />
	<meta name="Document-state" content="Dynamic" />
	<meta name="Resource-type" content="document" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta name="google-site-verification" content="-c14x5QVXErSBQi0gKh0muKoONTTgU5cstkUPcbkHuU" />
<meta name='yandex-verification' content='79e8b1aecd555780' />

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter15779137 = new Ya.Metrika({
                    id:15779137,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true
                });
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = "https://mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/15779137" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
	<title>ABCP.RU - платформа для создания интернет магазина автозапчастей под ключ | Разработаем интернет магазин запчастей с нуля</title>
	<link href="/favicon.ico?time=1468801657" rel="shortcut icon">
	<link href="https://fonts.googleapis.com/css?family=PT+Sans:400,700,400italic&subset=latin,cyrillic" rel="stylesheet" type="text/css" />
	<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i,900,900i&subset=cyrillic,cyrillic-ext,latin-ext" rel="stylesheet">
	<script src="https://www.google.com/recaptcha/api.js?hl=ru"></script><!--Капча для регистрации-->
	



<script src="//astatic.nodacdn.net/common.jscripts/jquery/jquery-1.7.min.js"></script>

<script src="//astatic.nodacdn.net/common.jscripts/jquery/ui/jquery-ui-1.8.16.min.js"></script>
<link rel="stylesheet" href="//astatic.nodacdn.net/common.jscripts/jquery/ui/custom-theme/jquery-ui-1.9.2.custom.css" />
<script src="//astatic.nodacdn.net/common.jscripts/jquery/ui/jquery-ui-i18n.min.js?2"></script>

<script src="//astatic.nodacdn.net/common.jscripts/jquery/jquery.jgrowl_minimized.js" charset="UTF-8"></script>
<link rel="stylesheet" href="//astatic.nodacdn.net/common.jscripts/jquery/jquery.jgrowl.css" />

<script src="//astatic.nodacdn.net/common.jscripts/jquery/jquery.cookie.js"></script>

<script src="//astatic.nodacdn.net/common.jscripts/jquery/jquery.fancybox-2.1.7.min.js"></script>
<link rel="stylesheet" href="//static-files.nodacdn.net/js_libs/jquery/fb2/jquery.fancybox.css" />
<script src="//static-files.nodacdn.net/js_libs/jquery/fb2/jquery.mousewheel-3.0.2.pack.js"></script>

<script src="//astatic.nodacdn.net/common.jscripts/jquery/jquery.maskedinput-1.4.1.js"></script>
<script src="//astatic.nodacdn.net/common.jscripts/jquery.inputmask.bundle.js?abcp-2687"></script>
<script src="//astatic.nodacdn.net/common.jscripts/multimaskOptions.js?abcp-2687"></script>

<link rel="stylesheet" href="//astatic.nodacdn.net/common.jscripts/jquery/ui/jquery.multiselect.css" />
<script src="//astatic.nodacdn.net/common.jscripts/jquery/ui/jquery.multiselect.js"></script>

<script src="//astatic.nodacdn.net/common.jscripts/cssFramework.js"></script>

<link rel="stylesheet" href="//astatic.nodacdn.net/css/filters-call.order.css" />
<link rel="stylesheet" href="//astatic.nodacdn.net/css/virtual.corrections.css?3" />
<link rel="stylesheet" href="//astatic.nodacdn.net/css/global.tables.css?1"/>
<link rel="stylesheet" href="//astatic.nodacdn.net/css/carbase.css"/>
<link rel="stylesheet" href="//astatic.nodacdn.net/css/cssFramework.css?8"/>
<link rel="stylesheet" href="//astatic.nodacdn.net/css/adaptive.media.css?13"/>
<script>
	$(function() {
		(function () {
            // Синхронизируем значения в виджете и старого input
		    if ($.ui.wGoodsQuantityBuy !== undefined) {
				$.ui.wGoodsQuantityBuy.prototype.inputChangeCallbackTrash = function () {
					if ($(this).closest('form').length) {
						$(this).closest('td').find('.quantityInputFake').val($(this).val());
					}
				};
			}
		})();
	})
</script>


<script>
	var SiteLocale = '';
</script>
	<!-- Include Required Prerequisites -->
<script src="//astatic.nodacdn.net/common.jscripts/daterangepicker/moment-with-locales.min.js"></script>
<!-- Include Date Range Picker -->
<script src="//astatic.nodacdn.net/common.jscripts/daterangepicker/daterangepicker.min.js"></script>
<link rel="stylesheet" type="text/css"
      href="//astatic.nodacdn.net/common.jscripts/daterangepicker/daterangepicker.min.css"/>
<script>
    var langDateRange = {
        specificDate: 'Один день',
        allDatesBefore: 'Все даты до',
        allDatesAfter: 'Все даты после',
        dateRange: 'Выбрать дни',
        rangeStartTitle: 'С:',
        rangeEndTitle: 'По:',
        nextLinkText: 'След.',
        prevLinkText: 'Пред.'
    };

    moment.locale('ru');
    /* */
    var localizedDateTimePickerTexts = {
        today: 'Сегодня',
        /*5 дней назад*/
        fiveAndMoreDaysAgo: '5 дней назад и более',
        /*7 дней назад*/
        sevenAndMoreDaysAgo: '7 дней назад и более',
        /*За последние 7 дней*/
        last7days: 'За последние 7 дней',
        /*За последние 10 дней*/
        last10days: 'За последние 10 дней',
        /*10 дней назад и более*/
        tenAndMoreDaysAgo: '10 дней назад и более',
        /*За этот месяц*/
        thisMonth: 'За этот месяц',
        /*За последние 30 дней*/
        lastThirtyDays: 'За последние 30 дней',
        /*Предыдущий месяц*/
        previousMonth: 'Предыдущий месяц',
        /*За последние 12 месяцев*/
        thisLastYear: 'За последние 12 месяцев',
        /*За этот год*/
        thisYear: 'За этот год'
    };
    function getDateTimePickerAliasByLabel(label) {
        for (var alias in localizedDateTimePickerTexts) {
            if (localizedDateTimePickerTexts[alias] == label) {
                return alias;
            }
        }
        return label;
    }
    function getDateTimePickerLabelByAlias(alias) {
        if(localizedDateTimePickerTexts[alias]) {
            return localizedDateTimePickerTexts[alias];
        }
        return false;
    }
    var dateRangePickerRanges = {
        /* Сегодня*/
        'Сегодня': [
            moment().format('DD.MM.YYYY'),
            moment().format('DD.MM.YYYY')
        ],
        /* Неделя назад*/
        'За последние 7 дней': [
            moment().subtract(1, 'week').format('DD.MM.YYYY'),
            moment().format('DD.MM.YYYY')
        ],
        /* Этот месяц*/
        'За этот месяц': [
            moment().startOf('month').format('DD.MM.YYYY'),
            moment().format('DD.MM.YYYY')
        ],
        /* За последние 30 дней*/
        'За последние 30 дней': [
            moment().subtract(1, 'month').format('DD.MM.YYYY'),
            moment().format('DD.MM.YYYY')
        ],
        /* Этот год*/
        'За этот год': [
            moment().startOf('year').format('DD.MM.YYYY'),
            moment().format('DD.MM.YYYY')
        ],
        /* Предыдущий месяц*/
        'Предыдущий месяц': [
            moment().subtract(1, 'month').format('DD.MM.YYYY'),
            moment().format('DD.MM.YYYY')
        ],
        /*Прошлый год*/
        'За последние 12 месяцев': [
            moment().subtract(1, 'year').format('DD.MM.YYYY'),
            moment().format('DD.MM.YYYY')
        ]
    };
    var dateRangePickerLocale = {
        format: "DD.MM.YYYY",
        separator: " - ",
        customRangeLabel: 'Выбрать дни',
        fromLabel: "С:",
        toLabel: "По:"
    };
    var dateRangePickerOptions = {
        ranges: dateRangePickerRanges,
        locale: dateRangePickerLocale,
        autoApply: true
    };

</script>

<script>
	var popupMessageCloseAllNotifications = '[ Закрыть все уведомления ]';
	var popupMessageAddItemToBasket = 'Товар добавлен в корзину';
	var alertMessageAddItemToBasket = 'Такой товар уже есть в корзине в количестве xx штук. Добавить?';
	var addToCartAuthError = '<strong>Для добавления товаров в корзину необходимо авторизироваться<\/strong>';
	var addToCartDataError = '<strong>Ошибка при добавлении в корзину.<br />Попробуйте перезагрузить страницу с результатами поиска<\/strong>';
	var addToCartLimitError = '<strong>Для дальнейшего добавления новых позиций в корзину необходимо авторизироваться.<\/strong>';
	var addToCartCookieLimitError = '<strong>Для добавления этого товара в корзину необходимо авторизироваться.<\/strong>';
	var addToCartAlreadyInCartError = '<strong>Обработка данного товара имеет ограничения. Необходимо удалить товар из корзины, после чего выполнить его повторный поиск и добавить в корзину с нужным количеством.<br /><\/strong>';
	var addToCartError = '<strong>Ошибка при добавлении в корзину<\/strong>';
	var answerOptionPositive = 'Да';
	var answerOptionNegative = 'Нет';
	var chooseVendorDefaultOption = 'Выберите марку';
	var carbaseApplBlockCarManufacturer = 'Марка';
	var chooseModelDefaultOption = 'Выберите модель';
	var carbaseApplBlockCarModel = 'Модель';
	var chooseYearDefaultOption = 'Выберите год';
	var carbaseApplBlockCarYear = 'Год выпуска';
	var chooseModificationDefaultOption = 'Выберите модификацию';
	var carbaseApplBlockCarModification = 'Модификация';
	var packingAddToTrashMessage = 'Можно заказать только партиями по {PACKING_VALUES} и т.д. штук.';
	var packingTrashOrderMessage = 'Деталь {BRAND_NUMBER} можно заказать только партиями по {PACKING_VALUES} и т.д. штук.';
	var confirmCartClear = 'Вы действительно хотите очистить корзину?';
	var warningCaption = 'Внимание!';
	var clientId = null;
	var resellerId = 92056;
	var isVirtualSite = 1;
</script>

<script src="//static-files.nodacdn.net/js_libs/js_misc.js?3"></script>

	<script src="//astatic.nodacdn.net/common.jscripts/jquery/jquery.browser.min.js"></script>
	<script>
		var initSearchFormOnExtendedAutocomplete = true;
			</script>

	<link href="/static.files/default/desktop/ru_RU/css/style.css?abcp2598" rel="stylesheet" />
<script src="/static.files/default/desktop/ru_RU/js/script.js?168557"></script>
	<script src="/static.files/js/jquery.flexslider-min.js"></script>
	<!-- Client Request -->
	<script src="//astatic.nodacdn.net/common.jscripts/jquery/jquery.validate.min.js?1"></script>
	<script src="//astatic.nodacdn.net/common.jscripts/jquery/jquery.tools.min.js"></script>
	<script src="//astatic.nodacdn.net/common.jscripts/jquery.qtip.2/jquery.qtip.js?2"></script>
</head>
<body class="main">
<div class="bodyBlur">
	
	
	<div class="wrapper">
		<div class="siteNav">
			<ul>
				<li>
					<span class="abcpNav"><span class="fr-hidden-sm fr-hidden-xs">ABCP</span></span>
				</li>
				<li>
					<a href="https://carservice.abcp.ru/" title="Онлайн платформа для автосервиса" class="carserviceNav">
						<span class="fr-hidden-sm fr-hidden-xs">Carservice</span>
					</a>
				</li>
				<li>
					<a class="tecdocNav" href="https://tecdoc.abcp.ru/" title="Online TecDoc на вашем сайте">
						<span class="fr-hidden-sm fr-hidden-xs">TecDoc</span>
					</a>
				</li>
				<li>
					<a class="apiNav" href="https://api.abcp.ru/" title="База кроссов автозапчастей">
						<span class="fr-hidden-sm fr-hidden-xs">База кроссов</span>
					</a>
				</li>
				<li class="logoLink">
					<a class="vinquNav" href="https://vinqu.com/" target="_blank" title="Cервис удаленного подбора запчастей">
						<img src="/static.files/default/desktop/ru_RU/widgets/index/images/vinqu-top.svg" style="width: 80px;" alt="" />
					</a>
				</li>
				<li class="logoLink">
					<a class="formycarNav" href="https://4mycar.ru/" target="_blank" title="Поиск автозапчастей">
						<img src="/static.files/default/desktop/ru_RU/widgets/index/images/4mc-top.svg" style="width: 81px;" alt="" />
					</a>
				</li>
				<li class="right">
					<a href="https://abcp.pro/" title="">
						<img src="/static.files/default/desktop/ru_RU/widgets/index/images/en.svg" alt="" />
					</a>
				</li>
				<li class="right rightAct">
					<img src="/static.files/default/desktop/ru_RU/widgets/index/images/ru.svg" alt="" />
				</li>
			</ul>
		</div>
		<header class="head">
			<div class="layout">
				<div class="logo">
					
					<a href="/" title="ABCP - Платформа для интернет-магазина автозапчастей"><img src="/getfile.php?id_file=169799" alt="ABCP - Платформа для интернет-магазина автозапчастей"/></a>
				</div>
				<div class="head-contacts">
											<script>
							
								$(document).ready(function(){
									var selectBox = $(".selectBox");
									$(document).click(function () {
									// убираем выпадающее меню городов при клике в любом месте страницы
									selectBox.hide();
									});

									$("#pickTown").click(function () {
									selectBox.toggle();
									return false; // чтобы срабатывал текущий клик, а не общий по документу
									});

									// выбор города в выпад. меню городов
									$(".selectBox li").click(function(){
										// изменить название города
										$("#pickTown .town").html($(this).html());
										// поменять телефоны
										var townid = $(this).data("townid");
										var townphones = $(this).data("townphones");
										$(".phones span").css({opacity: 0}).html(townphones).animate({opacity: 1});
										// записать выбранный город в куки
										$.cookie('pickedtown', townid, {expires: null, path: '/'});
									});
								});
							
						</script>
						<div class="chooseTownBlock">
							<span id="pickTown">
								<span class="pickTownTxt">Выберите город:</span>
								<span class="town">Москва</span>
							</span>
							<ul class="selectBox">
																	<li data-townid="1" data-townphones="+7 (495) 668-13-74&lt;br /&gt;+7 (499) 704-22-03">Москва</li>
																	<li data-townid="2" data-townphones="+7 (812) 458-46-03">Санкт-Петербург</li>
																	<li data-townid="3" data-townphones="+7 (831) 261-30-22">Нижний Новгород</li>
																	<li data-townid="4" data-townphones="+7 (863) 209-82-80">Ростов-на-Дону</li>
																	<li data-townid="5" data-townphones="+7 (7172) 72-77-37">Астана</li>
								
							</ul>
						</div>
										<div class="contactsBlock">
						<div class="contacts">
													<a href="/start">
							<span>Написать нам</span>
						</a>
						</div>
													<div class="phones"><span>+7 (495) 668-13-74<br />+7 (499) 704-22-03</span></div>
											</div>
				</div>
			</div>
		</header>
		<nav class="mainNav">
			<div class="wMenu fr-navbar">
	<div class="fr-navbar-header">
		<button type="button" class="fr-navbar-toggle navbarToggleButton" data-toggle="collapse" data-target="#collapseMenu">
			<span class="fr-icon-list"></span>
		</button>
		<a href="/start" class="navbarClientRequestButton fr-hidden-sm  fr-hidden-md fr-hidden-lg">Подключиться</a>
	</div>
	<div class="fr-navbar-collapse fr-collapse" id="collapseMenu">
		<ul id="my-menu" class="mainMenu fr-nav">
										<li class="act">
					<a href="/main"   >Главная</a>
				</li>
							<li class="">
					<a href="/rates"   >Тарифы</a>
				</li>
							<li class="">
					<a href="/news"   >Новости</a>
				</li>
							<li class="">
					<a href="/dealers"   >Клиенты</a>
				</li>
							<li class="">
					<a href="/suppliers"   >Поставщики</a>
				</li>
							<li class="">
					<a href="/articles"   >Статьи</a>
				</li>
							<li class=" beforeLast">
					<a href="/seo-number-two"   >SEO-продвижение</a>
				</li>
							<li class="">
					<a href="/contacts"   >Контакты</a>
				</li>
			
		</ul>
	</div>
</div>
		</nav>
		<div class="baseContent main">
						<div class="contentBlock mainPage">
								<script src="/static.files/js/stat.counter.js?1"></script>
<div class="wPageMain">
    <div class="headJumbotron">
        <div class="mainTitle">
            <div class="mainPicture">
            </div>
            <div class="mainText">
                <div class="mainTitleText">
                    ИНТЕРНЕТ-МАГАЗИН<br />
                    ДЛЯ ТОРГОВЛИ АВТОЗАПЧАСТЯМИ
                </div>
                <a href="/start?tariffId=49" class="orderButton">ТЕСТ-ДРАЙВ НА 30 ДНЕЙ</a>
            </div>
        </div>
    </div>
    <div class="contentMainBlock">
        <div class="statisticBox">
            <div class="statisticCont clearfix">
                <div class="statisticContIn">
                    <div class="title">Компании и предприниматели используют платформу прямо сейчас</div>
                    <div class="statistic">
                        <div class="statisticColumn"><span class="statisticNum countQuerystat"></span>поисковых запросов</div>
                        <div class="statisticColumn"><span class="statisticNum ordersNum countOrders"></span>заказов в этом месяце</div>
                    </div>
                    <div class="viewAllStat">
                        <a href="/stat" class="mainButton mainButtonGrey">Статистика с 2008 года</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="contentMainBlockBottom">
        <div class="layout">
            <div class="webTop">
                <h1>Бесплатное обучение онлайн каждую среду</h1>
				<p>
					Следующий вебинар: <strong>21.03.2018 в 11:00 (Мск)</strong> Webinar ID: <strong> 560-086-731</strong><br />
					<a href="https://www.youtube.com/user/videoabcp/videos?sort=dd&view=0&shelf_id=0" target="_blank">Записи наших прошлых вебинаров</a>
				</p>
				<div class="webButtons">
					<div class="fr-col-row">
<div class="fr-col-xs-12 fr-col-md-6">
					<a href="https://docs.google.com/document/d/18khxLEAKcrOymqNYccQx7yM43nnm8r1ZuL6eDOosWTU/edit" target="_blank" class="mainButton mainButtonWhite">Инструкция</a>
					<a href="https://attendee.gotowebinar.com/register/3035770685367446275" target="_blank" class="mainButton">Подключиться к вебинару</a>
    </div>
    <div class="fr-col-xs-12 fr-col-md-6">
					<p>Загрузить приложение: <a class="appstore" href="https://itunes.apple.com/ru/app/gotowebinar/id1244921300?mt=8" target="_blank"></a>
						<a class="market" href="https://play.google.com/store/apps/details?id=com.logmein.gotowebinar" target="_blank"></a></p>
      </div>
    </div>
				</div>
            </div>
        </div>
    </div>
    <div class="layout">
        
    </div>
</div>
<script>
$(document).ready(function () {
  CounterStat.updateValueCount();
});
</script>
			</div>
		</div>
		<div class="pusher"></div>
	</div>
	<footer class="foot">
		<div class="footer">
			<div class="copyright">
				<span style="color: #0687b1;">&copy;</span> <a rel="nofollow" href="https://nodasoft.com/" style="text-decoration: none;">NodaSoft</a><br />Все права защищены
			</div>
			<div class="footInfo">
				<a class="fancybox.iframe" id="showOfferLink" href="https://docs.google.com/document/d/1oyyzTl6Yp0JaCaTEfyF60bfgaiL4HRpfUo0-ryulaIw/pub">Политика конфиденциальности</a>
				<script>
					$(function() {
						$("#showOfferLink").fancybox({
							autoScale: true,
							autoDimensions: true,
							width: 1200,
							height: '95%'
						});
					});
				</script>
			</div>
		</div>
	</footer>
</div>
<script src="//astatic.nodacdn.net/common.jscripts/jquery/jquery.validate.min.js?1"></script>
<script src="//astatic.nodacdn.net/common.jscripts/jquery/jquery.tools.min.js"></script>
<script src="//astatic.nodacdn.net/common.jscripts/jquery.qtip.2/jquery.qtip.js?2"></script>
<!-- Кнопка звонка на страницах сайта-->
<div id="wCallMeBtn" class="wHotIconBtn" title="Нажмите, чтобы заказать обратный звонок">
	<a href="#wCallMeBody" id="wCallMeLink">
		<div class="wHotIconCont wHotIconCircle">
			<div class="wHotIconWave wHotIconWaveStroke"></div>
			<span class="fr-icon-phone"></span>
		</div>
	</a>
</div>

<!-- Всплывающее окно с полем ввода телефона -->
<div id="wCallMeBody" class="wCallMeBody">
	<div class="wCallMeTitle">У вас есть вопросы?</div>
	<form id="wCallMeForm" class="clearfix">
		<div class="fr-col-row wCallMeErrorCont">
			<div class="fr-col-xs-12 fr-col-md-6">
				<input type="text" class="fr-form-control" name="callMePhone" id="wCallMePhone"
				       value=""
				       placeholder="Введите ваш номер телефона" />
				<input type="hidden" name="token" value=""/>
				<noscript>
					<h3>Включите поддержку JavaScript в настройках вашего браузера.</h3>
				</noscript>
			</div>
			<div class="fr-col-xs-12 fr-col-md-6">
				<input type="submit" id="wDoCallMeBtn" class="submitButton fr-btn-block" value="Жду звонка"/>
			</div>
		</div>
	</form>
	<p id="wErrorCallMessage"></p>
	<p id="wHelpCallMessage">
		Введите номер, нажмите кнопку, и менеджер перезвонит вам в течение 30 секунд.
	</p>
	<p id="wDoCallMessage">
		Мы уже набираем Ваш номер...
	</p>
</div>

    <!-- Кнопка звонка на страницах сайта-->
    <div id="wClientRequestBtn" class="wHotIconBtn" title="Нажмите, чтобы отправить запрос">
        <a href="#wClientRequestBody" id="wClientRequestLink" class="fr-hidden-xs">
            <div class="wHotIconCont wHotIconCircle">
                <div class="wHotIconWave wHotIconWaveStroke"></div>
                <span class="fr-icon-question"></span>
            </div>
        </a>
	    <a href="/start" id="wClientRequestLink" class="fr-visible-xs">
		    <div class="wHotIconCont wHotIconCircle">
			    <div class="wHotIconWave wHotIconWaveStroke"></div>
			    <span class="fr-icon-question"></span>
		    </div>
	    </a>
    </div>

    <!-- Всплывающее окно с полем ввода телефона -->
    <div id="wClientRequestBody">
        <p id="wTimeWarningMessage" class="fr-alert fr-alert-warning">
            Заказать обратный звонок можно только с <strong>9:30</strong> до <strong>17:30</strong> по московскому времени.<br />
            Задайте свой вопрос через форму, расположенную ниже, или попробуйте позже.
        </p>
        <ul class="introductionOurClientTabs clearfix">
                        <li class="active">
                                    <span class="first">Шаг 1: Заполнение анкеты</span>
                            </li>
                                <li class=" disable fr-hidden-xs">
                                    <span class="second">Шаг 2: Оплата</span>
                            </li>
                                <li class=" disable fr-hidden-xs">
                                    <span class="last">Шаг 3: Начало работы</span>
                            </li>
            
</ul>
<link href="https://fonts.googleapis.com/css?family=PT+Sans:400,700,400italic&subset=latin,cyrillic" rel="stylesheet"
      type="text/css"/>
<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet" type="text/css"/>
<!-- JS file -->
<script src="//astatic.nodacdn.net/common.jscripts/jquery/EasyAutocomplete-1.3.5/jquery.easy-autocomplete.min.js"></script>
<!-- CSS file -->
<link rel="stylesheet" href="//astatic.nodacdn.net/common.jscripts/jquery/EasyAutocomplete-1.3.5/easy-autocomplete.min.css">
<!-- Additional CSS Themes file - not required-->
<link rel="stylesheet" href="//astatic.nodacdn.net/common.jscripts/jquery/EasyAutocomplete-1.3.5/easy-autocomplete.themes.css?3">

<noscript>
    <h3>JavaScript не поддерживается или отключен в настройках вашего браузера. Корректная работа формы регистрации не гарантируется.</h3>
</noscript>

<div class="wIntroductionOurClient">
    <form method="post" action="/start" name="clientRequestForm" id="clientRequestForm"
          data-demo-tariff-id="49"
          data-demo-tariff-name="Тест-Драйв">
        <div class="clientRequestForm">
            <span class="titleIntroductionOurClient">Запрос на сотрудничество</span>
            <div class="introductionOurClientLine">
                <div class="requestFormLabel">
                    Имя <sup>*</sup>
                </div>
                <div class="requestFormControls colored">
                    <input type="text" name="name" id="name" size="40" value=""
                           title="Введите имя"/>
                </div>
            </div>
            <div class="introductionOurClientLine">
                <div class="requestFormLabel">
                    Еmail <sup>*</sup>
                    <div class="requestFormHelpText">Пример: example@yourdomain.com</div>
                </div>
                <div class="requestFormControls colored">
                    <input type="text" name="email" id="email" value=""
                           title="Введите email контактного лица"/>
                </div>
            </div>
            <div class="introductionOurClientLine">
                <div class="requestFormLabel">
                    Телефон <sup>*</sup>
                    <div class="requestFormHelpText">Пример: 9998887766</div>
                </div>
                <div class="requestFormControls colored">
                    <input type="tel" id="phoneField" name="phone" value=""
                           data-value-from-post=""
                           class="phoneCountry"
                           title="Введите контактный номер телефона" />
                </div>
            </div>
            
            <div class="introductionOurClientLine">
                <div class="requestFormLabel">
                    Страна <sup>*</sup>
                    <div class="requestFormHelpText">Пример: Россия</div>
                </div>
                <div class="requestFormControls colored">
                                                                                                            <input type="hidden" name="countryCode" id="countryCodeNewClient" value="643" />
                    <input type="text" name="country" id="countryNewClient" value="Россия"
                           title="Введите название вашей страны"/>
                </div>
            </div>
            
            <div class="introductionOurClientLine">
                <div class="requestFormLabel">
                    Город <sup>*</sup>
                    <div class="requestFormHelpText">Пример: Ростов-на-Дону</div>
                </div>
                <div class="requestFormControls colored">
                    <input type="hidden" name="cityCode" id="cityCode" />
                    <input type="text" name="cityName" id="cityName" value=""
                           title="Введите название вашего города"/>
                </div>
            </div>
            
                <div class="introductionOurClientLine">
                    <div class="requestFormLabel">
                        Выберите нужную услуг
                        <sup>*</sup>
                    </div>
                    <div class="requestFormControls colored">
                        <div class="fr-radio">
                            <label>
                                <input type="radio"  name="workMode"
                                       id="workMode_now" value="offer" class="fr-input-radio workModeInput"
                                       title="Выберите нужную услуг"/>
                                Запустить прямо-сейчас (оплата Visa/MasterCard, Qiwi, Яндекс.Деньги)
                            </label>
                        </div>
                        <div class="fr-radio">
                            <label>
                                <input type="radio"
                                                                              name="workMode"
                                       id="workMode_consultation" value="" class="fr-input-radio workModeInput"/>
                                Нужна консультация перед запуском аккаунта
                            </label>
                        </div>
                        <div class="fr-radio">
                            <label>
                                <input type="radio"                                        data-cashless-price-up="25" name="workMode"
                                       id="workMode_cashless" value="agreement" class="fr-input-radio workModeInput"/>
                                                                Заключить договор для оплаты по безналичному расчёту (дороже на 25%)
                                
                            </label>
                        </div>
                                                    <div class="fr-radio">
                                <label>
                                    <input type="radio"                                            name="workMode" id="workMode_demo" value="demo"
                                           class="fr-input-radio workModeInput"/>
                                    Я представитель компании, хочу бесплатный ТЕСТ-Драйв на 30 дней
                                    
                                </label>
                            </div>
                                                <div class="fr-radio">
                            <label>
                                <input type="radio"
                                                                              name="workMode"
                                       id="workMode_consultation" value="demoSiteAndWebinar" class="fr-input-radio workModeInput"/>
                                Я частное лицо, хочу демо-сайт и бесплатное обучение
                            </label>
                        </div>
                        <div class="fr-radio" id="workModeLastRadio">
                            <label>
                                <input type="radio"
                                                                              name="workMode"
                                       value="freePercentage" class="fr-input-radio workModeInput"/>
                                Хочу бесплатную проценку одного онлайн-поставщика без сайта
                            </label>
                        </div>
                    </div>
                </div>
            
            
                <div class="introductionOurClientLine" id="blockSelectTariff">
                    <div class="requestFormLabel">
                        Выберите тарифный план <sup>*</sup>
                    </div>
                    <div class="requestFormControls colored">
                        <select class="tariffSelect" name="tariffId" id="tariffId">
                                                                                                                                                                                                                    <option data-rental-fee-price="1900"
                                                                                data-connection-tariff-price="0"
                                        value="60">Проценка</option>
                                                                                                                            <option data-rental-fee-price="2500"
                                                                                data-connection-tariff-price="0"
                                        value="67">Mini</option>
                                                                                                                            <option data-rental-fee-price="3900"
                                                                                data-connection-tariff-price="0"
                                        value="53">Smart</option>
                                                                                                                            <option data-rental-fee-price="4900"
                                                                                data-connection-tariff-price="0"
                                        value="45">A-Klasse</option>
                                                                                                                            <option data-rental-fee-price="5900"
                                                                                data-connection-tariff-price="0"
                                        value="51">B-Klasse</option>
                                                                                                                            <option data-rental-fee-price="7000"
                                                                                data-connection-tariff-price="0"
                                        value="20">E-Klasse</option>
                                                                                                                            <option data-rental-fee-price="8500"
                                                                                data-connection-tariff-price="0"
                                        value="21">S-Klasse</option>
                                                            
                        </select>
                        <label class="fr-form-label rentalFeeLabel"
                               id="rentalFeeLabel">Ежемесячная абонентская плата - <span id="rentalFeePrice">0</span> рублей</label> 
                    </div>
                </div>
            
            <div class="introductionOurClientLine" id="blockCompanyName">
                <div class="requestFormLabel">
                    Название компании <sup>*</sup> 
                    <span class="requestFormHelpText">Пример: ИП Иванов В.А.</span>
                </div>
                <div class="requestFormControls colored">
                    <input type="text" name="companyName" id="companyName" value=""
                           title="Название компании"/>
                </div>
            </div>
            <div class="introductionOurClientLine" id="blockDomain">
                <div class="requestFormLabel">
                    Доменное имя (если нужно)
                    <span class="requestFormHelpText">Пример: avto-magic.com</span>
                </div>
                <div class="requestFormControls colored">
                    <input type="text" name="domain" id="domain" value=""
                           title="Доменное имя (если нужно)"/>
                </div>
            </div>

            <div class="introductionOurClientLine">
                <div class="requestFormLabel">
                    Ваш комментарий
                </div>
                <div class="requestFormControls colored">
                    <textarea name="comment" cols="65" rows="5"
                              title="Введите комментарий"></textarea>
                </div>
            </div>
            <div class="introductionOurClientLineBottom">
                <div class="requestFormLabel">
                    <div class="requestFormHelpText"><sup> * </sup>
                        - поля,  обязательные для заполнения
                    </div>
                </div>
                <div class="requestFormControls formRecaptcha">
                    <input type="hidden" name="token-step1" value=""/>
                    
                        <div class="offerBlock">
                            <label class="checkOfferCheckboxLabel" for="checkOfferCheckbox" id="checkOfferCheckboxLabel">
                                <input type="checkbox" name="checkOffer" id="checkOfferCheckbox"
                                       value="1"/>
                                <span id="agreeText"></span>
                            </label>
                            
                            <div id="offerAndPolicy" class="hidden">
                                
                                Я согласен с условиями <a id="showOffer" class="fancybox.iframe" href="https://docs.google.com/document/u/1/d/1KsE8nEVvolVAGffzpqh-95gJ6504dBm1Ju7ZWiCphSo/pub?embedded=true">договора-оферты</a> и <a id="showPolicy" rel="nofollow" class="fancybox.iframe" href="https://docs.google.com/document/u/1/d/1oyyzTl6Yp0JaCaTEfyF60bfgaiL4HRpfUo0-ryulaIw/pub?embedded=true">политикой конфиденциальности</a>
                            </div>
                            <div id="policyOnly" class="hidden">
                                
                                Я согласен с <a id="showPolicy" class="fancybox.iframe" href="https://docs.google.com/document/d/1oyyzTl6Yp0JaCaTEfyF60bfgaiL4HRpfUo0-ryulaIw/pub?embedded=true">политикой конфиденциальности</a>
                            </div>
                        </div>
                    
                    <input type="button" name="continue" id="step1SubmitBtn"
                           value="Продолжить"
                           class="submitButton fr-btn-block"/>
                </div>
            </div>
        </div>
        <input type="checkbox" class="hidden" name="useMobileForNotifications" id="useMobileForNotifications" checked="checked">
    </form>
    <div class="hidden">
        <div id="approvalBlock" class="approvalBlock">
            <div class="fr-alert fr-alert-info fr-alert-block">Вам отправлено SMS с кодом из 5 цифр. Введя код из SMS в поле ниже и нажав "Подтвердить", вы подтверждаете, что имеете доступ к указанному телефону.<br /> Код действителен в течении 10 минут.<br /> Если вы не получили код в течении 1 минуты, нажмите "Отправить код ещё раз" <br />или обратитесь к менеджерам сайта.</div>
            <div class="fr-alert fr-alert-block" id="approvalInfoMsg"></div>
            <div class="approvalBlockForm">
                <label class="approvalLabel">Код подтверждения
                    <input id="approvalCode" name="approvalCode" type="tel" maxLength="5" class="fr-form-control approvalCode">
                </label>
                <div class="approvalButton">
                    <button class="fr-btn fr-btn-success" id="approvalCodeBtn" type="button">Подтвердить</button>
                </div>
                <div class="approvalAgainButton">
                    <a href="#" id="getApprovalCodeAgainBtn" class="getApprovalCodeAgainBtn">Отправить код ещё раз</a>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="//astatic.nodacdn.net/common.jscripts/jquery.inputmask.bundle.js?abcp-2687"></script>
<script src="//astatic.nodacdn.net/common.jscripts/multimaskOptions.js?abcp-2687"></script>
<script>
    $(function() {
        var $phoneField = $('#phoneField');
        var oldPhone = $phoneField.val(),
            ajaxSettings = {
                url: '/',
                dataType: 'json',
                type: 'POST',
                data: { }
            },
            fancyBoxSettings = {
                href: '#approvalBlock',
                maxWidth: 550
            };

        var getApprovalCodeAgainHandler = function(e) {
            e.preventDefault();
            $('#approvalInfoMsg').text('');
            $.fancybox.update();
            var $this = $(this);
            $this.prop('disabled', true);
            ajaxSettings.data = {
                action: 'customers/sendApprovalCode',
                again: 1,
                mobilePhone: $('#phoneField').val(),
                'token-step1': $('input[name="token-step1"]').val()
            };
            $.ajax(ajaxSettings).done(function(response) {
                if (response && !response.success && response.message) {
                    $('#approvalInfoMsg')
                        .removeClass('fr-alert-success')
                        .addClass('fr-alert-danger')
                        .text(response.message);
                    $.fancybox.update();
                } else if (response && response.success && !response.message) {
                    $('#approvalInfoMsg')
                        .removeClass('fr-alert-danger')
                        .addClass('fr-alert-success')
                        .text('Код отправлен. Повторно запросить код можно через 1 минуту.');
                    $.fancybox.update();
                }
                $this.prop('disabled', false);
            });
        };

        var checkApprovalCodeHandler = function(e) {
            e.preventDefault();
            var $this = $(this);
            $this.prop('disabled', true);
            $('#approvalInfoMsg').text('');
            $.fancybox.update();
            ajaxSettings.data = {
                action: 'customers/checkApprovalCode',
                code: $('#approvalCode').val(),
                mobilePhone: $('#phoneField').val(),
                'token-step1': $('input[name="token-step1"]').val()
            };
            $.ajax(ajaxSettings).done(function(response) {
                if (response.message) {
                    $this.prop('disabled', false);
                    $('#approvalInfoMsg')
                            .removeClass('fr-alert-success')
                            .addClass('fr-alert-danger')
                            .text(response.message);
                    $.fancybox.update();
                } else if (response.success && !response.message) {
                    $('#clientRequestForm').submit();
                    $.fancybox.close();
                    $('#step1SubmitBtn').prop('disabled', true);
                }
            })
        };
        $('#approvalBlock')
            .off('click', '#getApprovalCodeAgainBtn')
            .on('click', '#getApprovalCodeAgainBtn', getApprovalCodeAgainHandler)
            .off('click', '#approvalCodeBtn')
            .on('click', '#approvalCodeBtn', checkApprovalCodeHandler);

        initValidationClientRequestForm();
        changeWorkMode($('.workModeInput:checked'));
        changeSelectedTariff();
        $('.workModeInput').off().on('click', function() {
            changeWorkMode($(this));
        });
        $("#tariffId").off().on('change', function() {
            changeSelectedTariff();
        });
        $('#step1SubmitBtn').off().on('click', function(e) {
            e.preventDefault();
            $('#approvalInfoMsg').text('');
            $.fancybox.update();
            var $tokenStep1 = $('input[name="token-step1"]');
            $tokenStep1.val(Math.random().toString(36).substring(7));
            if ($('#clientRequestForm').valid()) {
                if (oldPhone != $phoneField.val()) {
                    // Отправка SMS с кодом подтверждения
                    ajaxSettings.data = {
                        action: 'customers/sendApprovalCode',
                        again: 0,
                        mobilePhone: $('#phoneField').val(),
                        'token-step1': $tokenStep1.val()
                    };
                    $.ajax(ajaxSettings).done(function(res) {
                        if (!res.success && res.message) {
                            $('#approvalInfoMsg')
                                .removeClass('fr-alert-success')
                                .addClass('fr-alert-danger')
                                .text(res.message);
                            $.fancybox.update();
                        }
                    });
                    oldPhone = $phoneField.val();
                }
                $.fancybox(fancyBoxSettings);
                if (!$.browser.mobile) {
                    $('#approvalCode').focus();
                }
            }
        });
        initPhoneMask($phoneField);
        $phoneField.attr('placeholder', '+7 (900) 000-00-00');

        var $countryName = $('#countryNewClient'),
            $countryCode = $('#countryCodeNewClient'),
            $cityName = $('#cityName'),
            $cityCode = $('#cityCode');
        bindCountryAutoComplete($countryName, $countryCode);
        bindCityAutoComplete($cityName,$cityCode);
        initAutoRebindAutoComplete($cityName,$cityCode, $countryName, $countryCode);
        initShowOfferAndPolicyInFancyBox();
    });

    /**
     * Инициализация отображения договора-оферты и политики конфиденциальности посредством fancybox
     */
    function initShowOfferAndPolicyInFancyBox() {
        var fancyboxSettings = {
            autoScale: true,
            titlePosition: 'inside',
            autoDimensions: true,
            width: 640
        };
        $("#showOffer").fancybox(fancyboxSettings);
        $("#showPolicy").fancybox(fancyboxSettings);
    }

    /**
     * Инициализирует валидацию формы
     */
    function initValidationClientRequestForm() {
        $.validator.addMethod('hiddenCountryCode', function() {
            return !!$('#countryCodeNewClient').val();
        });
        $.validator.addMethod('hiddenCityCode', function() {
            var flag = true;
            if ($('#countryCodeNewClient').val() === '643') {
                flag = !!$('#cityCode').val();
            }
            return flag;
        });
        jQuery.validator.addMethod('phonemask', function(value, element) {
            return !!$(element).inputmask('isComplete');
        });
        $('#clientRequestForm').validate({
            ignore: ':hidden:not(textarea:hidden)',
            rules: {
                name: {
                    required: true
                },
                email: {
                    email: true,
                    required: true
                },
                phone: {
                    required: true,
                    phonemask: true
                },
                country: {
                    required: true,
                    hiddenCountryCode: true
                },
                cityName: {
                    required: true,
                    hiddenCityCode: true
                },
                workMode: {
                    required: true
                },
                tariff: {

                },
                checkOffer: {
                    required: true
                }
            },
            messages: {
                name: "Введите имя", /*Введите имя*/
                email: "Введите email контактного лица", /*Введите email контактного лица*/
                phone: "Введите телефон", /*Введите телефон*/
                country: "Введите название вашей страны и выберите вариант из списка", /*Введите название вашей страны*/
                cityName: "Введите название вашего города", /*Введите название вашего города*/
                checkOffer: "Подтвердите своё согласие" /*Подтвердите своё согласие*/
            },
            focusInvalid: true,
            errorClass: 'errormessage',
            errorElement: 'div',
            onkeyup: false,
            errorPlacement: function(error, element) {
                if (element.attr('name') == 'workMode') {
                    var workModeLastRadio = $('#workModeLastRadio');
                    error.insertAfter(workModeLastRadio);
                }
                else {
                    error.insertAfter(element);
                }
            },
            onfocusout: function(element, evt) {
                if (!this.checkable(element) && (element.name in this.submitted || !this.optional(element))) {
                    var validatorObj = this;
                    setTimeout(function() {
                        validatorObj.element(element);
                    }, $('#cityName').is($(evt.target)) ? 1000 : 0);
                }
            },
            success: $.noop // Odd workaround for errorPlacement not firing!
        });
        $("#checkOfferCheckbox").rules("add", {
            required: true,
            messages: {
                required: "Подтвердите своё согласие"
            }
        });
    }

    function changeSelectedTariff() {
        var rentalFeePrice = parseInt($("#tariffId").find(":selected").data("rentalFeePrice"));
        if (rentalFeePrice == 0) {
            $("#rentalFeeLabel").hide();
        } else {
            $("#rentalFeeLabel").show();
            $("#rentalFeePrice").html(rentalFeePrice);
            if ($("#workMode_cashless").prop("checked")) {
                //если это безналичный расчёт, увеличиваем цены на указанный %
                var cashlessPriceUp = parseInt($("#workMode_cashless").data('cashlessPriceUp'));
                var rentalFeePrice = parseInt($("#tariffId").find(":selected").data("rentalFeePrice"));
                rentalFeePrice += rentalFeePrice * cashlessPriceUp / 100;
                $("#rentalFeePrice").html(rentalFeePrice);
            }
        }
    }

    function changeWorkMode(el) {
        // если это безналичный расчёт, увеличиваем цены на указанный %
        var cashlessPriceUp = parseInt($("#workMode_cashless").data('cashlessPriceUp'));
        var rentalFeePrice = parseInt($("#tariffId").find(":selected").data("rentalFeePrice"));
        var $blockCompanyName = $("#blockCompanyName");
        var $blockSelectTariff = $("#blockSelectTariff");
        var $blockDomain = $('#blockDomain');

        if (el.val() === "agreement") {
            $('#agreeText').html($('#policyOnly').html());
            rentalFeePrice += rentalFeePrice * cashlessPriceUp / 100;
            $("#rentalFeePrice").html(rentalFeePrice);
        } else {
            $('#agreeText').html($('#offerAndPolicy').html());
            $("#rentalFeePrice").html(rentalFeePrice);
        }
        var clientRequestForm = $("#clientRequestForm");
        var demoTariffId = parseInt(clientRequestForm.data("demoTariffId"));
        if (demoTariffId > 0) {
            $("#tariffId option[value='" + demoTariffId + "']").remove();
        }
        $blockCompanyName.hide();
        $blockSelectTariff.show();
        $blockDomain.show();
        $("#companyName").rules('remove');

        if (el.val() === "") { // если это консультация добавляем необязательный тариф
            $("#tariffId option[value='0']").remove();
            var html = '<option data-rental-fee-price="0" data-connection-tariff-price="0" value="0" data-is-demo="0">'
                + "Не знаю, нужна консультация"
                +'</option>';
            $("#tariffId").append(html);
        } else if (el.val() === "demo") {
            var demoTariffName = clientRequestForm.data("demoTariffName");
            var html = '<option data-rental-fee-price="0" data-connection-tariff-price="0" value="' + demoTariffId + '">' + demoTariffName + '</option>';
            $("#tariffId").append(html);
            $("#tariffId").val(demoTariffId);
            $blockSelectTariff.hide();
            $blockCompanyName.show();
            $("#companyName").rules('add', {
                required: true,
                messages: {
                    required: "Введите название компании"
                }
            });
        } else if (el.val() === "demoSiteAndWebinar") {
            $("#tariffId").val(0);
            $blockSelectTariff.hide();
        } else if (el.val() === 'freePercentage') {
            $('#tariffId').val(0);
            $blockSelectTariff.hide();
            $blockDomain.hide();
        } else {
            $("#tariffId option[value='0']").remove();
        }
        changeSelectedTariff();
    }
</script>

    <script>
        /**
         * Инициализации маски для ввода номера телефона
         * @param $phoneSelector
         */
        function initPhoneMask($phoneSelector) {
            $phoneSelector.off().on('change', function() {
                $(this).inputmask("phone");
            });
            $phoneSelector.change();
        }
    </script>


    <script>
        /**
         * Функция снимает ограничение модуля EasyAutocomplete
         * https://github.com/pawelczak/EasyAutocomplete/issues/189#issuecomment-287937728
         */
        function hackIOSKeyUpOnAutoComplete(e) {
            if (!(e.keyCode | e.which) && /ipad|iphone|ipod/i.test(navigator.userAgent)) {
                e.keyCode = 41;
                $(this).trigger(e);
            }
        }
        /**
         * Биндит автокомплит страны на указанные инпуты
         *
         * ВНИМАНИЕ !
         * Данная функция должна вызываться только после того как на форму будет навешено событие .validate()
         * из-за использования метода .valid() внутри тела ф-ии, подробности https://jqueryvalidation.org/valid/
         * @param $countryName инпут с названием страны
         * @param $countryCode инпут с кодом страны
         */
        function bindCountryAutoComplete($countryName, $countryCode) {
            var options = {
                url: '//astatic.nodacdn.net/common.jscripts/countries.json',
                dataType: 'json',
                ajaxSettings: {
                    jsonp: 'callback',
                    jsonpCallback: 'countries',
                    dataType: 'jsonp'
                },
                list: {
                    match: {
                        enabled: true
                    },
                    onChooseEvent: function() {
                        setRealNameAndCode($countryName, $countryCode);
                        $countryName.valid();
                    },

                    onSelectItemEvent: function() {
                        $countryName.val('');
                        $countryCode.val('');
                    },
                    onMouseOverEvent: function() {
                        $countryName.val('');
                        $countryCode.val('');
                    }

                },
    //            placeholder: "Россия",
                getValue: function(element) {
                    return element.name + ' '
                        + element.searchName + ' '
                        + element.fullName + ' '
                        + element.numberCode + ' '
                        + element.alfa2 + ' '
                        + element.alfa3 + ' '
                        + element.currencyISO;
                },
                template: {
                    type: 'custom',
                    method: function(value, item) {
                        return item.name;
                    }
                },
                minCharNumber: 3,
                requestDelay: 300,
                theme: 'square'
            };
            // При попытке изменить страну вручную обнуляем инпут с кодом
            $countryName.on('input', function() {
                $countryCode.val('');
            });
            $(document).on('keyup', '#countryNewClient', hackIOSKeyUpOnAutoComplete);
            $countryName.easyAutocomplete(options);
        }

        /**
         * Навешивает автокомплит на инпут с городом
         * @param $cityName инпут с названием города
         * @param $cityCode инпут с кодом города
         */
        function bindCityAutoComplete($cityName, $cityCode) {
            var options = {
                url: '/start',
                dataType: 'json',
                ajaxSettings: {
                    type: 'POST',
                    data: {
                        action: 'getCity'
                    }
                },
                list: {
                    onChooseEvent: function() {
                        setRealNameAndCode($cityName, $cityCode);
                        $cityName.valid();
                    }
                },
                preparePostData: function(data) {
                    data.phrase = $cityName.val();
                    return data;
                },
                // по каким совпадениям искать
                getValue: function(element) {
                    return element.name;
                },
                template: {
                    type: 'custom',
                    method: function(value, item) {
                        return item['name'] + ' (' + item['region']+')';
                    }
                },
                minCharNumber: 3,
                requestDelay: 300,
                theme: 'square'
            };

            // При попытке изменить город вручную обнуляем инпут с кодом
            $cityName.on('input', function() {
                $cityCode.val('');
            });
            $(document).on('keyup', '#cityName', hackIOSKeyUpOnAutoComplete);
            $cityName.easyAutocomplete(options);
        }

        /**
         * Автоматически отписывает/подписывает автокомплит на инпут с городом
         * Используем удаление элемента и внедрение точно такого же, т.к. по умолчанию либа не имеет своей отписки
         * @param $cityName инпут с названием города
         * @param $cityCode инпут с кодом города
         * @param $countryName инпут с названием страны
         * @param $countryCode инпут с кодом страны
         */
        function initAutoRebindAutoComplete($cityName, $cityCode, $countryName, $countryCode) {
            $countryName.on('change', function() {
                setTimeout(function() { // либа не успевает проставить значение в countryCode, нужна небольшая задержка
                    $cityName.val('');
                    $cityName.off();
                    $cityCode.val('');
                    if ($countryCode.val() === '643') {
                        bindCityAutoComplete($cityName, $cityCode);
                    }
                }, 30);
            });
        }

        /**
         * Устанавливает реальное значение параметра в инпут и его код (для города и страны)
         * @param $nameInput
         * @param $codeInput
         */
        function setRealNameAndCode($nameInput, $codeInput) {
            var element = $nameInput.getSelectedItemData();
            $nameInput.val(element.name);
            $codeInput.val(element.numberCode);
        }
    </script>

    </div>

<script>
	/**
	 * Проверяет возможность звонка клиенту (зависит от дня недели и времени)
	 * @returns {boolean}
	 */
	function isAllowCallMeWidget() {
		var currentDate = new Date();
		// Меняем на Московское время
		currentDate.setHours(currentDate.getHours() + currentDate.getTimezoneOffset()/60 + 3);

		var currentDay = currentDate.getDay();
		var today = new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate());
		var diff = Math.round((currentDate - today) / 60000); // Разница в секундах от начала суток

		return !(currentDay == 0 || currentDay == 6 // Сегодня воскресенье или суббота
		|| diff < 570 // Сейчас меньше 9:30
		|| diff > 1050); // Сейчас больше 17:30
	}

	/**
	 * Отображает сообщения в диалоговом окне
	 * @param {string} outputMsg Текст сообщения
	 */
	function customAlertWidget(outputMsg) {
		if (!outputMsg)
			outputMsg = 'No Message to Display.';

		$("<div></div>").html(outputMsg).dialog({
			resizable: false,
			modal: true,
			dialogClass: "callAlert",
			width: 320,
			height: 110,
			draggable: false,
			buttons: {
				"Хорошо": function()
				{
					$( this ).dialog( "destroy" );
				}
			}
		});
	}

	/**
	 * Инициализации маски для ввода номера телефона
	 * @param $phoneSelector
	 */
	function initCallPhoneMask($phoneSelector) {
		$phoneSelector.off().on('change', function() {
			$(this).inputmask({ "mask": "+7(###)###-##-##"});
		});
		$phoneSelector.change();
	}

	$(document).ready(function() {
		jQuery.validator.addMethod('callMePhone', function(value, element, param) {
			var phoneValue = value;
			phoneValue = phoneValue.replace(/\D/g, '');
			// Звоним только в Россию, но исключаем платные 80*
			if (/^[78]([3459]\d{1}|8[^0\D])\d{8}$/.test(phoneValue)) {
				return true;
			} else {
				return false;
			}
		}, 'Значение должно быть меньше значения зависимого поля');

		var $wErrorCallMessage = $('#wErrorCallMessage');

		// Маска для поля номера телефона
		initCallPhoneMask($("#wCallMePhone"));

		$("a#wCallMeLink").click(function() {
			if (isAllowCallMeWidget()) { // Всё ОК, показываем форму звонка
				$("#timeWarningMessage").hide();
				return true;
			} else { // Показываем форму отправки запроса на сотрудничество
				$("a#clientRequestLink").trigger('click');
				$("#timeWarningMessage").show();
				return false;
			}
		});

		//Скрываем кнопку звонка в нерабочее время
		if (!isAllowCallMeWidget()) {
			$("#wCallMeBtn").hide();
		}

		$("a#wCallMeLink").fancybox({
			'width': 350,
			'height': 'auto',
			'transitionIn': 'none',
			'transitionOut': 'none',
			'overlayShow': false,
			'hideOnContentClick': true,
			'showCloseButton': true,
			helpers : {
				overlay : {
					locked : false
				}
			},
			beforeShow: function () {
				$(".bodyBlur").addClass("blur");
				$(".fancybox-overlay").css("opacity", "0.1");
				$('#wDoCallMessage').hide();
				$("#wDoCallMeBtn").removeAttr('disabled');
			},
			onUpdate: function () {
				$('body').removeClass('appleOverflow');
			},
			afterClose: function () {
				$(".bodyBlur").removeClass("blur");
				$('#helpCallMessage').show();
				$('#wDoCallMessage').hide();
				$("#wDoCallMeBtn").removeAttr('disabled');
				$('body').removeClass('appleOverflow');
			}
		});

		$('#wCallMeForm').submit(function() { // Нажали на "Позвонить мне прямо сейчас"
			$wErrorCallMessage.empty();
			if (!isAllowCallMeWidget()) {
				customAlertWidget('Заказать обратный звонок можно только с 9:30 до 17:30 по МСК. Воспользуется формой обратной связи.');

				return false;
			}

			if ($('#wCallMeForm').valid()) {
				var phoneValue = $('#wCallMePhone').val();
				phoneValue = phoneValue.replace(/\D/g, '');
				// Звоним только в Россию, но исключаем платные 80*
				if (/^7([3459]\d{1}|8[^0\D])\d{8}$/.test(phoneValue)) {
					phoneValue = phoneValue.replace(/^7/, 8);
				} else if (/^8([3459]\d{1}|8[^0\D])\d{8}$/.test(phoneValue)) {
					// Так надо!!!
				} else {
					customAlertWidget('Номер клиента задан неверно');

					return false;
				}
				$("#wDoCallMeBtn").attr('disabled', 'disabled');
				var $token = $('input[name="token"]');
				$token.val(Math.random().toString(36).substring(7));
				$.ajax({
					url: '/callMe',
					dataType: "json",
					data: {
						'callMePhone': phoneValue,
						'token': $token.val()
					},
					success: function(data) {
						if (!data.success) {
							if (data.message) {
								$wErrorCallMessage.html(data.message);
							} else {
								customAlertWidget('Неизвестная ошибка. Попробуйте позже или воспользуйтесь формой обратной связи.');
							}
							$("#wDoCallMeBtn").removeAttr('disabled');
						} else {
							$('#wHelpCallMessage').hide();
							$('#wDoCallMessage').show();
							setTimeout(function() {
								$.fancybox.close();
								$('#wHelpCallMessage').show();
								$('#wDoCallMessage').hide();
							}, 30000);
						}
					},
					error: function(jqXHR, textStatus, errorThrown){
						$("#wDoCallMeBtn").removeAttr('disabled');
						customAlertWidget('Неизвестная ошибка. Попробуйте позже или воспользуйтесь формой обратной связи.');
					}
				});
			}
			return false;
		});

		$('#wCallMeForm').validate({
			ignore: ".ignore, :hidden",
			focusInvalid: true,
			onkeyup: false,
			onfocusout: function(element) {
				$(element).valid();
			},
			rules: {
				callMePhone: {
					callMePhone: true
				}
			},
			messages: {
				callMePhone: {
					callMePhone: "Укажите номер телефона (длина 11 символов). Только для абонентов России."
				}
			},
			errorClass: 'callMeError',
			errorLabelContainer: "#helpCallMessage"
		});

		//////////////////////////////////////////////////////////////////////////
		// Кнопка вопроса ////////////////////////////////////////////////////////
		//////////////////////////////////////////////////////////////////////////

		$("a#wClientRequestLink").click(function() {
			$("#timeWarningMessage").hide();
		});

		$("a#wClientRequestLink").fancybox({
			'width': 350,
			'height': 'auto',
			'transitionIn': 'none',
			'transitionOut': 'none',
			'overlayShow': false,
			'hideOnContentClick': true,
			'showCloseButton': true,
			helpers : {
				overlay : {
					locked : false
				}
			},
			beforeShow: function () {
				$(".bodyBlur").addClass("blur");
				$(".fancybox-overlay").css("opacity", "0.2");
				$(".wTitleClientReq").text("Задать вопрос по платформе");
			},
			onUpdate: function () {
				$('body').removeClass('appleOverflow');
			},
			afterClose: function () {
				$(".bodyBlur").removeClass("blur");
				$('body').removeClass('appleOverflow');
			}
		});
	});
</script>

</body>
</html>