<!DOCTYPE html>
<!--[if !IE]>      <html class="no-js non-ie" lang="en"> <![endif]-->
<!--[if IE 7 ]>	   <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]>	   <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if IE 9 ]>	   <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
<title>Siguniang&#039;s Blog | To Thine Own Self Be True</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="https://siguniang.wordpress.com/xmlrpc.php" />

<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//s.pubmine.com' />
<link rel='dns-prefetch' href='//x.bidswitch.net' />
<link rel='dns-prefetch' href='//static.criteo.net' />
<link rel='dns-prefetch' href='//ib.adnxs.com' />
<link rel='dns-prefetch' href='//aax.amazon-adsystem.com' />
<link rel='dns-prefetch' href='//bidder.criteo.com' />
<link rel='dns-prefetch' href='//cas.criteo.com' />
<link rel='dns-prefetch' href='//gum.criteo.com' />
<link rel='dns-prefetch' href='//ads.pubmatic.com' />
<link rel='dns-prefetch' href='//gads.pubmatic.com' />
<link rel='dns-prefetch' href='//tpc.googlesyndication.com' />
<link rel='dns-prefetch' href='//ad.doubleclick.net' />
<link rel='dns-prefetch' href='//googleads.g.doubleclick.net' />
<link rel='dns-prefetch' href='//www.googletagservices.com' />
<link rel='dns-prefetch' href='//cdn.switchadhub.com' />
<link rel='dns-prefetch' href='//delivery.g.switchadhub.com' />
<link rel='dns-prefetch' href='//delivery.swid.switchadhub.com' />
<link rel="alternate" type="application/rss+xml" title="Siguniang&#039;s Blog &raquo; Feed" href="https://siguniang.wordpress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Siguniang&#039;s Blog &raquo; Comments Feed" href="https://siguniang.wordpress.com/comments/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s1.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1516999477h&ver=4.9.4"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56692,8205,9792,65039],[55357,56692,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='all-css-0-1' href='https://s0.wp.com/_static/??-eJx9kt1uwyAMhV9ozIrUVt3FtGcB4hK3gBEmi/r2I4vaUUXjBp0D37H5gyUpy7FgLBBmlfzsKAp4uqHAFUvS9qZ+3bsVeYMGN57dM7BwHvUo4Dwb7XdsU5rihSKV+1P0YMsZ63xIuqxEwJE0egwV68VCOj1Sq5zqIfb7b/glVVoZkzKKqDoGmoMqU220z23TkGYDFU8chb4RpNw9dnvQ6LAICFvSXlFFXs0WJohctsWH6FV1yMqz1YU4vhh18ZpyL5pxfcEqHVSqsb2Qtmtxo/Of+u+CpkPzG77C53AcTh/n43A4X38AMarsqA==?cssminify=yes' type='text/css' media='all' />
<script type='text/javascript' src='https://s0.wp.com/_static/??-eJyFkGEOgjAMhS/kmBiM/DGeBUbFTtbNdYPA6R0JhhhRkyZN2y+v7ZODE0iqiw2w1CkeEfy4pEzzTv4ChMHWVwEyg/SClaUAFGbW2Bo7EJHBV23qJaGr3eCc5WCAOUEb0/eTkHqE4S+mIbhK3YUHxulDNdwg7ZMu1jIBzhJjD7PIWgljG/CEk99ygd368Hf7FupiznlRng5lfiz2+gmZ+4qo'></script>
<link rel='stylesheet' id='all-css-0-2' href='https://s1.wp.com/wp-content/mu-plugins/highlander-comments/style.css?m=1377793621h&cssminify=yes' type='text/css' media='all' />
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='https://s1.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563h&#038;ver=20110606' type='text/css' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://siguniang.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress.com" />
<link rel='shortlink' href='https://wp.me/rC9I' />

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="website" />
<meta property="og:title" content="Siguniang&#039;s Blog" />
<meta property="og:description" content="To Thine Own Self Be True" />
<meta property="og:url" content="https://siguniang.wordpress.com/" />
<meta property="og:site_name" content="Siguniang&#039;s Blog" />
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@wordpressdotcom" />
<meta property="fb:app_id" content="249643311490" />
<link rel="shortcut icon" type="image/x-icon" href="https://s2.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="icon" type="image/x-icon" href="https://s2.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="apple-touch-icon-precomposed" href="https://s0.wp.com/i/webclip.png" />
<link rel='openid.server' href='https://siguniang.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='https://siguniang.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://siguniang.wordpress.com/osd.xml" title="Siguniang&#039;s Blog" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
<meta name="theme-color" content="#efefef" />
<meta name="application-name" content="Siguniang&#039;s Blog" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-tooltip" content="To Thine Own Self Be True" /><meta name="msapplication-task" content="name=Subscribe;action-uri=https://siguniang.wordpress.com/feed/;icon-uri=https://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico" /><meta name="title" content="Siguniang&#039;s Blog on WordPress.com" />
<meta name="description" content="To Thine Own Self Be True" />
		<script type="text/javascript">
		var __ATA_PP = { pt: 0, ht: 0, tn: 'responsive', amp: false, siteid: 8982 };
		var __ATA = __ATA || {};
		__ATA.cmd = __ATA.cmd || [];
		__ATA.criteo = __ATA.criteo || {};
		__ATA.criteo.cmd = __ATA.criteo.cmd || [];
		</script>
		<script type="text/javascript" src="//s.pubmine.com/head.js" async></script><style type="text/css" id="syntaxhighlighteranchor"></style>
<script type="text/javascript">
	window.google_analytics_uacct = "UA-52447-2";
</script>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-52447-2']);
	_gaq.push(['_setDomainName', 'wordpress.com']);
	_gaq.push(['_initData']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script>
</head>

<body class="home blog mp6 customizer-styles-applied highlander-enabled highlander-light infinite-scroll neverending">

<div id="container" class="hfeed">

	<div id="header">

		
	
		<div id="logo">
							<span class="site-name site-title"><a href="https://siguniang.wordpress.com/" title="Siguniang&#039;s Blog" rel="home">Siguniang&#039;s Blog</a></span>
			<span class="site-description">To Thine Own Self Be True</span>
		</div>

	
	
			<nav role="navigation" class="site-navigation main-navigation">
			<h1 class="assistive-text">Menu</h1>
			<div class="assistive-text skip-link"><a href="#content" title="Skip to content">Skip to content</a></div>

			<ul class="menu">
<li class="current_page_item"><a href="https://siguniang.wordpress.com/">Home</a></li><li class="page_item page-item-2"><a href="https://siguniang.wordpress.com/about/">About</a></li>
</ul>
		</nav><!-- .site-navigation .main-navigation -->
	
	
	</div><!-- end of #header -->

	<div id="wrapper" class="clearfix">
		<div id="content-blog" class="grid col-620">


	
		
			<div id="post-3335" class="post-3335 post type-post status-publish format-standard hentry category-algorithm category-python tag-64521853 tag-linear-programming">
				<h1 class="post-title"><a href="https://siguniang.wordpress.com/2016/01/11/solve-linear-programming-with-scipy/" rel="bookmark">SciPyで線形計画問題を解く</a></h1>

				<div class="post-meta">
				<span class="meta-prep meta-prep-author posted">Posted on </span><a href="https://siguniang.wordpress.com/2016/01/11/solve-linear-programming-with-scipy/" title="11:18 pm" rel="bookmark"><span class="timestamp">January 11, 2016</span></a><span class="byline"> by </span><span class="author vcard"><a class="url fn n" href="https://siguniang.wordpress.com/author/siguniang/" title="View all posts by siguniang">siguniang</a></span>
											<span class="comments-link">
							<span class="mdash">&mdash;</span>
							<a href="https://siguniang.wordpress.com/2016/01/11/solve-linear-programming-with-scipy/#respond">Leave a comment</a>						</span>
									</div><!-- end of .post-meta -->

				<div class="post-entry">
					
					<p><img data-attachment-id="3344" data-permalink="https://siguniang.wordpress.com/2016/01/11/solve-linear-programming-with-scipy/scipy_logo/" data-orig-file="https://siguniang.files.wordpress.com/2016/01/scipy_logo.png?w=605" data-orig-size="175,61" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="scipy_logo" data-image-description="" data-medium-file="https://siguniang.files.wordpress.com/2016/01/scipy_logo.png?w=605?w=175" data-large-file="https://siguniang.files.wordpress.com/2016/01/scipy_logo.png?w=605?w=175" class="alignnone size-full wp-image-3344" src="https://siguniang.files.wordpress.com/2016/01/scipy_logo.png?w=605" alt="scipy_logo" srcset="https://siguniang.files.wordpress.com/2016/01/scipy_logo.png 175w, https://siguniang.files.wordpress.com/2016/01/scipy_logo.png?w=150 150w" sizes="(max-width: 175px) 100vw, 175px"   /></p>
<p>Pythonの数値計算ライブラリ <a href="http://www.scipy.org/" target="_blank">SciPy</a> には線形計画問題を解くための <code>scipy.optimize.linprog</code> という関数が存在します。<br />
この関数を使って、線形計画問題を実際にといてみます。</p>
<p>例として次のような線形計画問題を考えましょう</p>
<p>maximize</p>
<p><img src="https://s0.wp.com/latex.php?latex=z+%3D+x_1+%2B+2+x_2+&#038;bg=efefef&#038;fg=555555&#038;s=0" alt="z = x_1 + 2 x_2 " title="z = x_1 + 2 x_2 " class="latex" /></p>
<p>subject to</p>
<p><img src="https://s0.wp.com/latex.php?latex=%5C%5C+x_1+%2B+3+x_2+%5Cleq+24+%5C%5C+4+x_1+%2B+4+x_2+%5Cleq+48+%5C%5C+2+x_1+%2B+x_2+%5Cleq+22+%5C%5C+x_1%2C+x_2+%5Cgeq+0+&#038;bg=efefef&#038;fg=555555&#038;s=0" alt="&#92;&#92; x_1 + 3 x_2 &#92;leq 24 &#92;&#92; 4 x_1 + 4 x_2 &#92;leq 48 &#92;&#92; 2 x_1 + x_2 &#92;leq 22 &#92;&#92; x_1, x_2 &#92;geq 0 " title="&#92;&#92; x_1 + 3 x_2 &#92;leq 24 &#92;&#92; 4 x_1 + 4 x_2 &#92;leq 48 &#92;&#92; 2 x_1 + x_2 &#92;leq 22 &#92;&#92; x_1, x_2 &#92;geq 0 " class="latex" /></p>
<p>目的関数の右辺に -1 をかけて、目的関数の最大化を目的関数の最小化に変えます。</p>
<p>minimize</p>
<p><img src="https://s0.wp.com/latex.php?latex=z+%3D+-+x_1+-2+x_2+&#038;bg=efefef&#038;fg=555555&#038;s=0" alt="z = - x_1 -2 x_2 " title="z = - x_1 -2 x_2 " class="latex" /></p>
<p>これを行列で表します。</p>
<p><img src="https://s0.wp.com/latex.php?latex=z+%3D+%5Cbegin%7Bbmatrix%7D+-1+%26+-2+%5Cend%7Bbmatrix%7D+%5Cbegin%7Bbmatrix%7D+x_1+%5C%5C+x_2+%5Cend%7Bbmatrix%7D++%5C%5C++%5Cbegin%7Bbmatrix%7D+x_1+%26+3+x_2+%5C%5C+4+x_1+%26+4+x_2+%5C%5C+2+x_1+%26+x_2+%5Cend%7Bbmatrix%7D+%5Cbegin%7Bbmatrix%7D+x_1+%5C%5C+x_2+%5Cend%7Bbmatrix%7D+%5Cle+%5Cbegin%7Bbmatrix%7D+24+%5C%5C+48+%5C%5C+22+%5Cend%7Bbmatrix%7D%2C+%5C%2C+%5Cbegin%7Bbmatrix%7D+x_1+%5C%5C+x_2+%5Cend%7Bbmatrix%7D+%5Cge+%5Cbegin%7Bbmatrix%7D+0+%5C%5C+0+%5Cend%7Bbmatrix%7D.+&#038;bg=efefef&#038;fg=555555&#038;s=0" alt="z = &#92;begin{bmatrix} -1 &amp; -2 &#92;end{bmatrix} &#92;begin{bmatrix} x_1 &#92;&#92; x_2 &#92;end{bmatrix}  &#92;&#92;  &#92;begin{bmatrix} x_1 &amp; 3 x_2 &#92;&#92; 4 x_1 &amp; 4 x_2 &#92;&#92; 2 x_1 &amp; x_2 &#92;end{bmatrix} &#92;begin{bmatrix} x_1 &#92;&#92; x_2 &#92;end{bmatrix} &#92;le &#92;begin{bmatrix} 24 &#92;&#92; 48 &#92;&#92; 22 &#92;end{bmatrix}, &#92;, &#92;begin{bmatrix} x_1 &#92;&#92; x_2 &#92;end{bmatrix} &#92;ge &#92;begin{bmatrix} 0 &#92;&#92; 0 &#92;end{bmatrix}. " title="z = &#92;begin{bmatrix} -1 &amp; -2 &#92;end{bmatrix} &#92;begin{bmatrix} x_1 &#92;&#92; x_2 &#92;end{bmatrix}  &#92;&#92;  &#92;begin{bmatrix} x_1 &amp; 3 x_2 &#92;&#92; 4 x_1 &amp; 4 x_2 &#92;&#92; 2 x_1 &amp; x_2 &#92;end{bmatrix} &#92;begin{bmatrix} x_1 &#92;&#92; x_2 &#92;end{bmatrix} &#92;le &#92;begin{bmatrix} 24 &#92;&#92; 48 &#92;&#92; 22 &#92;end{bmatrix}, &#92;, &#92;begin{bmatrix} x_1 &#92;&#92; x_2 &#92;end{bmatrix} &#92;ge &#92;begin{bmatrix} 0 &#92;&#92; 0 &#92;end{bmatrix}. " class="latex" /></p>
<p>あとは、行列をリストで表現し、SciPyプログラム(<code>linear-prog.py</code>)に落とします。</p>
<pre class="brush: plain; title: ; notranslate" title="">
# vim: set fileencoding=utf-8
c = [-1, -2] # 目的関数
A = [[1, 3], [4, 4], [2, 1]] # 決定変数の係数
b = [24, 48, 22]

# 決定変数の下限、上限
x0_bounds = (0, None)
x1_bounds = (0, None)

from scipy.optimize import linprog
res = linprog(c, A_ub=A, b_ub=b, bounds=(x0_bounds, x1_bounds),
              options={&amp;amp;quot;disp&amp;amp;quot;: True})
print res
</pre>
<p>実行します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ python linear-prog.py
Optimization terminated successfully.
         Current function value: -18.000000
         Iterations: 2
  status: 0
   slack: array([ 0.,  0.,  4.])
 success: True
     fun: -18.0
       x: array([ 6.,  6.])
 message: 'Optimization terminated successfully.'
     nit: 2
</pre>
<p><code>linprog</code>関数の引数で <code>{"disp": True}</code> にしていると</p>
<pre class="brush: plain; title: ; notranslate" title="">
Optimization terminated successfully.
         Current function value: -18.000000
         Iterations: 2
</pre>
<p>のブロックのメッセージが表示されます。</p>
<p><em>&#8220;Optimization terminated successfully.&#8221;</em> というメッセージからわかるように、問題は無事とけました。</p>
<p>出力結果をもう少し詳しく見てみましょう。</p>
<h3>status: 0</h3>
<p>最適化の終了ステータスです。</p>
<p>最適解を見つけられると 0 になります。<br />
指定されたイテレーション内にとけないなど、とけなかった時は1以上の値になります。</p>
<h3>slack: array([ 0., 0., 4.])</h3>
<p>制約の不等式を等式標準形に直します。</p>
<p>subject to<br />
<img src="https://s0.wp.com/latex.php?latex=%5C%5C+x_1+%2B+3++x_2+%2B+x_3+%3D+24+%5C%5C+4++x_1+%2B+4+x_2+%2B+x_4+%3D+48+%5C%5C+2++x_1+%2B+x_2+%2B+x_5+%3D+22+%5C%5C+x_1%2C+x_2%2C+x_3%2C+x_4%2C+x_5+%5Cgeq+0&#038;bg=efefef&#038;fg=555555&#038;s=0" alt="&#92;&#92; x_1 + 3  x_2 + x_3 = 24 &#92;&#92; 4  x_1 + 4 x_2 + x_4 = 48 &#92;&#92; 2  x_1 + x_2 + x_5 = 22 &#92;&#92; x_1, x_2, x_3, x_4, x_5 &#92;geq 0" title="&#92;&#92; x_1 + 3  x_2 + x_3 = 24 &#92;&#92; 4  x_1 + 4 x_2 + x_4 = 48 &#92;&#92; 2  x_1 + x_2 + x_5 = 22 &#92;&#92; x_1, x_2, x_3, x_4, x_5 &#92;geq 0" class="latex" /></p>
<p>目的関数が最小値を取るとき、このスラック変数 x_3, x_4, x_5 はそれぞれ 0, 0, 4 の値を取ります。</p>
<h3>fun: -18.0</h3>
<p>目的関数の最小値です。</p>
<h3>x: array([ 6., 6.])</h3>
<p>目的関数が最小値を取るとき、決定変数 x_1, x_2 はともに 6 を取ります。</p>
<h3>nit: 2</h3>
<p><em>nit</em> は<em> number of iterations</em> のことで、シンプレクス法のイテレーション数です。</p>
<h2>補足</h2>
<p>線形計画問題を解くためには SciPy よりも <a href="https://github.com/coin-or/pulp" target="_blank">PuLP</a> を使っている人のほうが多いように見受けられます。</p>
<p>現在のところ、ソルバーとしてシンプレクス法しか対応していません。</p>
<p>目的関数で最大値を求めることはできません。<br />
-1 をかけて、最小値問題に帰着させます。</p>
<p>最適結果オブジェクト(上の例では <code>res</code>) からは、各種属性 x, slack, success, status, nit, message に対して <code>res.slack</code>というようにしてアクセスできます。</p>
<h2>参考リンク</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Linear_programming" rel="nofollow">https://en.wikipedia.org/wiki/Linear_programming</a></li>
<li><a href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.linprog.html" rel="nofollow">http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.linprog.html</a></li>
</ul>
		<div class="wpcnt">
			<div class="wpa wpmrec">
				<span class="wpa-about">Advertisements</span>
				<div class="u">		<div style="padding-bottom:15px;width:300px;height:250px;float:left;margin-right:5px;margin-top:0px">
		<div id="atatags-26942-5aae9d268f27e">
			<script type="text/javascript">
			__ATA.cmd.push(function() {
				__ATA.initSlot('atatags-26942-5aae9d268f27e',  {
					collapseEmpty: 'before',
					sectionId: '26942',
					width: 300,
					height: 250
				});
			});
			</script>
		</div></div>		<div style="padding-bottom:15px;width:300px;height:250px;float:left;margin-top:0px">
		<div id="atatags-114160-5aae9d268f2b7">
			<script type="text/javascript">
			__ATA.cmd.push(function() {
				__ATA.initSlot('atatags-114160-5aae9d268f2b7',  {
					collapseEmpty: 'before',
					sectionId: '114160',
					width: 300,
					height: 250
				});
			});
			</script>
		</div></div></div>
						<div id="crt-678950961" style="width:300px;height:250px;display:none !important;"></div>
		<script type="text/javascript">
(function(){var c=function(){var a=document.getElementById("crt-678950961");window.Criteo?(a.parentNode.style.setProperty("display","inline-block","important"),a.style.setProperty("display","block","important"),window.Criteo.DisplayAcceptableAdIfAdblocked({zoneid:388248,containerid:"crt-678950961",collapseContainerIfNotAdblocked:!0,callifnotadblocked:function(){a.style.setProperty("display","none","important");a.style.setProperty("visbility","hidden","important")}})):(a.style.setProperty("display","none","important"),a.style.setProperty("visibility","hidden","important"))};if(window.Criteo)c();else{if(!__ATA.criteo.script){var b=document.createElement("script");b.src="//static.criteo.net/js/ld/publishertag.js";b.onload=function(){for(var a=0;a<__ATA.criteo.cmd.length;a++){var b=__ATA.criteo.cmd[a];"function"===typeof b&&b()}};(document.head||document.getElementsByTagName("head")[0]).appendChild(b);__ATA.criteo.script=b}__ATA.criteo.cmd.push(c)}})();
		</script>		<div id="crt-1249552782" style="width:300px;height:250px;display:none !important;"></div>
		<script type="text/javascript">
(function(){var c=function(){var a=document.getElementById("crt-1249552782");window.Criteo?(a.parentNode.style.setProperty("display","inline-block","important"),a.style.setProperty("display","block","important"),window.Criteo.DisplayAcceptableAdIfAdblocked({zoneid:837497,containerid:"crt-1249552782",collapseContainerIfNotAdblocked:!0,callifnotadblocked:function(){a.style.setProperty("display","none","important");a.style.setProperty("visbility","hidden","important")}})):(a.style.setProperty("display","none","important"),a.style.setProperty("visibility","hidden","important"))};if(window.Criteo)c();else{if(!__ATA.criteo.script){var b=document.createElement("script");b.src="//static.criteo.net/js/ld/publishertag.js";b.onload=function(){for(var a=0;a<__ATA.criteo.cmd.length;a++){var b=__ATA.criteo.cmd[a];"function"===typeof b&&b()}};(document.head||document.getElementsByTagName("head")[0]).appendChild(b);__ATA.criteo.script=b}__ATA.criteo.cmd.push(c)}})();
		</script>
			</div>
		</div>
									</div><!-- end of .post-entry -->

				<div class="post-data">
					Tagged with: <a href="https://siguniang.wordpress.com/tag/%e7%b7%9a%e5%bd%a2%e8%a8%88%e7%94%bb%e6%b3%95/" rel="tag">線形計画法</a>, <a href="https://siguniang.wordpress.com/tag/linear-programming/" rel="tag">linear programming</a><br />					Posted in <a href="https://siguniang.wordpress.com/category/algorithm/" rel="category tag">algorithm</a>, <a href="https://siguniang.wordpress.com/category/python/" rel="category tag">python</a>				</div><!-- end of .post-data -->

							</div><!-- end of #post-3335 -->
	
		
			<div id="post-3326" class="post-3326 post type-post status-publish format-standard has-post-thumbnail hentry category-algorithm category-nlp tag-f1-score tag-information-retrieval tag-precision tag-recall">
				<h1 class="post-title"><a href="https://siguniang.wordpress.com/2016/01/10/notes-on-information-retrieval-precision-recall-f1-score/" rel="bookmark">情報検索の評価についてメモ(適合率,再現率,F値)</a></h1>

				<div class="post-meta">
				<span class="meta-prep meta-prep-author posted">Posted on </span><a href="https://siguniang.wordpress.com/2016/01/10/notes-on-information-retrieval-precision-recall-f1-score/" title="11:51 pm" rel="bookmark"><span class="timestamp">January 10, 2016</span></a><span class="byline"> by </span><span class="author vcard"><a class="url fn n" href="https://siguniang.wordpress.com/author/siguniang/" title="View all posts by siguniang">siguniang</a></span>
											<span class="comments-link">
							<span class="mdash">&mdash;</span>
							<a href="https://siguniang.wordpress.com/2016/01/10/notes-on-information-retrieval-precision-recall-f1-score/#respond">Leave a comment</a>						</span>
									</div><!-- end of .post-meta -->

				<div class="post-entry">
											<a href="https://siguniang.wordpress.com/2016/01/10/notes-on-information-retrieval-precision-recall-f1-score/" title="情報検索の評価についてメモ(適合率,再現率,F値)" >
							<img width="440" height="800" src="https://siguniang.files.wordpress.com/2016/01/precisionrecall.png?w=440" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" srcset="https://siguniang.files.wordpress.com/2016/01/precisionrecall.png 440w, https://siguniang.files.wordpress.com/2016/01/precisionrecall.png?w=83 83w, https://siguniang.files.wordpress.com/2016/01/precisionrecall.png?w=165 165w" sizes="(max-width: 440px) 100vw, 440px" data-attachment-id="3333" data-permalink="https://siguniang.wordpress.com/2016/01/10/notes-on-information-retrieval-precision-recall-f1-score/precisionrecall/" data-orig-file="https://siguniang.files.wordpress.com/2016/01/precisionrecall.png" data-orig-size="440,800" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Precision-recall" data-image-description="" data-medium-file="https://siguniang.files.wordpress.com/2016/01/precisionrecall.png?w=165" data-large-file="https://siguniang.files.wordpress.com/2016/01/precisionrecall.png?w=440" />						</a>
					
					<p>あるモデルによって情報を分類した時に、どのくらいうまく分類しているのか評価するためのメトリクスについてメモ。</p>
<p>テーマを単純にするために、文書から関連する文書を探すような情報検索システムを考える。したがって、関連する・関連しないの二値分類。</p>
<p><img data-attachment-id="3333" data-permalink="https://siguniang.wordpress.com/2016/01/10/notes-on-information-retrieval-precision-recall-f1-score/precisionrecall/" data-orig-file="https://siguniang.files.wordpress.com/2016/01/precisionrecall.png?w=605" data-orig-size="440,800" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Precision-recall" data-image-description="" data-medium-file="https://siguniang.files.wordpress.com/2016/01/precisionrecall.png?w=605?w=165" data-large-file="https://siguniang.files.wordpress.com/2016/01/precisionrecall.png?w=605?w=440" class="alignnone size-full wp-image-3333" src="https://siguniang.files.wordpress.com/2016/01/precisionrecall.png?w=605" alt="Precisionrecall" srcset="https://siguniang.files.wordpress.com/2016/01/precisionrecall.png 440w, https://siguniang.files.wordpress.com/2016/01/precisionrecall.png?w=83 83w, https://siguniang.files.wordpress.com/2016/01/precisionrecall.png?w=165 165w" sizes="(max-width: 440px) 100vw, 440px"   /></p>
<h2>適合率(precision)</h2>
<p>探した文書に含まれる関連文書の割合。<br />
どれだけ正確に関連文書を探せているかを判定。</p>
<p><img data-attachment-id="3327" data-permalink="https://siguniang.wordpress.com/2016/01/10/notes-on-information-retrieval-precision-recall-f1-score/precision_calc/" data-orig-file="https://siguniang.files.wordpress.com/2016/01/precision_calc.png?w=605" data-orig-size="514,47" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="precision_calc" data-image-description="" data-medium-file="https://siguniang.files.wordpress.com/2016/01/precision_calc.png?w=605?w=300" data-large-file="https://siguniang.files.wordpress.com/2016/01/precision_calc.png?w=605?w=514" class="alignnone size-full wp-image-3327" src="https://siguniang.files.wordpress.com/2016/01/precision_calc.png?w=605" alt="precision_calc" srcset="https://siguniang.files.wordpress.com/2016/01/precision_calc.png 514w, https://siguniang.files.wordpress.com/2016/01/precision_calc.png?w=150 150w, https://siguniang.files.wordpress.com/2016/01/precision_calc.png?w=300 300w" sizes="(max-width: 514px) 100vw, 514px"   /></p>
<h2>再現率(recall)</h2>
<p>関連文書をどこまで探し出せているか。<br />
網羅性を判定。</p>
<p><img data-attachment-id="3328" data-permalink="https://siguniang.wordpress.com/2016/01/10/notes-on-information-retrieval-precision-recall-f1-score/recall_calc/" data-orig-file="https://siguniang.files.wordpress.com/2016/01/recall_calc.png?w=605" data-orig-size="485,47" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="recall_calc" data-image-description="" data-medium-file="https://siguniang.files.wordpress.com/2016/01/recall_calc.png?w=605?w=300" data-large-file="https://siguniang.files.wordpress.com/2016/01/recall_calc.png?w=605?w=485" class="alignnone size-full wp-image-3328" src="https://siguniang.files.wordpress.com/2016/01/recall_calc.png?w=605" alt="recall_calc" srcset="https://siguniang.files.wordpress.com/2016/01/recall_calc.png 485w, https://siguniang.files.wordpress.com/2016/01/recall_calc.png?w=150 150w, https://siguniang.files.wordpress.com/2016/01/recall_calc.png?w=300 300w" sizes="(max-width: 485px) 100vw, 485px"   /></p>
<h2>F値(F-score, F-measure, F_1 score)</h2>
<p>適合率と再現率はトレードオフの関係にあるため、調和平均してバランスを見るのがF値</p>
<p><img data-attachment-id="3329" data-permalink="https://siguniang.wordpress.com/2016/01/10/notes-on-information-retrieval-precision-recall-f1-score/f_calc/" data-orig-file="https://siguniang.files.wordpress.com/2016/01/f_calc.png?w=605" data-orig-size="213,46" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="f_calc" data-image-description="" data-medium-file="https://siguniang.files.wordpress.com/2016/01/f_calc.png?w=605?w=213" data-large-file="https://siguniang.files.wordpress.com/2016/01/f_calc.png?w=605?w=213" class="alignnone size-full wp-image-3329" src="https://siguniang.files.wordpress.com/2016/01/f_calc.png?w=605" alt="f_calc" srcset="https://siguniang.files.wordpress.com/2016/01/f_calc.png 213w, https://siguniang.files.wordpress.com/2016/01/f_calc.png?w=150 150w" sizes="(max-width: 213px) 100vw, 213px"   /></p>
<h2>例</h2>
<p>関連するドキュメントは relevant の頭文字をとって R、関連しないドキュメントは<br />
nonrelevant の頭文字をとって N で表すことにする。</p>
<p>3個だけ関連文書があるとする。</p>
<p>R R N R N N N N N N</p>
<h3>例1)極端な例として、システムがすべての文書を関連すると判断した場合</h3>
<p>正解 R R N R N N N N N N<br />
検索 1 1 1 1 1 1 1 1 1 1</p>
<ul>
<li>適合率 = 3 / 10 = 0.3</li>
<li>再現率 = 3 / 3 = 1.0</li>
<li>F値 ≒ 0.46</li>
</ul>
<p>当然ながら再現率は 1.0 で逆に適合率は低い。</p>
<h3>例2)極端な例として、システムが関連する1文書だけを関連すると判断した場合</h3>
<p>正解 R R N R N N N N N N<br />
検索 1 0 0 0 0 0 0 0 0 0</p>
<ul>
<li>適合率 = 1 / 1 = 1.0</li>
<li>再現率 = 1 / 3 ≒ 0.33</li>
<li>F値 = 0.5</li>
</ul>
<p>当然ながら適合率は 1.0 で逆に再現率は低い。</p>
<h3>例3)システムが関連する2文書・関連しない2文書を関連する判断した場合</h3>
<p>正解 R R N R N N N N N N<br />
検索 1 0 1 1 1 0 0 0 0 0</p>
<ul>
<li>適合率 = 2 / 4 = 0.5</li>
<li>再現率 = 2 / 3 ≒ 0.67</li>
<li>F値 = 0.57</li>
</ul>
<p>F値は例3のバランス型が一番高い。</p>
<h2>scikit learnで計算してみる</h2>
<p>Pythonの機械学習ライブラリ<a href="http://scikit-learn.org/stable/index.html" target="_blank">scikit learn</a>にはこれらを計算する関数が存在する</p>
<ul>
<li>適合率 <a href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.precision_score.html" target="_blank">sklearn.metrics.precision_score</a></li>
<li>再現率 <a href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.recall_score.html#sklearn.metrics.recall_score" target="_blank">sklearn.metrics.recall_score</a></li>
<li>F値 <a href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.f1_score.html" target="_blank">sklearn.metrics.f1_score</a></li>
</ul>
<p>上の例で実際に求めてみる。</p>
<pre class="brush: plain; title: ; notranslate" title="">
In [1]: from sklearn.metrics import precision_score, recall_score, f1_score

In [2]: def ir_metrics(y_true, y_pred):
   ...:         print &quot;true  %s &quot; % y_true
   ...:         print &quot;pred  %s &quot; % y_pred
   ...:         print &quot;precision : %.2f&quot; % precision_score(y_true, y_pred, average='binary')
   ...:         print &quot;recall    : %.2f&quot; % recall_score(y_true, y_pred, average='binary')
   ...:         print &quot;F1        : %.2f&quot; % f1_score(y_true, y_pred, average='binary')
   ...:

In [3]: print &quot;ex1&quot;
ex1

In [4]: y_true = [1, 1, 0, 1, 0, 0, 0, 0, 0, 0]

In [5]: y_pred = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]

In [6]: ir_metrics(y_true, y_pred)
true  [1, 1, 0, 1, 0, 0, 0, 0, 0, 0]
pred  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
precision : 0.30
recall    : 1.00
F1        : 0.46

In [7]: print &quot;ex2&quot;
ex2

In [8]: y_pred = [1, 0, 0, 0, 0, 0, 0, 0, 0, 0]

In [9]: ir_metrics(y_true, y_pred)
true  [1, 1, 0, 1, 0, 0, 0, 0, 0, 0]
pred  [1, 0, 0, 0, 0, 0, 0, 0, 0, 0]
precision : 1.00
recall    : 0.33
F1        : 0.50

In [10]: print &quot;ex3&quot;
ex3

In [11]: y_pred = [1, 0, 1, 1, 1, 0, 0, 0, 0, 0]

In [12]: ir_metrics(y_true, y_pred)
true  [1, 1, 0, 1, 0, 0, 0, 0, 0, 0]
pred  [1, 0, 1, 1, 1, 0, 0, 0, 0, 0]
precision : 0.50
recall    : 0.67
F1        : 0.57
</pre>
<h2>関連リンク</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Precision_and_recall" rel="nofollow">https://en.wikipedia.org/wiki/Precision_and_recall</a></li>
<li><a href="http://nlp.stanford.edu/IR-book/html/htmledition/evaluation-of-ranked-retrieval-results-1.html" rel="nofollow">http://nlp.stanford.edu/IR-book/html/htmledition/evaluation-of-ranked-retrieval-results-1.html</a></li>
</ul>
<div id="atatags-370373-5aae9d26d214e">
        <script type="text/javascript">
            __ATA.cmd.push(function() {
                __ATA.initVideoSlot('atatags-370373-5aae9d26d214e', {
                    sectionId: '370373',
                    format: 'inread'
                });
            });
        </script>
    </div>
									</div><!-- end of .post-entry -->

				<div class="post-data">
					Tagged with: <a href="https://siguniang.wordpress.com/tag/f1-score/" rel="tag">f1 score</a>, <a href="https://siguniang.wordpress.com/tag/information-retrieval/" rel="tag">information retrieval</a>, <a href="https://siguniang.wordpress.com/tag/precision/" rel="tag">precision</a>, <a href="https://siguniang.wordpress.com/tag/recall/" rel="tag">recall</a><br />					Posted in <a href="https://siguniang.wordpress.com/category/algorithm/" rel="category tag">algorithm</a>, <a href="https://siguniang.wordpress.com/category/nlp/" rel="category tag">nlp</a>				</div><!-- end of .post-data -->

							</div><!-- end of #post-3326 -->
	
		
			<div id="post-3311" class="post-3311 post type-post status-publish format-standard hentry category-algorithm category-nlp category-uncategorized">
				<h1 class="post-title"><a href="https://siguniang.wordpress.com/2015/12/30/similarity-index-of-jaccard-dice-overlap/" rel="bookmark">類似係数(Jaccard/Simpson/Dice)をPythonで求める</a></h1>

				<div class="post-meta">
				<span class="meta-prep meta-prep-author posted">Posted on </span><a href="https://siguniang.wordpress.com/2015/12/30/similarity-index-of-jaccard-dice-overlap/" title="7:44 pm" rel="bookmark"><span class="timestamp">December 30, 2015</span></a><span class="byline"> by </span><span class="author vcard"><a class="url fn n" href="https://siguniang.wordpress.com/author/siguniang/" title="View all posts by siguniang">siguniang</a></span>
											<span class="comments-link">
							<span class="mdash">&mdash;</span>
							<a href="https://siguniang.wordpress.com/2015/12/30/similarity-index-of-jaccard-dice-overlap/#respond">Leave a comment</a>						</span>
									</div><!-- end of .post-meta -->

				<div class="post-entry">
					
					<p>語が2つ与えられた時に、どのくらい似ているのか計量評価したいといった目的のために<strong>類似指数</strong>というのが存在します。</p>
<p>今回は、よく知られていて、かつ、実装の簡単な</p>
<ul>
<li>Jaccard 係数</li>
<li>Simpson 係数</li>
<li>Dice 係数</li>
</ul>
<p>を Python で実装します。</p>
<p>これら3つの係数は、0から1までの値を取り、1に近づくほど類似し、0に近づくほど類似していないことを表します。</p>
<h2>Jaccard 係数</h2>
<p>Jaccard index, Jaccard similarity coefficient などとも呼ばれます。</p>
<p>次の式で表されます。</p>
<pre class="brush: plain; title: ; notranslate" title="">
|X∩Y| / |X∪Y|
</pre>
<ul>
<li>xとYが完全一致</li>
</ul>
<p>の場合に1となります。</p>
<pre class="brush: plain; title: ; notranslate" title="">
def jaccard(x, y):
    &quot;&quot;&quot;
    Jaccard index
    Jaccard similarity coefficient
    https://en.wikipedia.org/wiki/Jaccard_index
    &quot;&quot;&quot;
    x = frozenset(x)
    y = frozenset(y)
    return len(x &amp; y) / float(len(x | y))
</pre>
<h2>Simpson 係数</h2>
<p>overlap coefficient, Szymkiewicz-Simpson coefficient などとも呼ばれます。</p>
<p>次の式で表されます。</p>
<pre class="brush: plain; title: ; notranslate" title="">
|X∩Y| / min(|X|, |Y|)
</pre>
<ul>
<li>XとYが完全一致</li>
<li>XがYの部分集合(またはその逆)</li>
</ul>
<p>の場合に1となります。</p>
<pre class="brush: plain; title: ; notranslate" title="">
def overlap(x, y):
    &quot;&quot;&quot;
    overlap coefficient
    Szymkiewicz-Simpson coefficient)
    https://en.wikipedia.org/wiki/Overlap_coefficient
    &quot;&quot;&quot;
    x = frozenset(x)
    y = frozenset(y)
    return len(x &amp; y) / float(min(map(len, (x, y))))
</pre>
<h2>Dice 係数</h2>
<p>Dice&#8217;s coefficient/Sørensen-Dice coefficient などとも呼ばれます。<br />
次の式で表されます。</p>
<pre class="brush: plain; title: ; notranslate" title="">
2 * |X∩Y| / (|X| + |Y|)
</pre>
<p>xとYが完全一致</p>
<p>の場合に1となります。</p>
<p>三角不等式を満たさないため、</p>
<pre class="brush: plain; title: ; notranslate" title="">
def dice(x, y):
    &quot;&quot;&quot;
    Dice's coefficient
    Sørensen-Dice coefficient
    https://en.wikipedia.org/wiki/Dice%27s_coefficient
    &quot;&quot;&quot;
    x = frozenset(x)
    y = frozenset(y)
    return 2 * len(x &amp; y) / float(sum(map(len, (x, y))))
</pre>
<p>計算してみる</p>
<ul>
<li>night</li>
<li>nacht</li>
<li>nuit</li>
</ul>
<p>の3語に対して、各組み合わせの類似係数を求めてみましょう。</p>
<pre class="brush: plain; title: ; notranslate" title="">
#!/usr/bin/env python
# vim: set fileencoding=utf8 :

def jaccard(x, y):
    &quot;&quot;&quot;
    Jaccard index
    Jaccard similarity coefficient
    https://en.wikipedia.org/wiki/Jaccard_index
    &quot;&quot;&quot;
    x = frozenset(x)
    y = frozenset(y)
    return len(x &amp; y) / float(len(x | y))

def overlap(x, y):
    &quot;&quot;&quot;
    overlap coefficient
    Szymkiewicz-Simpson coefficient)
    https://en.wikipedia.org/wiki/Overlap_coefficient
    &quot;&quot;&quot;
    x = frozenset(x)
    y = frozenset(y)
    return len(x &amp; y) / float(min(map(len, (x, y))))

def dice(x, y):
    &quot;&quot;&quot;
    Dice's coefficient
    Sørensen-Dice coefficient
    https://en.wikipedia.org/wiki/Dice%27s_coefficient
    &quot;&quot;&quot;
    x = frozenset(x)
    y = frozenset(y)
    return 2 * len(x &amp; y) / float(sum(map(len, (x, y))))

a = 'night'
b = 'nacht'
c = 'nuit'

for x, y in ((a,b), (a,c), (b, c)):
    print &quot;similarity between [%s] and [%s]&quot; % (x, y)
    print &quot;Jaccard:&quot;, jaccard(x, y)
    print &quot;overlap:&quot;, overlap(x, y)
    print &quot;dice:&quot;, dice(x, y)
</pre>
<p>実行してみると、次のような結果となりました。</p>
<pre class="brush: plain; title: ; notranslate" title="">
similarity between [night] and [nacht]
Jaccard: 0.428571428571
overlap: 0.6
dice: 0.6
similarity between [night] and [nuit]
Jaccard: 0.5
overlap: 0.75
dice: 0.666666666667
similarity between [nacht] and [nuit]
Jaccard: 0.285714285714
overlap: 0.5
dice: 0.444444444444
</pre>
<h2>その他</h2>
<p>今回は類似指数を「語」を対象にしましたが、2つのベクトル間の類似性を求めるなど、広い意味での類似性の抽出に利用出来ます。</p>
<h2>関連リンク</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/String_metric" rel="nofollow">https://en.wikipedia.org/wiki/String_metric</a></li>
<li><a href="https://en.wikipedia.org/wiki/Jaccard_index" rel="nofollow">https://en.wikipedia.org/wiki/Jaccard_index</a></li>
<li><a href="https://en.wikipedia.org/wiki/S%C3%B8rensen%E2%80%93Dice_coefficient" rel="nofollow">https://en.wikipedia.org/wiki/S%C3%B8rensen%E2%80%93Dice_coefficient</a></li>
<li><a href="https://en.wikipedia.org/wiki/Overlap_coefficient" rel="nofollow">https://en.wikipedia.org/wiki/Overlap_coefficient</a></li>
</ul>

									</div><!-- end of .post-entry -->

				<div class="post-data">
										Posted in <a href="https://siguniang.wordpress.com/category/algorithm/" rel="category tag">algorithm</a>, <a href="https://siguniang.wordpress.com/category/nlp/" rel="category tag">nlp</a>, <a href="https://siguniang.wordpress.com/category/uncategorized/" rel="category tag">Uncategorized</a>				</div><!-- end of .post-data -->

							</div><!-- end of #post-3311 -->
	
		
			<div id="post-3289" class="post-3289 post type-post status-publish format-standard hentry category-algorithm category-nlp category-uncategorized tag-marisa tag-trie">
				<h1 class="post-title"><a href="https://siguniang.wordpress.com/2015/12/29/play-with-marisa-trie-from-python-and-command-line/" rel="bookmark">MARISA-TrieをコマンドラインとPythonから使う</a></h1>

				<div class="post-meta">
				<span class="meta-prep meta-prep-author posted">Posted on </span><a href="https://siguniang.wordpress.com/2015/12/29/play-with-marisa-trie-from-python-and-command-line/" title="1:12 am" rel="bookmark"><span class="timestamp">December 29, 2015</span></a><span class="byline"> by </span><span class="author vcard"><a class="url fn n" href="https://siguniang.wordpress.com/author/siguniang/" title="View all posts by siguniang">siguniang</a></span>
											<span class="comments-link">
							<span class="mdash">&mdash;</span>
							<a href="https://siguniang.wordpress.com/2015/12/29/play-with-marisa-trie-from-python-and-command-line/#respond">Leave a comment</a>						</span>
									</div><!-- end of .post-meta -->

				<div class="post-entry">
					
					<h2>概要</h2>
<p><a href="http://marisa-trie.googlecode.com/svn/trunk/docs/readme.en.html" target="_blank">Matching Algorithm with Recursively Implemented StorAge (MARISA) </a>という <a href="https://en.wikipedia.org/wiki/Trie" target="_blank">Trie</a> に対する高い空間効率とそれなりの時間効率を実現するデータ構造があります。<br />
動的な更新には対応していませんが</p>
<ul>
<li>辞書引き（Lookup） : 入力文字列が登録されているかどうかを確認</li>
<li>逆引き（Reverse Lookup） : 入力された ID から登録文字列を復元</li>
<li>Common Prefix Search : 入力文字列の前半部分に一致する登録文字列を検索</li>
<li>Predictive Search : 入力文字列で始まる登録文字列を検索</li>
</ul>
<p>といった操作が可能です。</p>
<p>今回は marisa-trie 0.2.4 をベースに</p>
<ul>
<li>コマンドラインプログラム</li>
<li>Python バインディング</li>
</ul>
<p>から MARISA を触ってみます。</p>
<h2> Install MARISA</h2>
<p>環境は Amazon Linux とします。</p>
<p>まずはC++のプログラムビルドに必要なツール群をインストールします。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ sudo yum install -y gcc gcc-c++
</pre>
<p>次に C++ プログラムのよくある手順でインストールします。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ wget https://marisa-trie.googlecode.com/files/marisa-0.2.4.tar.gz
$ tar zxf marisa-0.2.4.tar.gz
$ cd marisa-0.2.4
$ ./configure
...
marisa 0.2.4 configuration:
-------------------------------
  HOST:      x86_64-unknown-linux-gnu
  CXX:       g++
  CXXFLAGS:  -g -O2
  LDFLAGS:
  PREFIX:    /usr/local

  SSE2:      no
  SSE3:      no
  SSSE3:     no
  SSE4.1:    no
  SSE4.2:    no
  SSE4a:     no
  POPCNT:    no
$ make
$ make check
...
==================
All 5 tests passed

...
$ sudo make install
$ ls -1 /usr/local/bin/
marisa-benchmark
marisa-build
marisa-common-prefix-search
marisa-dump
marisa-lookup
marisa-predictive-search
marisa-reverse-lookup
</pre>
<p>最後に Python バインディングをインストールします。</p>
<p>marisa-trie には SWIG ベースのバインディングもありますが、今回は pip ベースでインストールできるサードパーティーの marisa-trie をインストールします。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ pip install marisa-trie
</pre>
<h2>コマンドラインから MARISA を触る</h2>
<h3> 辞書の構築</h3>
<p>まずは辞書を作ります。入力データはスペルチェック用の dict を使います。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ marisa-build &lt; /usr/share/dict/words  &gt; words.dict
#keys: 479829
#nodes: 618295
size: 1429192
</pre>
<h3> Lookup</h3>
<p>入力文字列が登録されているかどうかを確認します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ marisa-lookup  words.dict
monkey
141678    monkey
</pre>
<h3> Reverse Lookup</h3>
<p>入力された ID から登録文字列を復元します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ marisa-reverse-lookup words.dict
141678
141678	monkey
</pre>
<h3> Common Prefix Search<br />
入力文字列の前半部分に一致する登録文字列を検索します。</h3>
<pre class="brush: plain; title: ; notranslate" title="">
$ marisa-common-prefix-search words.dict
monkey
5 found
6    m    monkey
191    mo    monkey
2637    mon    monkey
16164    monk    monkey
141678    monkey    monkey
</pre>
<h3>Predictive Search</h3>
<p>入力文字列で始まる登録文字列を検索します。</p>
<p>出力は 3語(<code>-n 3</code>)にしぼります。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ marisa-predictive-search -n 3 words.dict
monk
59 found
16164	monk	monk
141678	monkey	monk
341913	monkey-face	monk
</pre>
<h2>Python から MARISA を触る</h2>
<p>次に Python から MARISA を触ります。<br />
先ほどのコマンドラインの操作を Python に読み替えていきます。</p>
<h3>辞書の構築</h3>
<p>まずは辞書を作ります。入力データはスペルチェック用の dict を使います。</p>
<pre class="brush: plain; title: ; notranslate" title="">
In [1]: import marisa_trie

In [2]: with open(&quot;/usr/share/dict/words&quot;) as f:
   ...:     trie = marisa_trie.Trie(f.read().splitlines())
   ...:
</pre>
<h3>Lookup</h3>
<p>入力文字列が登録されているかどうかを確認します。</p>
<p>以下のいずれかの方法で確認できます。</p>
<pre class="brush: plain; title: ; notranslate" title="">
In [4]: u'awaken' in trie
Out[4]: True

In [5]: trie[u'awaken']
Out[5]: 130909
</pre>
<p>キーは unicode 型で渡します。string 型で渡すと TypeError が発生します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
In [8]: trie['awaken']
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
&lt;ipython-input-8-6f43e97ae7ed&gt; in &lt;module&gt;()
----&gt; 1 trie['awaken']

TypeError: Argument 'key' has incorrect type (expected unicode, got str)
</pre>
<p>存在しないキーを渡すと KeyError が発生します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
In [9]: trie[u'awaken-not-exist']
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
&lt;ipython-input-9-126ace8869e2&gt; in &lt;module&gt;()
----&gt; 1 trie[u'awaken-not-exist']

marisa_trie.pyx in marisa_trie.Trie.__getitem__ (src/marisa_trie.cpp:5920)()

marisa_trie.pyx in marisa_trie.Trie.key_id (src/marisa_trie.cpp:5787)()

KeyError: u'awaken-not-exist'
</pre>
<h3>Reverse Lookup</h3>
<p>入力された ID から登録文字列を復元します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
In [7]: trie.restore_key(130909)
Out[7]: u'awaken'
</pre>
<h3>Common Prefix Search</h3>
<p>入力文字列の前半部分に一致する登録文字列を検索します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
In [10]: trie.prefixes(u'awaken')
Out[10]: [u'a', u'aw', u'awa', u'awake', u'awaken']
</pre>
<p>イテレーター操作もできます。3件だけ表示させてみましょう。</p>
<pre class="brush: plain; title: ; notranslate" title="">
In [11]: prefixes_iterator = trie.iter_prefixes(u'awaken')

In [12]: for i in range(3):print prefixes_iterator.next()
a
aw
awa
</pre>
<h3>Predictive Search</h3>
<p>入力文字列で始まる登録文字列を検索します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
In [13]: trie.keys(u'awaken')
Out[13]:
[u'awaken',
 u'awakener',
 u'awakeners',
 u'awakened',
 u'awakening',
 u'awakeningly',
 u'awakenings',
 u'awakenable',
 u'awakenment',
 u'awakens']
</pre>
<p>イテレーター操作もできます。3件だけ表示させてみましょう。</p>
<pre class="brush: plain; title: ; notranslate" title="">
In [14]: keys_iterator = trie.iterkeys(u'awaken')

In [15]: for i in range(3):print keys_iterator.next()
awaken
awakener
awakeners
</pre>
<h2>References</h2>
<ul>
<li><a href="https://code.google.com/p/marisa-trie/" rel="nofollow">https://code.google.com/p/marisa-trie/</a></li>
<li><a href="http://marisa-trie.googlecode.com/svn/trunk/docs/readme.en.html" rel="nofollow">http://marisa-trie.googlecode.com/svn/trunk/docs/readme.en.html</a></li>
<li><a href="https://github.com/kmike/marisa-trie/" rel="nofollow">https://github.com/kmike/marisa-trie/</a></li>
</ul>

									</div><!-- end of .post-entry -->

				<div class="post-data">
					Tagged with: <a href="https://siguniang.wordpress.com/tag/marisa/" rel="tag">marisa</a>, <a href="https://siguniang.wordpress.com/tag/trie/" rel="tag">trie</a><br />					Posted in <a href="https://siguniang.wordpress.com/category/algorithm/" rel="category tag">algorithm</a>, <a href="https://siguniang.wordpress.com/category/nlp/" rel="category tag">nlp</a>, <a href="https://siguniang.wordpress.com/category/uncategorized/" rel="category tag">Uncategorized</a>				</div><!-- end of .post-data -->

							</div><!-- end of #post-3289 -->
	
		
			<div id="post-3279" class="post-3279 post type-post status-publish format-standard hentry category-python category-web tag-tornado tag-webosocket">
				<h1 class="post-title"><a href="https://siguniang.wordpress.com/2015/09/23/websocket-server-using-tornado/" rel="bookmark">tornadoでWebSocketサーバを動かしてみる</a></h1>

				<div class="post-meta">
				<span class="meta-prep meta-prep-author posted">Posted on </span><a href="https://siguniang.wordpress.com/2015/09/23/websocket-server-using-tornado/" title="11:04 pm" rel="bookmark"><span class="timestamp">September 23, 2015</span></a><span class="byline"> by </span><span class="author vcard"><a class="url fn n" href="https://siguniang.wordpress.com/author/siguniang/" title="View all posts by siguniang">siguniang</a></span>
											<span class="comments-link">
							<span class="mdash">&mdash;</span>
							<a href="https://siguniang.wordpress.com/2015/09/23/websocket-server-using-tornado/#respond">Leave a comment</a>						</span>
									</div><!-- end of .post-meta -->

				<div class="post-entry">
					
					<ol>
<li>Tornado で HTTP サーバを用意</li>
<li>HTML ファイルの JS が WebSocket サーバと通信</li>
<li>ブラウザでこの HTML ファイルを表示。</li>
<li>WebSocket クライアントが WebSocket サーバにメッセージを送信すると、HTML が書き換わる</li>
</ol>
<p>というようなシナリオを実現するシンプルなデモを作ってみました。</p>
<h2>WebSocket Server</h2>
<p>サーバには表題の通り Python Tornado を利用します。</p>
<h3>パッケージのインストール</h3>
<p>Tornado のビルドには Python のヘッダーファイルが必要です。<br />
以下は RedHat 系でのインストール例です。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ sudo yum install -y python27-devel
$ sudo pip install tornado
</pre>
<h3>コード</h3>
<p>クラス Tornado.websocket.WebSocketHandler を継承して WebSocket サーバを実装します。<br />
WebSocket サーバがメッセージを受け取ると、 on_messege ハンドラーが呼びだされます。</p>
<pre class="brush: python; title: ; notranslate" title="">
import tornado.ioloop
import tornado.web
import tornado.websocket

cl = []

class WebSocketHandler(tornado.websocket.WebSocketHandler):
    def open(self):
        if self not in cl:
            cl.append(self)

    def on_message(self, message):
        for client in cl:
            client.write_message(message)

    def on_close(self):
        if self in cl:
            cl.remove(self)

class MainHandler(tornado.web.RequestHandler):
    def get(self):
        self.render('test_ws.html')

application = tornado.web.Application([
    (r&quot;/&quot;, MainHandler),
    (r&quot;/websocket&quot;, WebSocketHandler),
])

if __name__ == &quot;__main__&quot;:
    application.listen(8080)
    tornado.ioloop.IOLoop.current().start()
</pre>
<h3>HTML/JS ファイル</h3>
<p>WebSocket 用の JavaScript は HTML ファイル内にベタッと書きます。</p>
<p>WebSocket クライアント送信されたメッセージは</p>
<pre class="brush: plain; title: ; notranslate" title="">
variable : &lt;span id=&quot;variable&quot;&gt;default&lt;/span&gt;
</pre>
<p>の箇所に反映されます。</p>
<pre class="brush: xml; title: ; notranslate" title="">

&lt;h1&gt;WebSockets Test&lt;/h1&gt;

&lt;script&gt;
  var ws;
  ws = new WebSocket(&quot;ws://54.65.113.57:8080/websocket&quot;);
  ws.onmessage = function(ev) {
    document.getElementById('variable').innerHTML = ev.data;
  }
&lt;/script&gt;


variable : &lt;span id=&quot;variable&quot;&gt;default&lt;/span&gt;


</pre>
<h2>WebSocket Client</h2>
<p>クライアントには Python 製の websocket-client を利用します。</p>
<h3>パッケージのインストール</h3>
<p>pip でインストールします。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ sudo pip install websocket-client
</pre>
<h3>コード</h3>
<p>引数で送信メッセージを受け取り、WebSocket につないでメッセージ送信します。</p>
<pre class="brush: python; title: ; notranslate" title="">
import sys
from websocket import create_connection
ws = create_connection(&quot;ws://localhost:8080/websocket&quot;)

if len(sys.argv) &gt; 1:
    message = sys.argv[1]
else:
    message = 'hello world!'

print ws.send(message)
print ws.recv()

ws.close()
</pre>
<h2>実行例</h2>
<p>サーバを起動します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ python test_ws.py
</pre>
<p>次にブラウザで HTTP://HOST:8080/ にアクセスします。</p>
<p>この状態で、クライアントプログラムからメッセージ送信します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ python test_client.py 'new value'
15
new value
</pre>
<p><code>variable</code> の箇所が書き換われば成功です。</p>
<p><a href="https://siguniang.files.wordpress.com/2015/09/tornado-websocket-demo.png"><img data-attachment-id="3281" data-permalink="https://siguniang.wordpress.com/2015/09/23/websocket-server-using-tornado/tornado-websocket-demo/" data-orig-file="https://siguniang.files.wordpress.com/2015/09/tornado-websocket-demo.png?w=605" data-orig-size="276,136" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="tornado-websocket-demo" data-image-description="" data-medium-file="https://siguniang.files.wordpress.com/2015/09/tornado-websocket-demo.png?w=605?w=276" data-large-file="https://siguniang.files.wordpress.com/2015/09/tornado-websocket-demo.png?w=605?w=276" class="alignnone size-full wp-image-3281" src="https://siguniang.files.wordpress.com/2015/09/tornado-websocket-demo.png?w=605" alt="tornado-websocket-demo" srcset="https://siguniang.files.wordpress.com/2015/09/tornado-websocket-demo.png 276w, https://siguniang.files.wordpress.com/2015/09/tornado-websocket-demo.png?w=150 150w" sizes="(max-width: 276px) 100vw, 276px"   /></a></p>
<h2>References</h2>
<ul>
<li><a href="http://tornado.readthedocs.org/en/latest/websocket.html" rel="nofollow">http://tornado.readthedocs.org/en/latest/websocket.html</a></li>
<li><a href="https://github.com/hiroakis/tornado-websocket-example" rel="nofollow">https://github.com/hiroakis/tornado-websocket-example</a></li>
</ul>

									</div><!-- end of .post-entry -->

				<div class="post-data">
					Tagged with: <a href="https://siguniang.wordpress.com/tag/tornado/" rel="tag">tornado</a>, <a href="https://siguniang.wordpress.com/tag/webosocket/" rel="tag">webosocket</a><br />					Posted in <a href="https://siguniang.wordpress.com/category/python/" rel="category tag">python</a>, <a href="https://siguniang.wordpress.com/category/web/" rel="category tag">web</a>				</div><!-- end of .post-data -->

							</div><!-- end of #post-3279 -->
	
		
			<div id="post-3274" class="post-3274 post type-post status-publish format-standard hentry category-linux tag-cpu tag-htop tag-stress tag-wall-clock-time tag-wall-time">
				<h1 class="post-title"><a href="https://siguniang.wordpress.com/2015/08/30/what-is-wall-clock-time-and-cpu-time/" rel="bookmark">real time/user CPU time/system CPU&nbsp;timeの違いをメモ</a></h1>

				<div class="post-meta">
				<span class="meta-prep meta-prep-author posted">Posted on </span><a href="https://siguniang.wordpress.com/2015/08/30/what-is-wall-clock-time-and-cpu-time/" title="4:36 pm" rel="bookmark"><span class="timestamp">August 30, 2015</span></a><span class="byline"> by </span><span class="author vcard"><a class="url fn n" href="https://siguniang.wordpress.com/author/siguniang/" title="View all posts by siguniang">siguniang</a></span>
											<span class="comments-link">
							<span class="mdash">&mdash;</span>
							<a href="https://siguniang.wordpress.com/2015/08/30/what-is-wall-clock-time-and-cpu-time/#comments">1 Comment</a>						</span>
									</div><!-- end of .post-meta -->

				<div class="post-entry">
					
					<h2>time(1) コマンドの出力内容</h2>
<p>Linux で time(1) コマンドを実行すると、real time/user CPU time/system CPU timeが出力されます。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ time prog

real    0m0.200s
user    0m0.098s
sys     0m0.004s
</pre>
<p>わかるような、わからないようなこの出力される時間の意味についてメモします。</p>
<h2>各フィールドについて</h2>
<h3>Real time について</h3>
<p>どの処理に時間がかかっているかはさておき、プログラムの開始から終了までを計測した時間</p>
<p>wall clock timeや wall time と呼ばれることもある。</p>
<h3>User CPU time について</h3>
<p>プログラムがユーザースペースで CPU が利用された時間</p>
<p>ライブラリコードの実行などがここに含まれます</p>
<h3>System CPU timeについて</h3>
<p>プログラムがカーネススペースで CPU が利用された時間</p>
<p>システムコール(例えば disk I/O で使う read/write)の実行などがここに含まれます。</p>
<h3>User/System CPU time が増えないケース</h3>
<p>ネットワークを介するプログラムは、通信の待ちが長いため、 CPU time を合算しても Real time よりはるかに少ない事が多いです。</p>
<p>sleep 処理も CPU は指定時間 idle 状態で busy ではないため、CPU time には加算されません。</p>
<h3>Real time &lt; User CPU time となるケース</h3>
<p>マルチスレッドプログラムや fork しているプログラムで表示される CPU タイムは、マルチスレッドで言えば、スレッド全体、fork であれば親子の CPU time を合算したものが利用されます。</p>
<p>例えば、マルチコアなマシーンで、マルチスレッドプログラムを実行すると、 Real time &lt; user CPU time となることもあります。</p>
<p>実際にこの動きを確認してみましょう。</p>
<h2>検証</h2>
<h3>検証方法</h3>
<p>N コアCPU なマシーンを用意し、負荷テストツール <a href="http://people.seas.harvard.edu/~apw/stress/" target="_blank">stress</a> でコア数分の CPU に CPU 100% となる負荷を T 秒間かけます。</p>
<p>time でこの負荷を計測すると</p>
<ul>
<li>Real timeは T 秒</li>
<li>user CPU time は T x N 秒</li>
</ul>
<p>となれば期待通りです。</p>
<h3>検証環境</h3>
<p>4 コアな Linux マシーンがあったので、この上で実験します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ cat /proc/cpuinfo | grep processor
processor       : 0
processor       : 1
processor       : 2
processor       : 3
</pre>
<h3>stress で負荷をかける</h3>
<p><code>yum</code> で <code>stress</code> パッケージをインストールします。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ sudo yum install -y stress
</pre>
<p>10秒間、4CPUに負荷をかけます。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ time stress -t 10 -c 4
</pre>
<p>裏で htop コマンドで負荷を確認すると、user CPUが100%ではりついています。</p>
<p><a href="https://siguniang.files.wordpress.com/2015/08/stress_htop_result.png"><img data-attachment-id="3275" data-permalink="https://siguniang.wordpress.com/2015/08/30/what-is-wall-clock-time-and-cpu-time/stress_htop_result/" data-orig-file="https://siguniang.files.wordpress.com/2015/08/stress_htop_result.png?w=605" data-orig-size="1162,214" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="stress htop" data-image-description="" data-medium-file="https://siguniang.files.wordpress.com/2015/08/stress_htop_result.png?w=605?w=300" data-large-file="https://siguniang.files.wordpress.com/2015/08/stress_htop_result.png?w=605?w=605" class="alignnone size-full wp-image-3275" src="https://siguniang.files.wordpress.com/2015/08/stress_htop_result.png?w=605" alt="stress htop" srcset="https://siguniang.files.wordpress.com/2015/08/stress_htop_result.png?w=605 605w, https://siguniang.files.wordpress.com/2015/08/stress_htop_result.png?w=150 150w, https://siguniang.files.wordpress.com/2015/08/stress_htop_result.png?w=300 300w, https://siguniang.files.wordpress.com/2015/08/stress_htop_result.png?w=768 768w, https://siguniang.files.wordpress.com/2015/08/stress_htop_result.png?w=1024 1024w, https://siguniang.files.wordpress.com/2015/08/stress_htop_result.png 1162w" sizes="(max-width: 605px) 100vw, 605px"   /></a></p>
<h3>実行結果</h3>
<p>実際の結果はというと</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ time stress -t 10 -c 4
stress: info: [2712] dispatching hogs: 4 cpu, 0 io, 0 vm, 0 hdd
stress: info: [2712] successful run completed in 10s

real    0m10.001s
user    0m39.924s
sys     0m0.000s
</pre>
<p>ということで想定通り <span style="color:#ff0000;"><strong>user = real x 4</strong> </span>という結果が得られました。</p>
<h2>References</h2>
<ul>
<li><a href="http://stackoverflow.com/questions/556405/what-do-real-user-and-sys-mean-in-the-output-of-time1" target="_blank">Stack overflow:What do &#8216;real&#8217;, &#8216;user&#8217; and &#8216;sys&#8217; mean in the output of time(1)?</a></li>
<li><a href="http://people.seas.harvard.edu/~apw/stress/" target="_blank">stress project page</a></li>
<li><a href="https://en.wikipedia.org/wiki/CPU_time" target="_blank">wikipedia CPU time</a></li>
</ul>

									</div><!-- end of .post-entry -->

				<div class="post-data">
					Tagged with: <a href="https://siguniang.wordpress.com/tag/cpu/" rel="tag">cpu</a>, <a href="https://siguniang.wordpress.com/tag/htop/" rel="tag">htop</a>, <a href="https://siguniang.wordpress.com/tag/stress/" rel="tag">stress</a>, <a href="https://siguniang.wordpress.com/tag/wall-clock-time/" rel="tag">wall clock time</a>, <a href="https://siguniang.wordpress.com/tag/wall-time/" rel="tag">wall time</a><br />					Posted in <a href="https://siguniang.wordpress.com/category/linux/" rel="category tag">linux</a>				</div><!-- end of .post-data -->

							</div><!-- end of #post-3274 -->
	
		
			<div id="post-3265" class="post-3265 post type-post status-publish format-standard hentry category-linux category-middleware tag-nfs tag-nfsv4 tag-ubuntu">
				<h1 class="post-title"><a href="https://siguniang.wordpress.com/2015/08/09/setup-nfsv4-on-ubuntu-1404/" rel="bookmark">Ubuntu14.04でNFSv4を動かしてみる</a></h1>

				<div class="post-meta">
				<span class="meta-prep meta-prep-author posted">Posted on </span><a href="https://siguniang.wordpress.com/2015/08/09/setup-nfsv4-on-ubuntu-1404/" title="10:41 pm" rel="bookmark"><span class="timestamp">August 9, 2015</span></a><span class="byline"> by </span><span class="author vcard"><a class="url fn n" href="https://siguniang.wordpress.com/author/siguniang/" title="View all posts by siguniang">siguniang</a></span>
											<span class="comments-link">
							<span class="mdash">&mdash;</span>
							<a href="https://siguniang.wordpress.com/2015/08/09/setup-nfsv4-on-ubuntu-1404/#respond">Leave a comment</a>						</span>
									</div><!-- end of .post-meta -->

				<div class="post-entry">
					
					<h2>ゴール</h2>
<ul>
<li>nfs-server</li>
<li>nfs-client</li>
</ul>
<p>というホスト名の Ubuntu 14.04 のサーバを2台用意し、<code>nfs-server</code> サーバに <a href="https://en.wikipedia.org/wiki/Network_File_System" target="_blank">Network File System </a>バージョン 4(以下 NFSv4) を構築、<code>nfs-client</code> サーバからマウントしてみる。</p>
<h2>NFSv4 サーバを構築</h2>
<p>まずは <code>nfs-server</code> に NFSv4 サーバを構築します。</p>
<h3>必要なパッケージのインストール</h3>
<p>NFS サーバに必要な <code>nfs-kernel-server</code> パッケージをインストールします。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ sudo apt-get install nfs-kernel-server
</pre>
<p><code>nfs-kernel-server </code>は NFSv3 にも対応しているようですが、今回は NFSv4 として利用します。</p>
<h3>共有ディレクトリを作成</h3>
<p>次に共有ディレクトリを作成します。<br />
今回は</p>
<ul>
<li>/tmp/no_root_squash</li>
<li>/tmp/root_squash</li>
<li>/etc</li>
</ul>
<p>を共有します。<br />
ディレクトリが存在しない <code>/tmp</code> 以下のディレクトリを作成します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ sudo mkdir -p /tmp/no_root_squash
$ sudo chown nobody:nogroup /tmp/no_root_squash
$ sudo mkdir -p /tmp/root_squash
$ sudo chown nobody:nogroup /tmp/root_squash
</pre>
<h3>共有ディレクトリを bind mount する</h3>
<p>NFSv3 では <code>export</code> するディレクトリごとに <code>export</code> していましたが、NFSv4 では擬似的に 1 ディレクトリにまとめ(pseudo file system)、実際に共有されるディレクトリは擬似ファイルシステム以下に <a href="http://unix.stackexchange.com/questions/198590/what-is-a-bind-mount" target="_blank"><code>bind</code> マウント</a>するのがお作法なようです。<br />
今回はこの pseudo file system を <code>/export</code> とします。</p>
<pre class="brush: plain; title: ; notranslate" title="">
# create nfs shared directories

$ sudo mkdir -p /export
$ sudo mkdir -p /export/etc
$ sudo mkdir -p /export/no_root_squash
$ sudo mkdir -p /export/root_squash

# bind mount

$ sudo mount --bind /tmp/no_root_squash /export/no_root_squash
$ sudo mount --bind /tmp/root_squash /export/root_squash
$ sudo mount --bind /etc /export/etc
</pre>
<p>バインドマウントできているかチェックしましょう。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ mount | grep bind
/tmp/no_root_squash on /export/no_root_squash type none (rw,bind)
/tmp/root_squash on /export/root_squash type none (rw,bind)
/etc on /export/etc type none (rw,bind)
</pre>
<p>問題なさそうですね。</p>
<h3>共有ディレクトリを export する</h3>
<p>次に共有ディレクトリを <a href="http://linux.die.net/man/8/exportfs" target="_blank">export</a> します。</p>
<p><code>/etc/exports</code> を以下のように書き換えます。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ cat /etc/exports
/export                 *(rw,sync,no_subtree_check,fsid=0,no_subtree_check)
/export/no_root_squash  *(rw,sync,no_root_squash,no_subtree_check)
/export/root_squash     *(rw,sync,no_subtree_check)
/export/etc             *(ro,sync,no_subtree_check)
</pre>
<p>ルート <code>/export</code> の <code>fsid=0</code>オプションが重要です。</p>
<p><code>nfs-server</code> で共有しているディレクトリ <code>/export</code> はクライアントからは</p>
<ul>
<li>NFSv3 では <code>nfs-server:/export</code> のようにフルパスで見えていましたが</li>
<li><code>NFSv4 では fsid=0</code> とかくと <code>nfs-server:/</code> として見えるようになります。</li>
</ul>
<p><code>fsid=/export</code> と書いても同じ意味になります。</p>
<p>この設定を <a href="http://linux.die.net/man/8/exportfs" target="_blank">exportfs</a> で NFS テーブルに反映します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ sudo exportfs -av
exporting *:/export/etc
exporting *:/export/root_squash
exporting *:/export/no_root_squash
exporting *:/export
$ cat  /var/lib/nfs/etab # NFS テーブル
/export/etc     *(ro,sync,wdelay,hide,nocrossmnt,secure,root_squash,no_all_squash,no_subtree_check,secure_locks,acl,anonuid=65534,anongid=65534)
/export/root_squash     *(rw,sync,wdelay,hide,nocrossmnt,secure,root_squash,no_all_squash,no_subtree_check,secure_locks,acl,anonuid=65534,anongid=65534)
/export/no_root_squash  *(rw,sync,wdelay,hide,nocrossmnt,secure,no_root_squash,no_all_squash,no_subtree_check,secure_locks,acl,anonuid=65534,anongid=65534)
/export *(rw,sync,wdelay,hide,nocrossmnt,secure,root_squash,no_all_squash,no_subtree_check,secure_locks,acl,fsid=0,anonuid=65534,anongid=65534)
</pre>
<p>NFS サーバを起動します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ sudo service nfs-kernel-server start
 * Exporting directories for NFS kernel daemon...
   ...done.
 * Starting NFS kernel daemon
   ...done.
</pre>
<p><code><a href="http://linux.die.net/man/8/showmount" target="_blank">showmount</a></code> コマンドで export されていることを確認します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ showmount  -e
Export list for nfs-server:
/export/etc            *
/export/root_squash    *
/export/no_root_squash *
/export                *
</pre>
<h2>クライントから共有ディレクトリをマウント</h2>
<p>次に <code>nfs-client</code> から export された共有ディレクトリをマウントします。</p>
<h3>必要なパッケージのインストール</h3>
<p>NFS マウント操作に必要な パッケージをインストールします。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ sudo apt-get install nfs-common
</pre>
<h3>export されているディレクトリを確認</h3>
<pre class="brush: plain; title: ; notranslate" title="">
$ showmount  -e nfs-server
Export list for nfs-server:
/export/etc            *
/export/root_squash    *
/export/no_root_squash *
/export                *
</pre>
<p>h3&gt;NFS マウント</p>
<p><code>nfs-server</code> の共有ディレクトリをマウントします。<br />
export 時の <code>fsid=0</code> オプションのおかげで、サーバ側のパス指定は <code>/</code> とだけ記載します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ sudo mkdir -p /mnt/nfs
$ sudo mount -t nfs4 nfs-server:/ /mnt/nfs
$ mount -t nfs4
nfs-server:/ on /mnt/nfs type nfs4 (rw,addr=10.0.8.101,clientaddr=10.0.8.102)
</pre>
<h3>NFS マウントしたディレクトリを操作</h3>
<p>試しに書き込んで見ましょう。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ sudo touch /mnt/nfs/etc/foo
touch: cannot touch `/mnt/nfs/etc/foo': Read-only file system
$ sudo touch /mnt/nfs/no_root_squash/foo
$ sudo touch /mnt/nfs/root_squash/foo
</pre>
<p>export 時に <code>ro</code> のリードオンリーオプションでエクスポートした <code>/etc</code> はエラーメッセージどおり書き込みに失敗します。</p>
<h4>root squash の確認</h4>
<p>セキュリティ対策として、リモートサーバ(今回のケースでは <code>nfs-server</code>)のファイルを root 権限で好き勝手にいじれないように、リモートでの操作にはより権限の低いユーザー識別子を割り当てる機能があります。<br />
この機能を <a href="https://en.wikipedia.org/wiki/Unix_security#Root_squash" target="_blank">root squash</a> とよび NFS では export 時のオプション(<code>root_squash/no_root_squash</code>)で指定します。</p>
<ul>
<li><code>root_squash</code></li>
<li><code>no_root_squash</code></li>
</ul>
<p>に書き込まれたファイルのオーナーを確認します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ ls -l /tmp/no_root_squash/
total 0
-rw-r--r-- 1 root root 0 Aug  9 01:52 foo
$ ls -l /tmp/root_squash/
total 0
-rw-r--r-- 1 nobody nogroup 0 Aug  9 01:52 foo
</pre>
<ul>
<li><code>root_squash</code> オプションで export した /tmp/root_squash はで権限の低い nobody:nogroup</li>
<li><code>no_root_squash</code> オプションで export した /tmp/no_root_squash ではクライアントの書き込みユーザと同じ root:root</li>
</ul>
<p>となっています。</p>
<p>当然ながら、root:root 権限のファイルは <code>root_squash</code> が有効な状態はファイル更新できません。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ ll /mnt/nfs/root_squash/
total 12
drwxr-xr-x 2 nobody nogroup 4096 Aug  9 04:28 ./
drwxr-xr-x 5 root   root    4096 Aug  9 01:25 ../
-rw-r--r-- 1 nobody nogroup    0 Aug  9 01:52 foo
-rw-r--r-- 1 root   root       0 Aug  9 03:28 root
$ sudo touch /mnt/nfs/root_squash/root
touch: cannot touch `/mnt/nfs/root_squash/root': Permission denied
</pre>
<h3><code>/etc/fstab</code> でマウント</h3>
<p>毎回 <code>mount</code> コマンドを実行するのはだるいので、<code>/etc/fstab</code> を修正します。</p>
<pre class="brush: plain; title: ; notranslate" title="">
$ cat /etc/fstab
LABEL=cloudimg-rootfs   /        ext4   defaults        0 0
nfs-server:/    /mnt/nfs        nfs4    auto,intr       0 0
</pre>
<ul>
<li><code>auto</code> オプションは、システム起動時に自動的にマウントするオプションです。</li>
<li><code>intr</code> オプションは、 NFS のファイル操作中に割り込みを受け付けるオプションです。</li>
</ul>
<p>オプションの詳細は <code>NFS(5)</code> をご確認ください。</p>
<pre class="brush: plain; title: ; notranslate" title="">
# 一旦既存のマウントをアンマウント

$ sudo umount /mnt/nfs

#  /etc/fstab の設定に従いマウント

$ sudo mount -a

# マウント状態を確認

$ mount -t nfs4
nfs-server:/ on /mnt/nfs type nfs4 (rw,intr,addr=10.0.8.101,clientaddr=10.0.8.102)
</pre>
<p>ということで期待どおりにマウントされています。</p>
<h2>参考</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Network_File_System" rel="nofollow">https://en.wikipedia.org/wiki/Network_File_System</a></li>
<li><a href="http://unix.stackexchange.com/questions/198590/what-is-a-bind-mount" rel="nofollow">http://unix.stackexchange.com/questions/198590/what-is-a-bind-mount</a></li>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-an-nfs-mount-on-ubuntu-14-04" rel="nofollow">https://www.digitalocean.com/community/tutorials/how-to-set-up-an-nfs-mount-on-ubuntu-14-04</a></li>
<li><a href="http://masahir0y.blogspot.jp/2012/12/nfs-v3-v4-rhelcentosubuntu.html" rel="nofollow">http://masahir0y.blogspot.jp/2012/12/nfs-v3-v4-rhelcentosubuntu.html</a></li>
<li><a href="https://help.ubuntu.com/community/SettingUpNFSHowTo" rel="nofollow">https://help.ubuntu.com/community/SettingUpNFSHowTo</a></li>
<li><a href="http://www.citi.umich.edu/projects/nfsv4/linux/using-nfsv4.html" rel="nofollow">http://www.citi.umich.edu/projects/nfsv4/linux/using-nfsv4.html</a></li>
</ul>

									</div><!-- end of .post-entry -->

				<div class="post-data">
					Tagged with: <a href="https://siguniang.wordpress.com/tag/nfs/" rel="tag">NFS</a>, <a href="https://siguniang.wordpress.com/tag/nfsv4/" rel="tag">nfsv4</a>, <a href="https://siguniang.wordpress.com/tag/ubuntu/" rel="tag">ubuntu</a><br />					Posted in <a href="https://siguniang.wordpress.com/category/linux/" rel="category tag">linux</a>, <a href="https://siguniang.wordpress.com/category/middleware/" rel="category tag">middleware</a>				</div><!-- end of .post-data -->

							</div><!-- end of #post-3265 -->
	
				<div class="navigation">
			<div class="previous"><a href="https://siguniang.wordpress.com/page/2/" >&#8249; Older posts</a></div>
			<div class="next"></div>
		</div><!-- end of .navigation -->
		

		</div><!-- end of #content -->


		<div id="widgets" class="grid col-300 fit">
		
					<div id="recent-posts-2" class="widget-wrapper widget_recent_entries">		<div class="widget-title">LATEST POSTS</div>		<ul>
											<li>
					<a href="https://siguniang.wordpress.com/2016/01/11/solve-linear-programming-with-scipy/">SciPyで線形計画問題を解く</a>
									</li>
											<li>
					<a href="https://siguniang.wordpress.com/2016/01/10/notes-on-information-retrieval-precision-recall-f1-score/">情報検索の評価についてメモ(適合率,再現率,F値)</a>
									</li>
											<li>
					<a href="https://siguniang.wordpress.com/2015/12/30/similarity-index-of-jaccard-dice-overlap/">類似係数(Jaccard/Simpson/Dice)をPythonで求める</a>
									</li>
											<li>
					<a href="https://siguniang.wordpress.com/2015/12/29/play-with-marisa-trie-from-python-and-command-line/">MARISA-TrieをコマンドラインとPythonから使う</a>
									</li>
											<li>
					<a href="https://siguniang.wordpress.com/2015/09/23/websocket-server-using-tornado/">tornadoでWebSocketサーバを動かしてみる</a>
									</li>
											<li>
					<a href="https://siguniang.wordpress.com/2015/08/30/what-is-wall-clock-time-and-cpu-time/">real time/user CPU time/system CPU&nbsp;timeの違いをメモ</a>
									</li>
											<li>
					<a href="https://siguniang.wordpress.com/2015/08/09/setup-nfsv4-on-ubuntu-1404/">Ubuntu14.04でNFSv4を動かしてみる</a>
									</li>
											<li>
					<a href="https://siguniang.wordpress.com/2015/08/02/so-you-want-to-write-your-own-aws-cli-waiters/">AWS CLIにオレオレwaitコマンドを追加する</a>
									</li>
											<li>
					<a href="https://siguniang.wordpress.com/2015/07/02/command-line-arguments-from-a-file-content/">bashでコマンドライン引数にファイルの中身を渡す</a>
									</li>
											<li>
					<a href="https://siguniang.wordpress.com/2015/06/21/notes-on-wrk-http-benchmarking-tool/">HTTP ベンチマークツール wrk&nbsp;についてメモ</a>
									</li>
					</ul>
		</div><div id="archives-4" class="widget-wrapper widget_archive"><div class="widget-title">Archives</div>		<label class="screen-reader-text" for="archives-dropdown-4">Archives</label>
		<select id="archives-dropdown-4" name="archive-dropdown" onchange='document.location.href=this.options[this.selectedIndex].value;'>
			
			<option value="">Select Month</option>
				<option value='https://siguniang.wordpress.com/2016/01/'> January 2016 &nbsp;(2)</option>
	<option value='https://siguniang.wordpress.com/2015/12/'> December 2015 &nbsp;(2)</option>
	<option value='https://siguniang.wordpress.com/2015/09/'> September 2015 &nbsp;(1)</option>
	<option value='https://siguniang.wordpress.com/2015/08/'> August 2015 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2015/07/'> July 2015 &nbsp;(1)</option>
	<option value='https://siguniang.wordpress.com/2015/06/'> June 2015 &nbsp;(4)</option>
	<option value='https://siguniang.wordpress.com/2015/05/'> May 2015 &nbsp;(2)</option>
	<option value='https://siguniang.wordpress.com/2015/04/'> April 2015 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2015/03/'> March 2015 &nbsp;(4)</option>
	<option value='https://siguniang.wordpress.com/2015/02/'> February 2015 &nbsp;(4)</option>
	<option value='https://siguniang.wordpress.com/2015/01/'> January 2015 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2014/12/'> December 2014 &nbsp;(4)</option>
	<option value='https://siguniang.wordpress.com/2014/11/'> November 2014 &nbsp;(4)</option>
	<option value='https://siguniang.wordpress.com/2014/10/'> October 2014 &nbsp;(1)</option>
	<option value='https://siguniang.wordpress.com/2014/09/'> September 2014 &nbsp;(4)</option>
	<option value='https://siguniang.wordpress.com/2014/08/'> August 2014 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2014/07/'> July 2014 &nbsp;(1)</option>
	<option value='https://siguniang.wordpress.com/2014/06/'> June 2014 &nbsp;(6)</option>
	<option value='https://siguniang.wordpress.com/2014/05/'> May 2014 &nbsp;(5)</option>
	<option value='https://siguniang.wordpress.com/2014/04/'> April 2014 &nbsp;(4)</option>
	<option value='https://siguniang.wordpress.com/2014/03/'> March 2014 &nbsp;(5)</option>
	<option value='https://siguniang.wordpress.com/2014/02/'> February 2014 &nbsp;(8)</option>
	<option value='https://siguniang.wordpress.com/2014/01/'> January 2014 &nbsp;(7)</option>
	<option value='https://siguniang.wordpress.com/2013/12/'> December 2013 &nbsp;(6)</option>
	<option value='https://siguniang.wordpress.com/2013/11/'> November 2013 &nbsp;(8)</option>
	<option value='https://siguniang.wordpress.com/2013/10/'> October 2013 &nbsp;(10)</option>
	<option value='https://siguniang.wordpress.com/2013/09/'> September 2013 &nbsp;(6)</option>
	<option value='https://siguniang.wordpress.com/2013/08/'> August 2013 &nbsp;(5)</option>
	<option value='https://siguniang.wordpress.com/2013/07/'> July 2013 &nbsp;(4)</option>
	<option value='https://siguniang.wordpress.com/2013/06/'> June 2013 &nbsp;(1)</option>
	<option value='https://siguniang.wordpress.com/2013/05/'> May 2013 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2013/04/'> April 2013 &nbsp;(8)</option>
	<option value='https://siguniang.wordpress.com/2013/03/'> March 2013 &nbsp;(8)</option>
	<option value='https://siguniang.wordpress.com/2013/02/'> February 2013 &nbsp;(7)</option>
	<option value='https://siguniang.wordpress.com/2013/01/'> January 2013 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2012/12/'> December 2012 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2012/11/'> November 2012 &nbsp;(5)</option>
	<option value='https://siguniang.wordpress.com/2012/10/'> October 2012 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2012/09/'> September 2012 &nbsp;(8)</option>
	<option value='https://siguniang.wordpress.com/2012/08/'> August 2012 &nbsp;(4)</option>
	<option value='https://siguniang.wordpress.com/2012/07/'> July 2012 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2012/06/'> June 2012 &nbsp;(2)</option>
	<option value='https://siguniang.wordpress.com/2012/05/'> May 2012 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2012/04/'> April 2012 &nbsp;(6)</option>
	<option value='https://siguniang.wordpress.com/2012/03/'> March 2012 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2012/02/'> February 2012 &nbsp;(6)</option>
	<option value='https://siguniang.wordpress.com/2012/01/'> January 2012 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2011/12/'> December 2011 &nbsp;(4)</option>
	<option value='https://siguniang.wordpress.com/2011/11/'> November 2011 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2011/10/'> October 2011 &nbsp;(5)</option>
	<option value='https://siguniang.wordpress.com/2011/09/'> September 2011 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2011/07/'> July 2011 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2011/06/'> June 2011 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2011/04/'> April 2011 &nbsp;(5)</option>
	<option value='https://siguniang.wordpress.com/2011/03/'> March 2011 &nbsp;(2)</option>
	<option value='https://siguniang.wordpress.com/2011/02/'> February 2011 &nbsp;(1)</option>
	<option value='https://siguniang.wordpress.com/2011/01/'> January 2011 &nbsp;(1)</option>
	<option value='https://siguniang.wordpress.com/2010/12/'> December 2010 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2010/11/'> November 2010 &nbsp;(9)</option>
	<option value='https://siguniang.wordpress.com/2010/10/'> October 2010 &nbsp;(2)</option>
	<option value='https://siguniang.wordpress.com/2010/09/'> September 2010 &nbsp;(9)</option>
	<option value='https://siguniang.wordpress.com/2010/08/'> August 2010 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2010/07/'> July 2010 &nbsp;(4)</option>
	<option value='https://siguniang.wordpress.com/2010/06/'> June 2010 &nbsp;(2)</option>
	<option value='https://siguniang.wordpress.com/2010/05/'> May 2010 &nbsp;(1)</option>
	<option value='https://siguniang.wordpress.com/2010/04/'> April 2010 &nbsp;(4)</option>
	<option value='https://siguniang.wordpress.com/2010/03/'> March 2010 &nbsp;(1)</option>
	<option value='https://siguniang.wordpress.com/2010/02/'> February 2010 &nbsp;(4)</option>
	<option value='https://siguniang.wordpress.com/2010/01/'> January 2010 &nbsp;(1)</option>
	<option value='https://siguniang.wordpress.com/2009/12/'> December 2009 &nbsp;(2)</option>
	<option value='https://siguniang.wordpress.com/2009/11/'> November 2009 &nbsp;(6)</option>
	<option value='https://siguniang.wordpress.com/2009/10/'> October 2009 &nbsp;(5)</option>
	<option value='https://siguniang.wordpress.com/2009/09/'> September 2009 &nbsp;(3)</option>
	<option value='https://siguniang.wordpress.com/2009/08/'> August 2009 &nbsp;(10)</option>
	<option value='https://siguniang.wordpress.com/2009/07/'> July 2009 &nbsp;(7)</option>

		</select>
		</div><div id="categories-2" class="widget-wrapper widget_categories"><div class="widget-title">CATEGORIES</div>		<ul>
	<li class="cat-item cat-item-18127"><a href="https://siguniang.wordpress.com/category/algorithm/" >algorithm</a>
</li>
	<li class="cat-item cat-item-144203"><a href="https://siguniang.wordpress.com/category/aws/" >aws</a>
</li>
	<li class="cat-item cat-item-475"><a href="https://siguniang.wordpress.com/category/database/" >database</a>
</li>
	<li class="cat-item cat-item-79"><a href="https://siguniang.wordpress.com/category/hardware/" >Hardware</a>
</li>
	<li class="cat-item cat-item-124"><a href="https://siguniang.wordpress.com/category/life/" >life</a>
</li>
	<li class="cat-item cat-item-610"><a href="https://siguniang.wordpress.com/category/linux/" >linux</a>
</li>
	<li class="cat-item cat-item-29632"><a href="https://siguniang.wordpress.com/category/middleware/" >middleware</a>
</li>
	<li class="cat-item cat-item-120"><a href="https://siguniang.wordpress.com/category/mobile/" >mobile</a>
</li>
	<li class="cat-item cat-item-22434"><a href="https://siguniang.wordpress.com/category/msoffice/" >MSOffice</a>
</li>
	<li class="cat-item cat-item-47433"><a href="https://siguniang.wordpress.com/category/nlp/" >nlp</a>
</li>
	<li class="cat-item cat-item-458"><a href="https://siguniang.wordpress.com/category/php/" >PHP</a>
</li>
	<li class="cat-item cat-item-1019"><a href="https://siguniang.wordpress.com/category/project/" >project</a>
</li>
	<li class="cat-item cat-item-832"><a href="https://siguniang.wordpress.com/category/python/" >python</a>
</li>
	<li class="cat-item cat-item-10189"><a href="https://siguniang.wordpress.com/category/r/" >R</a>
</li>
	<li class="cat-item cat-item-17573"><a href="https://siguniang.wordpress.com/category/report/" >report</a>
</li>
	<li class="cat-item cat-item-30930"><a href="https://siguniang.wordpress.com/category/tip/" >tip</a>
</li>
	<li class="cat-item cat-item-1"><a href="https://siguniang.wordpress.com/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-365075"><a href="https://siguniang.wordpress.com/category/visualize/" >visualize</a>
</li>
	<li class="cat-item cat-item-151"><a href="https://siguniang.wordpress.com/category/web/" >web</a>
</li>
	<li class="cat-item cat-item-800"><a href="https://siguniang.wordpress.com/category/windows/" >Windows</a>
</li>
		</ul>
</div>
		</div><!-- end of #widgets -->
	</div><!-- end of #wrapper -->

</div><!-- end of #container -->

<div id="footer" class="clearfix">

	<div id="footer-wrapper">

		<div class="grid col-940">

		<div class="grid col-540">
				</div><!-- end of col-540 -->

		
		</div><!-- end of col-940 -->
		
	
		<div class="grid col-300 copyright">
			&copy; 2018 <a href="https://siguniang.wordpress.com/" title="Siguniang&#039;s Blog">Siguniang&#039;s Blog</a>
		</div><!-- end of .copyright -->

		<div class="grid col-300 scroll-top"><a href="#scroll-top" title="scroll to top">&uarr;</a></div>

		<div class="grid col-300 fit powered">
						<a href="https://wordpress.com/?ref=footer_blog">Blog at WordPress.com.</a>
			
					</div><!-- end .powered -->

	</div><!-- end #footer-wrapper -->

</div><!-- end #footer -->

		<script type="text/javascript">
		//<![CDATA[
		var infiniteScroll = {"settings":{"id":"content-blog","ajaxurl":"https:\/\/siguniang.wordpress.com\/?infinity=scrolling","type":"scroll","wrapper":true,"wrapper_class":"infinite-wrap","footer":"wrapper","click_handle":"1","text":"Older posts","totop":"Scroll back to top","currentday":"09.08.15","order":"DESC","scripts":[],"styles":[],"google_analytics":false,"offset":0,"history":{"host":"siguniang.wordpress.com","path":"\/page\/%d\/","use_trailing_slashes":true,"parameters":""},"query_args":{"error":"","m":"","p":0,"post_parent":"","subpost":"","subpost_id":"","attachment":"","attachment_id":0,"name":"","pagename":"","page_id":0,"second":"","minute":"","hour":"","day":0,"monthnum":0,"year":0,"w":0,"category_name":"","tag":"","cat":"","tag_id":"","author":"","author_name":"","feed":"","tb":"","paged":0,"meta_key":"","meta_value":"","preview":"","s":"","sentence":"","title":"","fields":"","menu_order":"","embed":"","category__in":[],"category__not_in":[],"category__and":[],"post__in":[],"post__not_in":[],"post_name__in":[],"tag__in":[],"tag__not_in":[],"tag__and":[],"tag_slug__in":[],"tag_slug__and":[],"post_parent__in":[],"post_parent__not_in":[],"author__in":[],"author__not_in":[],"posts_per_page":7,"ignore_sticky_posts":false,"suppress_filters":false,"cache_results":false,"update_post_term_cache":true,"lazy_load_term_meta":true,"update_post_meta_cache":true,"post_type":"","nopaging":false,"comments_per_page":"50","no_found_rows":false,"order":"DESC"},"last_post_date":"2015-08-09 22:41:57","stats":"blog=6581530&v=wpcom&tz=9&user_id=0&subd=siguniang&x_pagetype=infinite"}};
		//]]>
		</script>
		<!--  -->
<script type='text/javascript' src='//0.gravatar.com/js/gprofiles.js?ver=201811y'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://s1.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1380573781h'></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {

			if (typeof Gravatar === "undefined"){
				return;
			}

			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	</div>
<script type='text/javascript'>
/* <![CDATA[ */
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"https:\/\/siguniang.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/siguniang.wordpress.com\/wp-login.php?action=logout&_wpnonce=4fa5ac7276","homeURL":"https:\/\/siguniang.wordpress.com\/","postID":"3335","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"0","userIsLoggedIn":"","isJetpack":"","text_direction":"ltr"};
/* ]]> */
</script>
<script type='text/javascript' src='https://s2.wp.com/_static/??/wp-content/js/jquery/jquery.autoresize.js,/wp-content/mu-plugins/highlander-comments/script.js?m=1516198001j'></script>
		<div id="infinite-footer">
			<div class="container">
				<div class="blog-info">
					<a id="infinity-blog-title" href="https://siguniang.wordpress.com/" rel="home">
						Siguniang&#039;s Blog					</a>
				</div>
				<div class="blog-credits">
					<a href="https://wordpress.com/?ref=footer_blog">Blog at WordPress.com.</a> 				</div>
			</div>
		</div><!-- #infinite-footer -->
		
	<div id="carousel-reblog-box">
		<form action="#" name="carousel-reblog">
			<textarea id="carousel-reblog-content" name="carousel-reblog-content" placeholder="Add your thoughts here... (optional)"></textarea>
			<label for="carousel-reblog-to-blog-id" id="carousel-reblog-lblogid">Post to</label>
			<select name="carousel-reblog-to-blog-id" id="carousel-reblog-to-blog-id">
						</select>

			<div class="submit">
				<span class="canceltext"><a href="#" class="cancel">Cancel</a></span>
				<input type="submit" name="carousel-reblog-submit" class="button" id="carousel-reblog-submit" value="Reblog Post" />
				<input type="hidden" id="carousel-reblog-blog-id" value="6581530" />
				<input type="hidden" id="carousel-reblog-blog-url" value="https://siguniang.wordpress.com" />
				<input type="hidden" id="carousel-reblog-blog-title" value="Siguniang&#039;s Blog" />
				<input type="hidden" id="carousel-reblog-post-url" value="" />
				<input type="hidden" id="carousel-reblog-post-title" value="" />
			</div>

			<input type="hidden" id="_wpnonce" name="_wpnonce" value="a8671c427f" /><input type="hidden" name="_wp_http_referer" value="/" />		</form>

		<div class="arrow"></div>
	</div>
<script type='text/javascript' src='https://s1.wp.com/_static/??-eJzTLy/QTc7PK0nNK9EvyClNz8wr1i+uzCtJrMjITM/IAeKS1CJMEWP94uSizIISoOIM5/yiVL2sYh19yo1yKiotzgjISczMo6qBlSUZ+VQ1MSI3B2icfa6toYmRkbGJkaGxSRYAC15/7g=='></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?m=1363304414h&amp;ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

// Infinite scroll support
jQuery( function( $ ) {
	$( document.body ).on( 'post-load', function() {
		SyntaxHighlighter.highlight();
	} );
} );
</script>
<link rel='stylesheet' id='all-css-0-3' href='https://s1.wp.com/wp-content/mu-plugins/carousel/jetpack-carousel.css?m=1481571546h&cssminify=yes' type='text/css' media='all' />
<!--[if lte IE 8]>
<link rel='stylesheet' id='jetpack-carousel-ie8fix-css'  href='https://s1.wp.com/wp-content/mu-plugins/carousel/jetpack-carousel-ie8fix.css?m=1412618825h&#038;ver=20121024' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='all-css-2-3' href='https://s1.wp.com/wp-content/mu-plugins/tiled-gallery/tiled-gallery.css?m=1443731146h&cssminify=yes' type='text/css' media='all' />
<script type='text/javascript'>
/* <![CDATA[ */
var actionbardata = {"siteID":"6581530","siteName":"Siguniang's Blog","siteURL":"http:\/\/siguniang.wordpress.com","icon":"<img alt='' src='https:\/\/s1.wp.com\/i\/logo\/wpcom-gray-white.png' class='avatar avatar-50' height='50' width='50' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/responsive","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/siguniang.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fsiguniang.wordpress.com%2F2016%2F01%2F11%2Fsolve-linear-programming-with-scipy%2F","themeURL":"","xhrURL":"https:\/\/siguniang.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"cbcc4be18e","isSingular":"","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"76bea5959b\" \/>","referer":"https:\/\/siguniang.wordpress.com\/","canFollow":"1","feedID":"2226656","statusMessage":"","customizeLink":"https:\/\/siguniang.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fsiguniang.wordpress.com%2F","i18n":{"view":"View site","follow":"Follow","following":"Following","edit":"Edit","login":"Log in","signup":"Sign up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: Responsive","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editSubs":"Manage subscriptions","viewReader":"View site in Reader","viewReadPost":"View post in Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/siguniang.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fsiguniang.wordpress.com%2F2016%2F01%2F11%2Fsolve-linear-programming-with-scipy%2F\">Log in now.<\/a>","stats":"Stats"}};
/* ]]> */
</script>
<script type='text/javascript'>
/* <![CDATA[ */
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/siguniang.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"f037c3e137","display_exif":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/siguniang.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fsiguniang.wordpress.com%2F2016%2F01%2F11%2Fsolve-linear-programming-with-scipy%2F","blog_id":"6581530","local_comments_commenting_as":"<fieldset><label for=\"email\">Email (Required)<\/label> <input type=\"text\" name=\"email\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-email-field\" \/><\/fieldset><fieldset><label for=\"author\">Name (Required)<\/label> <input type=\"text\" name=\"author\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-author-field\" \/><\/fieldset><fieldset><label for=\"url\">Website<\/label> <input type=\"text\" name=\"url\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-url-field\" \/><\/fieldset>","reblog":"Reblog","reblogged":"Reblogged","reblog_add_thoughts":"Add your thoughts here... (optional)","reblogging":"Reblogging...","post_reblog":"Post Reblog","stats_query_args":"blog=6581530&v=wpcom&tz=9&user_id=0&subd=siguniang","is_public":"1","reblog_enabled":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://s1.wp.com/_static/??-eJyVkF1uAyEMhC9U6uan6lPVs7Csk5iAodhs2tsHIu02SqVV+zY2M5/GwCUbl1iRFbzAiBM5zF/PXp7g7ilWk0M9EgsEOqPAZ8WKJ8tjwLJiJj4Qk34v4tGrJ4wNl+sABSUnFpqwN/mZjLhCWeXPUYk2BBOR60ozO0ZiM9gC0YpiacqkCUuhsUGX3T8JWqw7/2p6H3JKiXtoUStuZ0uqggE8am5kMy/mDLELtRfuZ18OafDo9BE406Z2WgIrgnoL3Obc/q4X/ojvm9ft5mW/279t/RVlrcnq'></script>
<script type='text/javascript' src='https://platform.twitter.com/widgets.js?ver=20111117'></script>
<script type='text/javascript' src='https://s2.wp.com/_static/??-eJyVy8EOwiAMANAfslYTHXowfsuAhhRLJaxI/Hu97rTs+A4PR4XwViM1LB2q9MS6oA02owZe5vDy3CJUJlT6UCONrOmYlwPuuXX7sVCENItQ+671X8/yOF9u95Ob3NXlHw12Q+E='></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script><script type="text/javascript">
			jQuery.extend( infiniteScroll.settings.scripts, ["jquery-core","jquery-migrate","jquery","mobile-useragent-info","postmessage","jquery_inview","jetpack_resize","responsive-modernizr","spin","jquery.spin","grofiles-cards","wpgroho","jquery.autoresize","highlander-comments","syntaxhighlighter-core","syntaxhighlighter-brush-plain","syntaxhighlighter-brush-python","syntaxhighlighter-brush-xml","devicepx","jetpack_likes_queuehandler","the-neverending-homepage","responsive-scripts","responsive-small-menu","wpcom-masterbar-js","wpcom-masterbar-tracks-js","wpcom-actionbar-bar","jetpack-carousel","swfobject","videopress","twitter-widgets","twitter-widgets-infinity","twitter-widgets-pending","tiled-gallery"] );
			jQuery.extend( infiniteScroll.settings.styles, ["jetpack_likes","wordads-global","the-neverending-homepage","wpcom-core-compat-playlist-styles","mp6hacks","wpcom-bbpress2-staff-css","responsive-style","jetpack-widget-social-icons-styles","noticons","geo-location-flair","reblogging","wpcom-actionbar-bar","h4-global","highlander-comments","highlander-comments-ie7","jetpack-carousel","tiled-gallery","jetpack-carousel-ie8fix"] );
		</script><script src="//stats.wp.com/w.js?56" type="text/javascript" async defer></script>
<script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'6581530','blog_tz':'9','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'6581530','v':'wpcom','tz':'9','user_id':'0','subd':'siguniang'}]);
_stq.push(['extra', {'crypt':'UE5XaGUuOTlwaD85flAmcm1mcmZsaDhkV11YdWtpP0NsWnVkPS9sL0ViLndld3BuVT01Unp2dX5PUGxla0VOTTQrNE1BN19NU2UvJi45NC5NT250TVFuOV1EaE0lRjg2Z2tiMyUxW3ctJXw/UEVRbmhzLnEmdHNGcHcsYTg1a1VUSSY4Q0s9cWNqR01zQyYrZS9hb0E4dzFTN3ZlL0R6MDZ8WDYmVUo4Y1U5cEdDZS9rT2staGc1akVoXWVVUmk0SCZ4P1lyb2JEQ3hXRWNoJm9sWk9XJmR6Y3ZhXT8lRHUvVjQ='}]);
_stq.push([ 'clickTrackerInit', '6581530', '0' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script></body>
</html>
<!--
	generated in 0.462 seconds
	112333 bytes batcached for 300 seconds
-->